{\rtf1\ansi\ansicpg1252\cocoartf1671\cocoasubrtf600
{\fonttbl\f0\fmodern\fcharset0 Courier;}
{\colortbl;\red255\green255\blue255;\red251\green0\blue7;\red179\green179\blue179;\red0\green0\blue0;
\red190\green0\blue146;\red180\green58\blue4;\red19\green142\blue2;\red13\green99\blue98;\red0\green0\blue255;
}
{\*\expandedcolortbl;;\cssrgb\c100000\c0\c0;\cssrgb\c75294\c75294\c75294;\cssrgb\c0\c0\c0;
\cssrgb\c80000\c0\c63922;\cssrgb\c76471\c30588\c0;\cssrgb\c0\c61176\c0;\cssrgb\c0\c45882\c45882;\cssrgb\c0\c0\c100000;
}
\paperw11900\paperh16840\margl1440\margr1440\vieww10800\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\sl280\partightenfactor0

\f0\fs24 \cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 //KI-DAQX\cf3 \strokec3  \cf2 \strokec2 --\cf3 \strokec3  \cf2 \strokec2 Experiment\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 control\cf3 \strokec3  \cf2 \strokec2 Keithley\cf3 \strokec3  \cf2 \strokec2 Digital\cf3 \strokec3  \cf2 \strokec2 Source\cf3 \strokec3  \cf2 \strokec2 meter\cf3 \strokec3  \cf2 \strokec2 via\cf3 \strokec3  \cf2 \strokec2 GPIB.\cf3 \strokec3  \cf2 \strokec2 Derived\cf3 \strokec3  \cf2 \strokec2 from\cf3 \strokec3  \cf2 \strokec2 NIDAQ,\cf3 \strokec3  \cf2 \strokec2 KIDAC\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 1.1\cf3 \strokec3 		\cf2 \strokec2 07/02/1997\cf3 \strokec3 	\cf2 \strokec2 Waveforms\cf3 \strokec3  \cf2 \strokec2 used.\cf3 \strokec3  \cf2 \strokec2 Added\cf3 \strokec3  \cf2 \strokec2 stability\cf3 \strokec3  \cf2 \strokec2 testing\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 1.2\cf3 \strokec3 		\cf2 \strokec2 25/02/1997\cf3 \strokec3 	\cf2 \strokec2 Added\cf3 \strokec3  \cf2 \strokec2 Hysteresis\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 changed\cf3 \strokec3  \cf2 \strokec2 calibration\cf3 \strokec3  \cf2 \strokec2 procedure\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 1.3\cf3 \strokec3 		\cf2 \strokec2 02/06/1997\cf3 \strokec3 	\cf2 \strokec2 Added\cf3 \strokec3  \cf2 \strokec2 features\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 multiple\cf3 \strokec3  \cf2 \strokec2 cells\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 1.4\cf3 \strokec3 		\cf2 \strokec2 10/09/1997\cf3 \strokec3 	\cf2 \strokec2 Added\cf3 \strokec3  \cf2 \strokec2 features\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Keithley\cf3 \strokec3  \cf2 \strokec2 Instruments\cf3 \strokec3  \cf2 \strokec2 source\cf3 \strokec3  \cf2 \strokec2 meter\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 1.5\cf3 \strokec3 		\cf2 \strokec2 15/10/1997\cf3 \strokec3 	\cf2 \strokec2 IV\cf3 \strokec3  \cf2 \strokec2 curves\cf3 \strokec3  \cf2 \strokec2 under\cf3 \strokec3  \cf2 \strokec2 variable\cf3 \strokec3  \cf2 \strokec2 intensities\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 1.6\cf3 \strokec3 		\cf2 \strokec2 09/01/1998\cf3 \strokec3 	\cf2 \strokec2 Add\cf3 \strokec3  \cf2 \strokec2 fifth\cf3 \strokec3  \cf2 \strokec2 intensity\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 auto\cf3 \strokec3  \cf2 \strokec2 fitting\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 diode\cf3 \strokec3  \cf2 \strokec2 model\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 errors\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 1.7\cf3 \strokec3 		\cf2 \strokec2 05/03/1998\cf3 \strokec3 	\cf2 \strokec2 Upgraded\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 LeClanche\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 1.8\cf3 \strokec3 		\cf2 \strokec2 22/03/1999\cf3 \strokec3 	\cf2 \strokec2 Upgraded\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Multiple\cf3 \strokec3  \cf2 \strokec2 Cells\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 1.9\cf3 \strokec3 		\cf2 \strokec2 22/03/1999\cf3 \strokec3 	\cf2 \strokec2 Implemented\cf3 \strokec3  \cf2 \strokec2 Igor\cf3 \strokec3  \cf2 \strokec2 4.0\cf3 \strokec3  \cf2 \strokec2 features,\cf3 \strokec3  \cf2 \strokec2 Tab\cf3 \strokec3  \cf2 \strokec2 Controls,\cf3 \strokec3  \cf2 \strokec2 User\cf3 \strokec3  \cf2 \strokec2 specific\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 2.0\cf3 \strokec3 		\cf2 \strokec2 20/12/2007\cf3 \strokec3 	\cf2 \strokec2 Implemented\cf3 \strokec3  \cf2 \strokec2 Igor\cf3 \strokec3  \cf2 \strokec2 6\cf3 \strokec3  \cf2 \strokec2 features\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 update\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 MacOSX\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 2.1\cf3 \strokec3 		\cf2 \strokec2 2/10/2012\cf3 \strokec3 	\cf2 \strokec2 Incorporated\cf3 \strokec3  \cf2 \strokec2 Arduino\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 replace\cf3 \strokec3  \cf2 \strokec2 NIDAQ,\cf3 \strokec3  \cf2 \strokec2 'IV_sketch'\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 2.2\cf3 \strokec3 		\cf2 \strokec2 26/03/2013\cf3 \strokec3 	\cf2 \strokec2 Updated\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 Mac\cf3 \strokec3  \cf2 \strokec2 mini\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 Igor\cf3 \strokec3  \cf2 \strokec2 6.31\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver\cf3 \strokec3  \cf2 \strokec2 2.3\cf3 \strokec3 		\cf2 \strokec2 24/03/2014\cf3 \strokec3 	\cf2 \strokec2 Updated\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 Norman\cf3 \strokec3  \cf2 \strokec2 Specs.\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver=2.4\cf3 \strokec3 		\cf2 \strokec2 05/07/2014\cf3 \strokec3 	\cf2 \strokec2 Replaced\cf3 \strokec3  \cf2 \strokec2 Arduino\cf3 \strokec3  \cf2 \strokec2 sketch\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 'Igor_Routines'\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver=2.5\cf3 \strokec3 		\cf2 \strokec2 16/11/2015\cf3 \strokec3  \cf2 \strokec2 Updated\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 be\cf3 \strokec3  \cf2 \strokec2 compatible\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 Mac\cf3 \strokec3  \cf2 \strokec2 Mini\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 Igor\cf3 \strokec3  \cf2 \strokec2 Pro\cf3 \strokec3  \cf2 \strokec2 7\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ver=2.6\cf3 \strokec3 		\cf2 \strokec2 16/04/2017\cf3 \strokec3 	\cf2 \strokec2 Updated\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 PPT\cf3 \strokec3  \cf2 \strokec2 Routines\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf5 \strokec5 #pragma\cf3 \strokec3  \cf6 \strokec6 IgorVersion\cf4 \strokec4 =7\cf3 \strokec3 	\cf2 \strokec2 //\cf3 \strokec3   \cf2 \strokec2 11/06/2019\cf3 \strokec3 	\cf2 \strokec2 Updated\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 KIDAQX\cf3 \strokec3  \cf2 \strokec2 std\cf4 \strokec4 \
\cf5 \strokec5 #pragma\cf3 \strokec3  \cf4 \strokec4 TextEncoding\cf3 \strokec3  \cf4 \strokec4 =\cf3 \strokec3  \cf7 \strokec7 "MacRoman"\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 For\cf3 \strokec3  \cf2 \strokec2 details\cf3 \strokec3  \cf2 \strokec2 execute\cf3 \strokec3  \cf2 \strokec2 DisplayHelpTopic\cf3 \strokec3  \cf2 \strokec2 "The\cf3 \strokec3  \cf2 \strokec2 TextEncoding\cf3 \strokec3  \cf2 \strokec2 Pragma"\cf4 \strokec4 \
\cf5 \strokec5 #pragma\cf3 \strokec3  \cf4 \strokec4 rtGlobals=3\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Use\cf3 \strokec3  \cf2 \strokec2 modern\cf3 \strokec3  \cf2 \strokec2 global\cf3 \strokec3  \cf2 \strokec2 access\cf3 \strokec3  \cf2 \strokec2 method.\cf4 \strokec4 \
\
\cf5 \strokec5 #include\cf3 \strokec3  \cf4 \strokec4 <\cf8 \strokec8 Remove\cf3 \strokec3  \cf4 \strokec4 Tags>,\cf3 \strokec3  \cf4 \strokec4 menus=0\
\cf5 \strokec5 #include\cf3 \strokec3  \cf4 \strokec4 <ColorWaveEditor>\
\cf5 \strokec5 #include\cf3 \strokec3  \cf7 \strokec7 ":Arduino:Arduino_Sequencer_Vs1"\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Menu\cf3 \strokec3  \cf7 \strokec7 "Data"\cf3 \strokec3 																																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 menu\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 DataScan\cf3 \strokec3   \cf2 \strokec2 Files\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf7 \strokec7 "-"\cf4 \strokec4 \
\cf3 \strokec3 	\cf7 \strokec7 "Load\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Data\cf3 \strokec3  \cf7 \strokec7 [.sIV]"\cf4 \strokec4 ,/Q,S_ExptType=\cf7 \strokec7 ".sIV"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 IVDataLists()\
\cf3 \strokec3 	\cf4 \strokec4 help\cf3 \strokec3  \cf4 \strokec4 =\cf3 \strokec3  \cf4 \strokec4 \{\cf7 \strokec7 "Load\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Scan\cf3 \strokec3  \cf7 \strokec7 data\cf3 \strokec3  \cf7 \strokec7 file"\cf4 \strokec4 \}\
\cf3 \strokec3 	\cf7 \strokec7 "Load\cf3 \strokec3  \cf7 \strokec7 PPT\cf3 \strokec3  \cf7 \strokec7 Data\cf3 \strokec3  \cf7 \strokec7 [.pPT]"\cf4 \strokec4 ,/Q,S_ExptType=\cf7 \strokec7 ".pPT"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 IVDataLists()\
\cf3 \strokec3 	\cf4 \strokec4 option8\
\cf3 \strokec3 	\cf7 \strokec7 "Export"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option9,PrintSave(0)\
\cf3 \strokec3 	\cf7 \strokec7 "Save\cf3 \strokec3  \cf7 \strokec7 SPEX\cf3 \strokec3  \cf7 \strokec7 Inits"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Menu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 ,dynamic\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 menu\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 DataScan\cf3 \strokec3   \cf2 \strokec2 experiment\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf7 \strokec7 "Documentation"\cf4 \strokec4 ,\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 Documentation_KIDAQ_ifn\
\cf3 \strokec3 	\cf7 \strokec7 "-"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 submenu\cf3 \strokec3  \cf4 \strokec4 option1\
\cf3 \strokec3 		\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Test"\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "Default"\cf4 \strokec4 ,/Q,Celltest(\cf7 \strokec7 "Marie"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf7 \strokec7 "Perovskite"\cf4 \strokec4 ,/Q,Celltest(\cf7 \strokec7 "Perovskite"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf7 \strokec7 "DSC"\cf4 \strokec4 ,/Q,Celltest(\cf7 \strokec7 "DSC"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf7 \strokec7 "ssDSC"\cf4 \strokec4 ,/Q,Celltest(\cf7 \strokec7 "ssDSC"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Stability"\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,PPTStability(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,PPTStability(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,PPTStability(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 		\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Device\cf3 \strokec3  \cf7 \strokec7 Equilibration"\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,PPTEquilibration(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0)\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,PPTEquilibration(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,1)\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,PPTEquilibration(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2)\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 		\cf7 \strokec7 "Multiple\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Test"\cf4 \strokec4 ,MultiCellTest(1)\
\cf3 \strokec3 		\cf7 \strokec7 "MultiCell\cf3 \strokec3  \cf7 \strokec7 Conductivity"\cf4 \strokec4 ,MultiCellTest(0)\
\cf3 \strokec3 		\cf7 \strokec7 "LeClanche\cf3 \strokec3  \cf7 \strokec7 Test"\cf4 \strokec4 ,/Q,LeClanche()\
\cf3 \strokec3 		\cf7 \strokec7 "Specification"\cf4 \strokec4 ,/Q,\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 ConfigPanel;\cf3 \strokec3  \cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0\cf3 \strokec3  \cf4 \strokec4 win=ConfigPanel,value=4;\cf3 \strokec3  \cf4 \strokec4 tabPanels(\cf7 \strokec7 "tab0"\cf4 \strokec4 ,4)\
\cf3 \strokec3 		\cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 Area"\cf4 \strokec4 ,Cell_Area()\
\cf3 \strokec3 	\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 submenu\cf3 \strokec3  \cf4 \strokec4 option2\
\cf3 \strokec3 		\cf7 \strokec7 "Dark\cf3 \strokec3  \cf7 \strokec7 Current\cf3 \strokec3  \cf7 \strokec7 /F5"\cf4 \strokec4 ,/Q,V_Henry=1;\cf3 \strokec3  \cf4 \strokec4 Sun(\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,10);\cf3 \strokec3  \cf4 \strokec4 V_Henry=0\
\cf3 \strokec3 		\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Sun\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Test"\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun\cf3 \strokec3  \cf7 \strokec7 /F6"\cf4 \strokec4 ,/Q,Sun(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,Sun(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,Sun(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,Sun(\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,5);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 		\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 		\cf7 \strokec7 "Current\cf3 \strokec3  \cf7 \strokec7 Dynamics"\cf4 \strokec4 ,/Q,DynamicsWrapper(\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf7 \strokec7 "Voltage\cf3 \strokec3  \cf7 \strokec7 Dynamics"\cf4 \strokec4 ,/Q,DynamicsWrapper(\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf7 \strokec7 "IPCE\cf3 \strokec3  \cf7 \strokec7 550"\cf4 \strokec4 ,/Q,MeasureIPCE(\cf7 \strokec7 "550"\cf4 \strokec4 ,8);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 		\cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 Stability"\cf4 \strokec4 ,/Q,Stability(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0)\
\cf3 \strokec3 		\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Time\cf3 \strokec3  \cf7 \strokec7 Dependence"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Current"\cf4 \strokec4 \
\cf3 \strokec3 				\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,TimeDependenceWrapper(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\
\cf3 \strokec3 				\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,TimeDependenceWrapper(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,2)\
\cf3 \strokec3 				\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,TimeDependenceWrapper(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,4)\
\cf3 \strokec3 				\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,TimeDependenceWrapper(\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,5)\
\cf3 \strokec3 				\cf4 \strokec4 DiodeLabels[13],/Q,TimeDependenceWrapper(\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,13)\
\cf3 \strokec3 			\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Voltage"\cf4 \strokec4 \
\cf3 \strokec3 				\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,TimeDependenceWrapper(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,0)\
\cf3 \strokec3 				\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,TimeDependenceWrapper(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,2)\
\cf3 \strokec3 				\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,TimeDependenceWrapper(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,4)\
\cf3 \strokec3 				\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,TimeDependenceWrapper(\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,5)\
\cf3 \strokec3 				\cf4 \strokec4 DiodeLabels[13],/Q,TimeDependenceWrapper(\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,,\cf7 \strokec7 "CURR"\cf4 \strokec4 13)\
\cf3 \strokec3 			\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Tracking"\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,PPT(\cf7 \strokec7 "Current"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Nominal\cf3 \strokec3  \cf2 \strokec2 value:\cf3 \strokec3  \cf2 \strokec2 182%\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,PPT(\cf7 \strokec7 "Current"\cf4 \strokec4 ,2);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 @\cf3 \strokec3  \cf2 \strokec2 100%\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,PPT(\cf7 \strokec7 "Current"\cf4 \strokec4 ,4);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 @\cf3 \strokec3  \cf2 \strokec2 50%\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Hysteresis"\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,HysteresisWrapper(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0,1);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,HysteresisWrapper(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2,1);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,HysteresisWrapper(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4,1);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,/Q,HysteresisWrapper(\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,5,1);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf7 \strokec7 "Dark\cf3 \strokec3  \cf7 \strokec7 Current"\cf4 \strokec4 ,/Q,HysteresisWrapper(\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,10,1);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 		\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 		\cf7 \strokec7 "Chrono\cf3 \strokec3  \cf7 \strokec7 Amperometry"\cf4 \strokec4 ,/Q,LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 		\cf7 \strokec7 "Charge\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 Potential"\cf4 \strokec4 ,/Q,LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 		\cf7 \strokec7 "Profile"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 submenu\cf3 \strokec3  \cf4 \strokec4 option3\
\cf3 \strokec3 		\cf9 \strokec9 submenu\cf3 \strokec3  \cf7 \strokec7 "Datafit"\cf4 \strokec4 \
\cf3 \strokec3 			\cf7 \strokec7 "IV"\cf4 \strokec4 ,DataFit(\cf7 \strokec7 "IV"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf4 \strokec4 option31,DataFit(\cf7 \strokec7 "IVShunt"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 end\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 		\cf2 \strokec2 "Schottky",Schottky("IV",)\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 		\cf7 \strokec7 "Photodiode\cf3 \strokec3  \cf7 \strokec7 Current"\cf4 \strokec4 ,InternalResistance()\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf7 \strokec7 "Photo\cf3 \strokec3  \cf7 \strokec7 Current"\cf4 \strokec4 ,TruePhotoCurrent()\
\cf3 \strokec3 		\cf7 \strokec7 "Radiant\cf3 \strokec3  \cf7 \strokec7 Power"\cf4 \strokec4 ,RadiantPower()\
\cf3 \strokec3 		\cf7 \strokec7 "IV\cf3 \strokec3  \cf7 \strokec7 Log\cf3 \strokec3  \cf7 \strokec7 Plot"\cf4 \strokec4 ,Graph_Style1()\
\cf3 \strokec3 	\cf9 \strokec9 end\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option4\
\cf3 \strokec3 	\cf7 \strokec7 "-"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option5,/Q,\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 ConfigPanel;\cf3 \strokec3  \cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,value=4;\cf3 \strokec3  \cf4 \strokec4 tabPanels(\cf7 \strokec7 "tab0"\cf4 \strokec4 ,4)\
\cf3 \strokec3 	\cf4 \strokec4 option6,/Q,PrintSave(1)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Menu\cf3 \strokec3  \cf7 \strokec7 "System"\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 menu\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 NI-DAQ\cf3 \strokec3  \cf2 \strokec2 LabNB\cf3 \strokec3  \cf2 \strokec2 Nubus\cf3 \strokec3  \cf2 \strokec2 card\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf7 \strokec7 "Setup"\cf4 \strokec4 ,SetUpSystem()\
\cf3 \strokec3 	\cf7 \strokec7 "Reset\cf3 \strokec3  \cf7 \strokec7 Keithley"\cf4 \strokec4 ,SetupGPIBKeithley()\
\cf3 \strokec3 	\cf7 \strokec7 "Setup\cf3 \strokec3  \cf7 \strokec7 Arduino"\cf4 \strokec4 \
\cf3 \strokec3 	\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Paths"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 GetStrFromList1(str,n,separator)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str,separator;\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 n\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 p1,p2,len=\cf6 \strokec6 strlen\cf4 \strokec4 (separator)\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 p2=\cf6 \strokec6 StrSearch\cf4 \strokec4 (str,separator,p1)\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (p2==-1)\
\cf3 \strokec3 			\cf4 \strokec4 p2=\cf6 \strokec6 strlen\cf4 \strokec4 (str)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 so\cf3 \strokec3  \cf2 \strokec2 that\cf3 \strokec3  \cf2 \strokec2 trailing\cf3 \strokec3  \cf2 \strokec2 separator\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 not\cf3 \strokec3  \cf2 \strokec2 needed\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (n==0)\
\cf3 \strokec3 			\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 str[p1,p2-1]\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n-=1\
\cf3 \strokec3 		\cf4 \strokec4 p1=p2+len\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n>=0)\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 KillJoy()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 keys=\cf6 \strokec6 GetKeyState\cf4 \strokec4 (0)\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (keys\cf3 \strokec3  \cf4 \strokec4 &\cf3 \strokec3  \cf4 \strokec4 4)\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Test\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 opt\cf3 \strokec3  \cf2 \strokec2 (Mac)\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 OpenFilemaker()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 s+=\cf7 \strokec7 "tell\cf3 \strokec3  \cf7 \strokec7 application\\"Finder\\"\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 s+=\cf7 \strokec7 "\cf3 \strokec3 	\cf7 \strokec7 activate\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 s+=\cf7 \strokec7 "\cf3 \strokec3 	\cf7 \strokec7 select\cf3 \strokec3  \cf7 \strokec7 file\\"Mesure\cf3 \strokec3  \cf7 \strokec7 Marie\\"\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 folder\\"FileMaker\cf3 \strokec3  \cf7 \strokec7 Pro\\"\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 startup\cf3 \strokec3  \cf7 \strokec7 disk\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 s+=\cf7 \strokec7 "\cf3 \strokec3 	\cf7 \strokec7 open\cf3 \strokec3  \cf7 \strokec7 selection\cf3 \strokec3  \cf7 \strokec7 with\cf3 \strokec3  \cf7 \strokec7 password\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 s+=\cf7 \strokec7 "end\cf3 \strokec3  \cf7 \strokec7 tell\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 executeScriptText\cf3 \strokec3  \cf4 \strokec4 s\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SendScript(command)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 First\cf3 \strokec3  \cf2 \strokec2 command\cf3 \strokec3  \cf2 \strokec2 automatically\cf3 \strokec3  \cf2 \strokec2 starts\cf3 \strokec3  \cf2 \strokec2 up\cf3 \strokec3  \cf2 \strokec2 application\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 command\
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 s+=\cf7 \strokec7 "tell\cf3 \strokec3  \cf7 \strokec7 application\\"Filemaker\cf3 \strokec3  \cf7 \strokec7 Pro\\"\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 s+=\cf7 \strokec7 "\cf3 \strokec3 	\cf7 \strokec7 do\cf3 \strokec3  \cf7 \strokec7 script(\\""\cf4 \strokec4 +command+\cf7 \strokec7 "\\")\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 s+=\cf7 \strokec7 "end\cf3 \strokec3  \cf7 \strokec7 tell\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 executeScriptText\cf3 \strokec3  \cf4 \strokec4 s\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 IVSpectrum()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 I-V\cf3 \strokec3  \cf2 \strokec2 Spectrum\cf3 \strokec3  \cf2 \strokec2 experiment\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allmolecules\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 ConfigPanel\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "ConfigPanel()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 allMolecules=\cf6 \strokec6 indexedfile\cf4 \strokec4 (MoleculePath,-1,\cf7 \strokec7 "PICT"\cf4 \strokec4 )+\cf7 \strokec7 "none"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetBackground\cf3 \strokec3  \cf4 \strokec4 ReadChannels()\
\cf3 \strokec3 	\cf8 \strokec8 CtrlBackground\cf3 \strokec3  \cf4 \strokec4 period=240\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Approx\cf3 \strokec3  \cf2 \strokec2 5s\cf3 \strokec3  \cf2 \strokec2 cycle\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,value=4;\cf3 \strokec3  \cf4 \strokec4 tabPanels(\cf7 \strokec7 "tab0"\cf4 \strokec4 ,4)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 ConfigPanel()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Panel\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf4 \strokec4 V_totaltime:=V_scans*V_steptime/60\
\cf3 \strokec3 	\cf8 \strokec8 NewPanel\cf4 \strokec4 /K=2/W=(4,40,720,280)\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "I-V\cf3 \strokec3  \cf7 \strokec7 characteristics\cf3 \strokec3  \cf7 \strokec7 under\cf3 \strokec3  \cf7 \strokec7 Solar\cf3 \strokec3  \cf7 \strokec7 AM\cf3 \strokec3  \cf7 \strokec7 1.5"\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyPanel\cf3 \strokec3  \cf4 \strokec4 fixedSize=1,cbRGB=(34952,34952,34952),frameStyle=3,frameInset=6\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 cellarea,pos=\{24,12\},size=\{170,18\},title=\cf7 \strokec7 "Devicel\cf3 \strokec3  \cf7 \strokec7 Area:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%g\cf3 \strokec3  \cf7 \strokec7 cm2"\cf4 \strokec4 ,frame=3,limits=\{0.01,200,0.01\},value=V_area\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 Voltage,pos=\{24,36\},size=\{170,18\},\cf9 \strokec9 proc\cf4 \strokec4 =voltage_output,title=\cf7 \strokec7 "Bias\cf3 \strokec3  \cf7 \strokec7 Voltage:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%g\cf3 \strokec3  \cf7 \strokec7 V"\cf4 \strokec4 ,frame=2,limits=\{-10.0,3.2,0.02\},value=V_BiasVoltage\
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 Current,pos=\{24,60\},size=\{168,18\},title=\cf7 \strokec7 "Current\cf3 \strokec3  \cf7 \strokec7 :\cf3 \strokec3        \cf7 \strokec7 "\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.2W1PA"\cf4 \strokec4 ,frame=3,labelBack=(34952,34952,34952),limits=\{-0.02,0,0\},barmisc=\{0,64\},value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "V_DataChannel0"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 user,pos=\{290,12\},size=\{126,18\},\cf9 \strokec9 proc\cf4 \strokec4 =User,title=\cf7 \strokec7 "User\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,mode=1,value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "\\"Visitor;DSC;Perovskite;ssDSC;Reference\cf3 \strokec3  \cf7 \strokec7 Cell\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 cell0,pos=\{554,12\},size=\{126,18\},\cf9 \strokec9 proc\cf4 \strokec4 =SelectCell,title=\cf7 \strokec7 "Select\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,mode=2,value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "\\"Ref.\cf3 \strokec3  \cf7 \strokec7 Cell;Test\cf3 \strokec3  \cf7 \strokec7 Cell;Test\cf3 \strokec3  \cf7 \strokec7 Cell#1;Test\cf3 \strokec3  \cf7 \strokec7 Cell#2;Test\cf3 \strokec3  \cf7 \strokec7 Cell#3;Test\cf3 \strokec3  \cf7 \strokec7 Cell#4;Test\cf3 \strokec3  \cf7 \strokec7 Cell#5;Test\cf3 \strokec3  \cf7 \strokec7 Cell#6;Test\cf3 \strokec3  \cf7 \strokec7 Cell#7;Test\cf3 \strokec3  \cf7 \strokec7 Cell#8;Test\cf3 \strokec3  \cf7 \strokec7 Cell#9;Test\cf3 \strokec3  \cf7 \strokec7 Cell#10;Test\cf3 \strokec3  \cf7 \strokec7 Cell#11;Test\cf3 \strokec3  \cf7 \strokec7 Cell#12;Test\cf3 \strokec3  \cf7 \strokec7 Cell#13;Test\cf3 \strokec3  \cf7 \strokec7 Cell#14;Test\cf3 \strokec3  \cf7 \strokec7 Cell#15\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0,pos=\{554,36\},size=\{130,18\},\cf9 \strokec9 proc\cf4 \strokec4 =FilterWheel,title=\cf7 \strokec7 "Filters\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,mode=1,value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "\\"0%\cf3 \strokec3  \cf7 \strokec7 Sun;1%\cf3 \strokec3  \cf7 \strokec7 Sun;10%\cf3 \strokec3  \cf7 \strokec7 Sun;53%\cf3 \strokec3  \cf7 \strokec7 Sun;100%\cf3 \strokec3  \cf7 \strokec7 Sun;550\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetDrawEnv\cf3 \strokec3  \cf4 \strokec4 linethick=4,linefgc=(65535,0,0),linebgc=(49151,53155,65535),rounding=16;\cf3 \strokec3  \cf8 \strokec8 DrawRRect\cf3 \strokec3  \cf4 \strokec4 260,66,468,92\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,pos=\{256,64\},size=\{228,28\},anchor=MC,frame=0,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Standby"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 go,pos=\{552,62\},size=\{26,26\},\cf9 \strokec9 proc\cf4 \strokec4 =go,title=\cf7 \strokec7 "Go"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,pos=\{4,104\},size=\{698,128\},\cf9 \strokec9 proc\cf4 \strokec4 =tabPanels,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,tabLabel(0)=\cf7 \strokec7 "Setup"\cf4 \strokec4 ,tabLabel(1)=\cf7 \strokec7 "IV\cf3 \strokec3  \cf7 \strokec7 SingleDevice"\cf4 \strokec4 ,tabLabel(2)=\cf7 \strokec7 "IV\cf3 \strokec3  \cf7 \strokec7 MultiDevice"\cf4 \strokec4 ,tabLabel(3)=\cf7 \strokec7 "Stability"\cf4 \strokec4 ,tabLabel(4)=\cf7 \strokec7 "Specs."\cf4 \strokec4 ,tabLabel(5)=\cf7 \strokec7 "Resistance"\cf4 \strokec4 ,tabLabel(6)=\cf7 \strokec7 "Calibration"\cf4 \strokec4 ,value=0\
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 se_chan1,pos=\{64,132\},size=\{184,22\},title=\cf7 \strokec7 "Thermopile\cf3 \strokec3   \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.3f\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,frame=3,limits=\{-0.01,1.0,0\},barmisc=\{0,64\},value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "V_DataChannel1"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 se_chan2,pos=\{64,154\},size=\{184,22\},title=\cf7 \strokec7 "Ref.\cf3 \strokec3  \cf7 \strokec7 Current:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.2W0PA"\cf4 \strokec4 ,frame=3,limits=\{-1e-2,2e-4,0\},barmisc=\{0,64\},value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "V_DataChannel2"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 se_chan0,pos=\{64,176\},size=\{184,22\},title=\cf7 \strokec7 "CellCurrent\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.2W0PA"\cf4 \strokec4 ,frame=3,limits=\{-1e-2,2e-4,0\},barmisc=\{0,64\},value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "V_DataChannel0"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 se_chan3,pos=\{64,198\},size=\{184,22\},title=\cf7 \strokec7 "Potential\cf3 \strokec3      \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.2W0PV"\cf4 \strokec4 ,frame=3,limits=\{-0.1,1.2,0\},barmisc=\{0,64\},value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "V_DataChannel3"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 se_shutter0,pos=\{312,132\},size=\{130,22\},\cf9 \strokec9 proc\cf4 \strokec4 =shutter,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,title=\cf7 \strokec7 "Shutter1"\cf4 \strokec4 ,mode=1,value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "\\"Closed;Open\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 se_shutter3,pos=\{312,154\},size=\{130,22\},\cf9 \strokec9 proc\cf4 \strokec4 =shutter,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,title=\cf7 \strokec7 "Shutter2"\cf4 \strokec4 ,mode=1,value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "\\"Closed;Open\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 se_shutter1,pos=\{312,176\},size=\{130,22\},\cf9 \strokec9 proc\cf4 \strokec4 =shutter,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,title=\cf7 \strokec7 "Shutter3"\cf4 \strokec4 ,mode=1,value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "\\"Closed;Open\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 se_4w,pos=\{472,132\},size=\{132,22\},\cf9 \strokec9 proc\cf4 \strokec4 =FourWire,title=\cf7 \strokec7 "4-Wire\cf3 \strokec3  \cf7 \strokec7 Sense"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"OFF;ON\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Slider\cf3 \strokec3  \cf4 \strokec4 se_LampOutput,pos=\{632,124\},size=\{40,104\},\cf9 \strokec9 proc\cf4 \strokec4 =LampControl,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,vert=1,side=2,\cf6 \strokec6 ticks\cf4 \strokec4 =16,limits=\{15,30,0.1\},value=15\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 iv_msg,pos=\{236,126\},size=\{214,20\},anchor=MC,frame=0,title=\cf7 \strokec7 "\\F'Chicago'\\Z12IV\cf3 \strokec3  \cf7 \strokec7 Acquisition\cf3 \strokec3  \cf7 \strokec7 Parameters"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_gain1,pos=\{64,142\},size=\{126,18\},\cf9 \strokec9 proc\cf4 \strokec4 =setDelay,title=\cf7 \strokec7 "Settling\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3    \cf7 \strokec7 (ms)\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=10,value=\cf7 \strokec7 "AUTO;1;2;5;10;20;40;60;80;100;200;500;1000;2000;5000;10000"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_avg,pos=\{64,168\},size=\{126,18\},\cf9 \strokec9 proc\cf4 \strokec4 =SetCompliance,title=\cf7 \strokec7 "Compliance\cf3 \strokec3      \cf7 \strokec7 (uA)\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=6,value=#\cf7 \strokec7 "\\"5;10;20;50;100;200;500;1000;2000;5000;10000;20000;50000;100000;200000;500000\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_incr,pos=\{64,194\},size=\{126,18\},\cf9 \strokec9 proc\cf4 \strokec4 =SetIncrement,title=\cf7 \strokec7 "Voltage\cf3 \strokec3  \cf7 \strokec7 step\cf3 \strokec3     \cf7 \strokec7 (mV)\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=2,value=#\cf7 \strokec7 "\\"2.5;5;10;20;50\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 iv_equil,pos=\{432,142\},size=\{156,18\},title=\cf7 \strokec7 "Equilibration\cf3 \strokec3  \cf7 \strokec7 Time:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%g\cf3 \strokec3  \cf7 \strokec7 s"\cf4 \strokec4 ,frame=0,limits=\{.0,120,1\},value=V_delay\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 iv_end,pos=\{432,194\},size=\{156,18\},title=\cf7 \strokec7 "Voltage\cf3 \strokec3  \cf7 \strokec7 Limits:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.1W0PV"\cf4 \strokec4 ,frame=0,limits=\{-8,0.9,0.01\},value=V_endVolt\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 iv_start,pos=\{590,194\},size=\{88,18\},\cf9 \strokec9 proc\cf4 \strokec4 =VoltLimit,title=\cf7 \strokec7 "<-"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.1W0PV"\cf4 \strokec4 ,frame=0,limits=\{0,8,0.01\},value=V_startVolt\
\cf3 \strokec3 	\cf8 \strokec8 CheckBox\cf3 \strokec3  \cf4 \strokec4 iv_ffFlag,pos=\{588,168\},size=\{78,20\},noproc,title=\cf7 \strokec7 "FF\cf3 \strokec3  \cf7 \strokec7 Control"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,frame=0,mode=0,\cf9 \strokec9 variable\cf4 \strokec4 =V_Henry\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ncell,pos=\{432,168\},size=\{144,18\},\cf9 \strokec9 proc\cf4 \strokec4 =CellNumber,title=\cf7 \strokec7 "#\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Cells\cf3 \strokec3  \cf7 \strokec7 in\cf3 \strokec3  \cf7 \strokec7 Module:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;25;26;27;28;29;30;31;32\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ndev,pos=\{432,168\},size=\{144,18\},\cf9 \strokec9 proc\cf4 \strokec4 =DeviceNumber,title=\cf7 \strokec7 "#\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Devices:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"1;2;3;4\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 st_msg,pos=\{236,126\},size=\{214,20\},anchor=MC,frame=0,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Stability\cf3 \strokec3  \cf7 \strokec7 Testing\cf3 \strokec3  \cf7 \strokec7 Parameters"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 st_setvar1,pos=\{80,142\},size=\{124,18\},title=\cf7 \strokec7 "#\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Scans\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%g"\cf4 \strokec4 ,frame=0,limits=\{4,256,4\},value=V_scans\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 st_setvar2,pos=\{80,168\},size=\{124,18\},title=\cf7 \strokec7 "Step\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3   \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%g\cf3 \strokec3  \cf7 \strokec7 m"\cf4 \strokec4 ,frame=0,limits=\{5,60,5\},value=V_steptime\
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 st_setvar3,pos=\{80,196\},size=\{124,18\},title=\cf7 \strokec7 "Total\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%4.2f\cf3 \strokec3  \cf7 \strokec7 h"\cf4 \strokec4 ,frame=3,value=V_totaltime\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 st_allsun,pos=\{416,168\},size=\{124,18\},\cf9 \strokec9 proc\cf4 \strokec4 =sunControl,title=\cf7 \strokec7 "NonStop\cf3 \strokec3  \cf7 \strokec7 Sun:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"No;Yes\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_dye0,pos=\{16,130\},size=\{124,20\},\cf9 \strokec9 proc\cf4 \strokec4 =DyePanel,title=\cf7 \strokec7 "Dye\cf3 \strokec3  \cf7 \strokec7 Sensitiser"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 sp_dye1,pos=\{140,132\},size=\{320,20\},title=\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,frame=0,value=S_specification\
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_we0,pos=\{16,154\},size=\{124,20\},\cf9 \strokec9 proc\cf4 \strokec4 =WEPanel,title=\cf7 \strokec7 "Working\cf3 \strokec3  \cf7 \strokec7 Electrode"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 sp_we1,pos=\{140,156\},size=\{320,20\},title=\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,frame=0,value=S_layer\
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_el0,pos=\{16,178\},size=\{124,20\},\cf9 \strokec9 proc\cf4 \strokec4 =ElectrolytePanel,title=\cf7 \strokec7 "Electrolyte"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 sp_el1,pos=\{140,180\},size=\{320,20\},title=\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,frame=0,value=S_Electrolyte\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 sp_ce0,pos=\{16,204\},size=\{116,20\},\cf9 \strokec9 proc\cf4 \strokec4 =setce,title=\cf7 \strokec7 "Counter\cf3 \strokec3  \cf7 \strokec7 Electrode"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,mode=0,value=#\cf7 \strokec7 "\\"NSG\cf3 \strokec3  \cf7 \strokec7 5\uc0\u937 /Pt\'b0;NSG\cf3 \strokec3  \cf7 \strokec7 10\uc0\u937 /Pt\'b0;LOF\cf3 \strokec3  \cf7 \strokec7 8\uc0\u937 /Pt\'b0;LOF\cf3 \strokec3  \cf7 \strokec7 10\uc0\u937 /Pt\'b0;LOF\cf3 \strokec3  \cf7 \strokec7 15\uc0\u937 /Pt\'b0;LOF\cf3 \strokec3  \cf7 \strokec7 15\uc0\u937 /Graphene;FlachGlas/Pt\cf3 \strokec3  \cf7 \strokec7 refl/Pt\'b0;Gold\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 sp_ce1,pos=\{148,204\},size=\{120,20\},title=\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,frame=0,value=S_CE\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 sp_lamp,pos=\{464,130\},size=\{136,16\},\cf9 \strokec9 proc\cf4 \strokec4 =setLamp,title=\cf7 \strokec7 "Light\cf3 \strokec3  \cf7 \strokec7 Source"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"White\cf3 \strokec3  \cf7 \strokec7 Lumileds;Xe\cf3 \strokec3  \cf7 \strokec7 450W\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 AM1.5G;Xe\cf3 \strokec3  \cf7 \strokec7 1000W\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 AM1.5G;S\cf3 \strokec3  \cf7 \strokec7 Lamp\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 AM1.5G;Osram\cf3 \strokec3  \cf7 \strokec7 36W/21-840;Halogen\cf3 \strokec3  \cf7 \strokec7 250W\cf3 \strokec3  \cf7 \strokec7 411\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 sp_type,pos=\{464,154\},size=\{184,20\},title=\cf7 \strokec7 "Type\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,frame=0,value=S_type\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 sp_name,pos=\{464,178\},size=\{160,20\},title=\cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 Name\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,frame=0,value=S_cellName\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 sp_num,pos=\{624,178\},size=\{68,20\},title=\cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 #"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,frame=0,limits=\{1,128,1\},value=V_run\
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_layout,pos=\{512,198\},size=\{90,20\},\cf9 \strokec9 proc\cf4 \strokec4 =specs,title=\cf7 \strokec7 "Layout"\cf4 \strokec4 ,disable=2\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 re_msg,pos=\{236,126\},size=\{214,20\},anchor=MC,frame=0,title=\cf7 \strokec7 "\\F'Chicago'\\Z12IV\cf3 \strokec3  \cf7 \strokec7 Film\cf3 \strokec3  \cf7 \strokec7 Resistance\cf3 \strokec3  \cf7 \strokec7 Parameters"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 re_R1,pos=\{40,144\},size=\{200,20\},title=\cf7 \strokec7 "Resistance\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 0\'b0\cf3 \strokec3   \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.2W0P\uc0\u937 "\cf4 \strokec4 ,frame=3,limits=\{0,0,0\},barmisc=\{0,1000\},value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "V_R1"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 re_R2,pos=\{40,168\},size=\{200,20\},title=\cf7 \strokec7 "Resistance\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 90\'b0:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.2W0P\uc0\u937 "\cf4 \strokec4 ,frame=3,limits=\{0,0,0\},barmisc=\{0,1000\},value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "V_R2"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 re_ratio,pos=\{40,192\},size=\{200,20\},title=\cf7 \strokec7 "Resistance\cf3 \strokec3  \cf7 \strokec7 Ratio\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%g"\cf4 \strokec4 ,frame=3,limits=\{0,0,0\},barmisc=\{0,1000\},value=\cf3 \strokec3  \cf4 \strokec4 #\cf7 \strokec7 "V_ResRatio"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 re_result,pos=\{284,144\},size=\{152,20\},title=\cf7 \strokec7 "Result\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.3W0P\uc0\u937 /[]"\cf4 \strokec4 ,frame=3,limits=\{0,0,0\},barmisc=\{0,1000\},value=#\cf7 \strokec7 "V_resultVdP"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GroupBox\cf3 \strokec3  \cf4 \strokec4 re_box1,pos=\{280,164\},size=\{168,48\},frame=0,title=\cf7 \strokec7 ""\cf4 \strokec4 ,labelBack=0\
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 re_cond,pos=\{284,168\},size=\{152,20\},title=\cf7 \strokec7 "Conductivity:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.3W0PS/m"\cf4 \strokec4 ,frame=3,limits=\{0,0,0\},barmisc=\{0,1000\},value=#\cf7 \strokec7 "V_conductivity"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 re_thick,pos=\{284,192\},size=\{160,20\},title=\cf7 \strokec7 "Film\cf3 \strokec3  \cf7 \strokec7 Thickness:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.1W0Pm"\cf4 \strokec4 ,frame=0,limits=\{1e-7,2e-5,1e-7\},value=V_length\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 re_Resistance,pos=\{512,168\},size=\{104,20\},\cf9 \strokec9 proc\cf4 \strokec4 =ResistanceMethod,title=\cf7 \strokec7 "Method\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"Van\cf3 \strokec3  \cf7 \strokec7 de\cf3 \strokec3  \cf7 \strokec7 Pauw;4-Point\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 re_CF,pos=\{512,192\},size=\{164,20\},title=\cf7 \strokec7 "Correction\cf3 \strokec3  \cf7 \strokec7 Factor"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.3g"\cf4 \strokec4 ,frame=3,limits=\{0,1,0.01\},value=V_CFVdP\
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 re_VdP,pos=\{560,140\},size=\{104,20\},\cf9 \strokec9 proc\cf4 \strokec4 =VdP,title=\cf7 \strokec7 "Analyze"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 ca_cal,pos=\{40,142\},size=\{120,22\},\cf9 \strokec9 proc\cf4 \strokec4 =calibrate,title=\cf7 \strokec7 "Calibration"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ca_PPT,pos=\{284,142\},size=\{126,16\},\cf9 \strokec9 proc\cf4 \strokec4 =PPTduration,title=\cf7 \strokec7 "Sweep\cf3 \strokec3  \cf7 \strokec7 Duration\cf3 \strokec3  \cf7 \strokec7 (s):"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"8;16;32;64;128;256;512;1024\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ca_dir,pos=\{284,168\},size=\{126,16\},\cf9 \strokec9 proc\cf4 \strokec4 =ScanDirection,title=\cf7 \strokec7 "Sweep\cf3 \strokec3  \cf7 \strokec7 Direction:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"<-;->\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ca_voc,pos=\{284,194\},size=\{126,20\},\cf9 \strokec9 proc\cf4 \strokec4 =vocMode,title=\cf7 \strokec7 "Precondition\cf3 \strokec3  \cf7 \strokec7 Voc:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"OFF;4min\cf3 \strokec3  \cf7 \strokec7 Scan;Voc\cf3 \strokec3  \cf7 \strokec7 Max\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ca_pul,pos=\{496,142\},size=\{126,16\},\cf9 \strokec9 proc\cf4 \strokec4 =pulsedMode,title=\cf7 \strokec7 "Pulsed\cf3 \strokec3  \cf7 \strokec7 Mode\cf3 \strokec3  \cf7 \strokec7 :\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=1,value=#\cf7 \strokec7 "\\"OFF;ON\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ca_dut,pos=\{496,168\},size=\{126,16\},\cf9 \strokec9 proc\cf4 \strokec4 =dutyCycle,title=\cf7 \strokec7 "Duty\cf3 \strokec3  \cf7 \strokec7 Cycle\cf3 \strokec3    \cf7 \strokec7 :\cf3 \strokec3   \cf7 \strokec7 "\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=7,value=#\cf7 \strokec7 "\\"5%;10%;15%;20%;30%;40%;50%;60%;70%\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ca_int,pos=\{496,194\},size=\{126,16\},\cf9 \strokec9 proc\cf4 \strokec4 =setInteg,title=\cf7 \strokec7 "Integ.\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3    \cf7 \strokec7 :\cf3 \strokec3   \cf7 \strokec7 "\cf4 \strokec4 ,font=\cf7 \strokec7 "Palatino"\cf4 \strokec4 ,fSize=12,mode=7,value=#\cf7 \strokec7 "\\"0.01;0.02;0.05;0.1;0.2;0.5;1;2;5;10\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetWindow\cf3 \strokec3  \cf4 \strokec4 kwTopWin,hook=UpdatePanel\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 DyePanel(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "DyeSensitizer()"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 DyeSensitizer()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Panel\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 NewPanel\cf4 \strokec4 /K=2/W=(292,251,576,375)\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Dye\cf3 \strokec3  \cf7 \strokec7 Parameters"\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyPanel\cf3 \strokec3  \cf4 \strokec4 cbRGB=(39321,1,31457)\
\cf3 \strokec3 	\cf8 \strokec8 SetDrawEnv\cf3 \strokec3  \cf4 \strokec4 fsize=16,fstyle=1,textrgb=(65535,65532,16385);\cf3 \strokec3  \cf8 \strokec8 DrawText\cf3 \strokec3  \cf4 \strokec4 88,24,\cf7 \strokec7 "Dye\cf3 \strokec3  \cf7 \strokec7 Uptake"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GroupBox\cf3 \strokec3  \cf4 \strokec4 box,pos=\{4,32\},size=\{276,88\},frame=1\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 dye,pos=\{8,40\},size=\{184,16\},\cf9 \strokec9 proc\cf4 \strokec4 =setDye,title=\cf7 \strokec7 "Dye\cf3 \strokec3  \cf7 \strokec7 Sensitiser:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,mode=V_ModeDye,value=allMolecules\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 dyesolv,pos=\{8,60\},size=\{184,16\},\cf9 \strokec9 proc\cf4 \strokec4 =setSolvent,title=\cf7 \strokec7 "Dye\cf3 \strokec3  \cf7 \strokec7 Solvent\cf3 \strokec3     \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,mode=V_modeSolvent,value=#\cf7 \strokec7 "\\"MeCN/tBuOH;EtOH\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 conc,pos=\{10,80\},size=\{170,16\},title=\cf7 \strokec7 "Concentration:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.0W0PM"\cf4 \strokec4 ,frame=0,limits=\{1e-5,2e-3,1e-5\},value=V_dyeConc\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf6 \strokec6 time\cf4 \strokec4 ,pos=\{10,100\},size=\{170,16\},title=\cf7 \strokec7 "Dipping\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3    \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.0W0Ph"\cf4 \strokec4 ,frame=0,limits=\{1,120,1\},value=V_time\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 batch,pos=\{172,40\},size=\{104,16\},title=\cf7 \strokec7 "Batch#"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,frame=0,value=S_DyeBatch\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 WEPanel(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "WorkingElectrode()"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 WorkingElectrode()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Panel\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 NewPanel\cf4 \strokec4 /K=2/W=(4,251,288,417)\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Working\cf3 \strokec3  \cf7 \strokec7 Electrode"\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyPanel\cf3 \strokec3  \cf4 \strokec4 cbRGB=(34733,8337,11421)\
\cf3 \strokec3 	\cf8 \strokec8 SetDrawEnv\cf3 \strokec3  \cf4 \strokec4 fsize=16,fstyle=1,textrgb=(65535,65532,16385);\cf3 \strokec3  \cf8 \strokec8 DrawText\cf3 \strokec3  \cf4 \strokec4 72,24,\cf7 \strokec7 "Film\cf3 \strokec3  \cf7 \strokec7 Parameters"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GroupBox\cf3 \strokec3  \cf4 \strokec4 box,pos=\{4,32\},size=\{276,130\},frame=1\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 we,pos=\{8,40\},size=\{160,16\},\cf9 \strokec9 proc\cf4 \strokec4 =setwe,title=\cf7 \strokec7 "Working\cf3 \strokec3  \cf7 \strokec7 Electrode:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,mode=V_ModeWE,value=#\cf7 \strokec7 "\\"NSG\cf3 \strokec3  \cf7 \strokec7 10\uc0\u937 /cm;NSG\cf3 \strokec3  \cf7 \strokec7 20\uc0\u937 /cm;LOF\cf3 \strokec3  \cf7 \strokec7 8\uc0\u937 /cm;LOF\cf3 \strokec3  \cf7 \strokec7 10\uc0\u937 /cm;LOF\cf3 \strokec3  \cf7 \strokec7 15\uc0\u937 /cm;Asahi\cf3 \strokec3  \cf7 \strokec7 7\uc0\u937 /cm;ITO\cf3 \strokec3  \cf7 \strokec7 5\uc0\u937 /cm;ITO\cf3 \strokec3  \cf7 \strokec7 10\uc0\u937 /cm\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 batch,pos=\{10,60\},size=\{192,16\},title=\cf7 \strokec7 "Batch\cf3 \strokec3  \cf7 \strokec7 #\cf3 \strokec3           \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,frame=0,value=S_WEbatch\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 thick,pos=\{10,80\},size=\{192,16\},title=\cf7 \strokec7 "Film\cf3 \strokec3  \cf7 \strokec7 thickness\cf3 \strokec3      \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.1W0Pm"\cf4 \strokec4 ,frame=0,limits=\{1e-7,2e-5,1e-7\},value=V_length\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 por,pos=\{10,100\},size=\{192,16\},title=\cf7 \strokec7 "Film\cf3 \strokec3  \cf7 \strokec7 Porosity\cf3 \strokec3           \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%2.0f\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 ,frame=0,limits=\{50,100,1\},value=V_Porosity\
\cf3 \strokec3 	\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 firetemp,pos=\{10,120\},size=\{192,16\},title=\cf7 \strokec7 "Firing\cf3 \strokec3  \cf7 \strokec7 Temperature:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%2.0f\'b0C"\cf4 \strokec4 ,frame=0,limits=\{50,600,10\},value=V_FireTemp\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 treat,pos=\{8,140\},size=\{160,16\},\cf9 \strokec9 proc\cf4 \strokec4 =setTreatment,title=\cf7 \strokec7 "Layer\cf3 \strokec3  \cf7 \strokec7 Treatment\cf3 \strokec3    \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fSize=12,mode=2,value=#\cf7 \strokec7 "\\"sc\cf3 \strokec3  \cf7 \strokec7 TiCl4;Heat;UV/O3;Heat&UV/O3\\""\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ElectrolytePanel(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "Electrolyte()"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Electrolyte()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Panel\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 NewPanel\cf4 \strokec4 /K=2/W=(164,251,644,480)\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Electrolyte\cf3 \strokec3  \cf7 \strokec7 List"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyPanel\cf3 \strokec3  \cf4 \strokec4 cbRGB=(65535,54611,49151)\
\cf3 \strokec3 	\cf8 \strokec8 ListBox\cf3 \strokec3  \cf4 \strokec4 lb0,pos=\{8,8\},size=\{464,200\},\cf9 \strokec9 proc\cf4 \strokec4 =SetElectrolyte,frame=2,listWave=Electrolytes,selWave=sjack,colorWave=myColors,mode=3,editStyle=1,row=V_modeElectrolyte,widths=\{56,40,54,56,64,64,48\}\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 pop,pos=\{8,210\},size=\{80,16\},\cf9 \strokec9 proc\cf4 \strokec4 =CellMode,title=\cf7 \strokec7 "Selection\cf3 \strokec3  \cf7 \strokec7 Mode"\cf4 \strokec4 ,font=\cf7 \strokec7 "Chicago"\cf4 \strokec4 ,fsize=12,mode=1,value=#\cf7 \strokec7 "\\"Contiguous\cf3 \strokec3  \cf7 \strokec7 Cells;Disjoint\cf3 \strokec3  \cf7 \strokec7 Cells\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ColumnLabels()\
\cf3 \strokec3 	\cf4 \strokec4 Colours()\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 UpdatePanel(infoStr)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Use\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 control\cf3 \strokec3  \cf2 \strokec2 parameters,\cf3 \strokec3  \cf2 \strokec2 dependencies\cf3 \strokec3  \cf2 \strokec2 etc.\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 infoStr\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 StrSearch\cf4 \strokec4 (infoStr,\cf7 \strokec7 "EVENT:activate;"\cf4 \strokec4 ,0)>0)\
\cf3 \strokec3 		\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s=\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "WIN:64"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (s,\cf7 \strokec7 "DyeSensitizer"\cf4 \strokec4 ,0)>-1)\
\cf3 \strokec3 			\cf4 \strokec4 Dye();\cf3 \strokec3  \cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 DyeSensitizer\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (s,\cf7 \strokec7 "Electrolyte"\cf4 \strokec4 ,0)>-1)\
\cf3 \strokec3 			\cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 Electrolyte\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (s,\cf7 \strokec7 "WorkingElectrode"\cf4 \strokec4 ,0)>-1)\
\cf3 \strokec3 			\cf4 \strokec4 WE();\cf3 \strokec3  \cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 WorkingElectrode\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (s,\cf7 \strokec7 "Files"\cf4 \strokec4 ,0)>-1)\
\cf3 \strokec3 			\cf4 \strokec4 SetFile();\cf3 \strokec3  \cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 Files\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 StrSearch\cf4 \strokec4 (infoStr,\cf7 \strokec7 "EVENT:kill;"\cf4 \strokec4 ,0)>0)\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 tabPanels(ctrlName,tab)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Panel\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 tab\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 RefDiodes\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_Lamp,V_numCell,V_refNum,V_RefCalibration,V_currentRef,V_complianceI,V_corrGain,V_counter\
\cf3 \strokec3 	\cf8 \strokec8 ControlInfo\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 $ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 tabName=S_Value,allControls=\cf6 \strokec6 ControlNameList\cf4 \strokec4 (\cf7 \strokec7 "configPanel"\cf4 \strokec4 ),str;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 str=\cf6 \strokec6 StringfromList\cf4 \strokec4 (n,allControls)\
\cf3 \strokec3 		 \cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 cmpstr\cf4 \strokec4 (str,\cf7 \strokec7 ""\cf4 \strokec4 ))\
\cf3 \strokec3 		 	\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		 \cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		 \cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 cmpstr\cf4 \strokec4 (str[2],\cf7 \strokec7 "_"\cf4 \strokec4 ))\
\cf3 \strokec3 		 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 cmpstr\cf4 \strokec4 (str[0,1],tabName[0,1]))\
\cf3 \strokec3 		 		\cf4 \strokec4 showControl(str,0)\
\cf3 \strokec3 		 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		 		\cf4 \strokec4 showControl(str,1)\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Disable\cf3 \strokec3  \cf2 \strokec2 Controls\cf4 \strokec4 \
\cf3 \strokec3 		 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		 \cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		 \cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 go\cf3 \strokec3  \cf4 \strokec4 win=ConfigPanel,disable=0\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ncell,win=ConfigPanel,disable=(tab!=1);\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ndev\cf3 \strokec3  \cf4 \strokec4 win=ConfigPanel,disable=(tab!=2)\
\cf3 \strokec3 	\cf8 \strokec8 CtrlBackground\cf3 \strokec3  \cf4 \strokec4 stop\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Standby"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Lamp)\
\cf3 \strokec3 		\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,1,\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (tab)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 0:\
\cf3 \strokec3 			\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 go,disable=2\
\cf3 \strokec3 			\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0\cf3 \strokec3  \cf4 \strokec4 win=ConfigPanel,labelBack=(45535,45535,50535),value=0\
\cf3 \strokec3 			\cf4 \strokec4 V_counter=0\
\cf3 \strokec3 			\cf8 \strokec8 CtrlBackground\cf3 \strokec3  \cf4 \strokec4 noBurst=1,start\
\cf3 \strokec3 			\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Setup"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Single\cf3 \strokec3  \cf2 \strokec2 Device\cf3 \strokec3  \cf2 \strokec2 option\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 V_refNum=10;\cf3 \strokec3  \cf4 \strokec4 V_currentRef=-15.8902;\cf3 \strokec3  \cf4 \strokec4 V_RefCalibration=V_currentRef\cf3 \strokec3 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 -16.3151\cf3 \strokec3  \cf2 \strokec2 (220321),\cf3 \strokec3  \cf2 \strokec2 -16.4549\cf3 \strokec3  \cf2 \strokec2 (211018),\cf3 \strokec3  \cf2 \strokec2 -16.2905\cf3 \strokec3  \cf2 \strokec2 (210823),\cf3 \strokec3  \cf2 \strokec2 -16.4574\cf3 \strokec3  \cf2 \strokec2 (201019),\cf3 \strokec3  \cf2 \strokec2 -27.2357\cf3 \strokec3 	 \cf2 \strokec2 after\cf3 \strokec3  \cf2 \strokec2 lamp\cf3 \strokec3  \cf2 \strokec2 change\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0\cf3 \strokec3  \cf4 \strokec4 win=ConfigPanel,labelBack=(50535,50535,45535),value=1\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Multi\cf3 \strokec3  \cf2 \strokec2 Device\cf3 \strokec3  \cf2 \strokec2 option\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 V_numCell=1;\cf3 \strokec3  \cf4 \strokec4 V_refNum=10;\cf3 \strokec3  \cf4 \strokec4 V_RefCalibration=0.1/RefDiodes[V_refNum][6]\
\cf3 \strokec3 			\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0\cf3 \strokec3  \cf4 \strokec4 win=ConfigPanel,labelBack=(55535,50535,35535),value=2\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 3:\
\cf3 \strokec3 			\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,labelBack=(45535,50535,50535),value=3\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 4:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Cell\cf3 \strokec3  \cf2 \strokec2 Specs.\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 go,disable=2;\cf3 \strokec3  \cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_layout,disable=2\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((\cf6 \strokec6 strsearch\cf4 \strokec4 (\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "WIN:1"\cf4 \strokec4 ),\cf7 \strokec7 "IVGraph"\cf4 \strokec4 ,0)>-1)||(\cf6 \strokec6 strsearch\cf4 \strokec4 (\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "WIN:1"\cf4 \strokec4 ),\cf7 \strokec7 "GraphPPT"\cf4 \strokec4 ,0)>-1)||(\cf6 \strokec6 strsearch\cf4 \strokec4 (\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "WIN:1"\cf4 \strokec4 ),\cf7 \strokec7 "TransientCGraph"\cf4 \strokec4 ,0)>-1)||(\cf6 \strokec6 strsearch\cf4 \strokec4 (\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "WIN:1"\cf4 \strokec4 ),\cf7 \strokec7 "TransientVGraph"\cf4 \strokec4 ,0)>-1))\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Only\cf3 \strokec3  \cf2 \strokec2 allow\cf3 \strokec3  \cf2 \strokec2 'Layout'\cf3 \strokec3  \cf2 \strokec2 if\cf3 \strokec3  \cf2 \strokec2 IVGraph\cf3 \strokec3  \cf2 \strokec2 present\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_layout,disable=0\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0\cf3 \strokec3  \cf4 \strokec4 win=ConfigPanel,labelBack=(40535,50535,40535),value=4\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 5:\
\cf3 \strokec3 			\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,labelBack=(50535,45535,45535),value=5\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 6:\
\cf3 \strokec3 			\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 go,disable=2\
\cf3 \strokec3 			\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,labelBack=(50535,45535,50535),value=6\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ShowControl(ctrlName,flg)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Show\cf3 \strokec3  \cf2 \strokec2 or\cf3 \strokec3  \cf2 \strokec2 hide\cf3 \strokec3  \cf2 \strokec2 all\cf3 \strokec3  \cf2 \strokec2 Control\cf3 \strokec3  \cf2 \strokec2 types\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 top\cf3 \strokec3  \cf2 \strokec2 window\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 flg\
\cf3 \strokec3 	\cf8 \strokec8 ControlInfo\cf3 \strokec3  \cf4 \strokec4 $ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 controlType=V_Flag\
\cf3 \strokec3 	\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (controlType)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 button\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 checkbox\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 CheckBox\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 3:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 popupmenu\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 4:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 valdisplay\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 5:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 setvariable\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 6:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 chart\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Chart\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 7:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 slider\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Slider\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 8:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 tab\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 9:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 groupbox\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 GroupBox\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 10:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 titlebox\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 11:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 listbox\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ListBox\cf3 \strokec3  \cf4 \strokec4 $ctrlName\cf3 \strokec3  \cf4 \strokec4 disable=flg\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Voltage_output(ctrlName,varNum,varStr,varName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 SetVariableControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,varStr,varName;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 varNum\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (varNum))\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 Voltage\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 ReadChannels()\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ReadChannels()\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Faster\cf3 \strokec3  \cf2 \strokec2 read\cf3 \strokec3  \cf2 \strokec2 than\cf3 \strokec3  \cf2 \strokec2 directly\cf3 \strokec3  \cf2 \strokec2 into\cf3 \strokec3  \cf2 \strokec2 ValDisplay\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_counter\
\cf3 \strokec3 	\cf4 \strokec4 ReadCurrent()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Read\cf3 \strokec3  \cf2 \strokec2 current\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_counter+=1\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_counter>16)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Force\cf3 \strokec3  \cf2 \strokec2 Setup\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 Quit\cf3 \strokec3  \cf2 \strokec2 after\cf3 \strokec3  \cf2 \strokec2 16\cf3 \strokec3  \cf2 \strokec2 measurements\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0\cf3 \strokec3  \cf4 \strokec4 win=configPanel,value=1;\cf3 \strokec3  \cf4 \strokec4 tabPanels(\cf7 \strokec7 "tab0"\cf4 \strokec4 ,1)\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ReadCurrent()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_DataChannel0,V_DataChannel2,V_DataChannel3\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:AUTO\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_DataChannel0=ReadData(1)\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:FRSW\cf3 \strokec3  \cf7 \strokec7 REAR"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 rear,\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 switches\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 OFF\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 So\cf3 \strokec3  \cf2 \strokec2 switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf3 \strokec3  \cf2 \strokec2 again\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_DataChannel2=ReadData(1)\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 V_DataChannel2=ReadDataWave("CURR","VOLT")\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:FRSW\cf3 \strokec3  \cf7 \strokec7 FRON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 front\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Shutter(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 ArduinoDigital(2,popNum-1)\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SelectSignal(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Sample\cf3 \strokec3  \cf2 \strokec2 or\cf3 \strokec3  \cf2 \strokec2 Reference\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf4 \strokec4 ArduinoDigital(6,popNum-1)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetCompliance(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Specify\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_complianceI\
\cf3 \strokec3 	\cf4 \strokec4 V_complianceI=\cf6 \strokec6 str2num\cf4 \strokec4 (popStr)/1e6\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Convert\cf3 \strokec3  \cf2 \strokec2 uA\cf3 \strokec3  \cf2 \strokec2 =>\cf3 \strokec3  \cf2 \strokec2 A\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_complianceI))\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 FFcontrol(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Specify\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_Henry\
\cf3 \strokec3 	\cf4 \strokec4 V_Henry=popNum\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 FourWire(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Specify\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:RSEN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (popNum-1))\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetDelay(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Specify\cf3 \strokec3  \cf2 \strokec2 settling\cf3 \strokec3  \cf2 \strokec2 times\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_settlingtime\
\cf3 \strokec3 	\cf9 \strokec9 strswitch\cf4 \strokec4 (popStr)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "AUTO"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_settlingtime=-1\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 If\cf3 \strokec3  \cf2 \strokec2 AUTO\cf3 \strokec3  \cf2 \strokec2 then\cf3 \strokec3  \cf2 \strokec2 -1\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 default\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_settlingtime=\cf6 \strokec6 str2num\cf4 \strokec4 (popStr)/1e3\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Convert\cf3 \strokec3  \cf2 \strokec2 ms\cf3 \strokec3  \cf2 \strokec2 =>\cf3 \strokec3  \cf2 \strokec2 s\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 NI488\cf3 \strokec3  \cf2 \strokec2 ibtmo\cf3 \strokec3  \cf2 \strokec2 sourcemeter,14\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Increase\cf3 \strokec3  \cf2 \strokec2 Timeout\cf3 \strokec3  \cf2 \strokec2 if\cf3 \strokec3  \cf2 \strokec2 necessary\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SunControl(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_sun\
\cf3 \strokec3 	\cf4 \strokec4 V_sun=popNum\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 CellNumber(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_numCell,V_incrVolt\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf4 \strokec4 V_numCell=popNum\
\cf3 \strokec3 	\cf4 \strokec4 V_incrVolt=5e-3;\cf3 \strokec3  \cf4 \strokec4 a=2\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (popNum>1)\
\cf3 \strokec3 		\cf4 \strokec4 V_incrVolt=1e-2;\cf3 \strokec3  \cf4 \strokec4 a=3\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (popNum>2)\
\cf3 \strokec3 		\cf4 \strokec4 V_incrVolt=2e-2;\cf3 \strokec3  \cf4 \strokec4 a=4\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (popNum>4)\
\cf3 \strokec3 		\cf4 \strokec4 V_incrVolt=5e-2;\cf3 \strokec3  \cf4 \strokec4 a=5\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Popupmenu\cf3 \strokec3  \cf4 \strokec4 iv_incr\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=a\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 DeviceNumber(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_numDev\
\cf3 \strokec3 	\cf4 \strokec4 V_numDev=popNum\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 User(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_UserName,S_Layer,S_Type,S_dye,S_DyeBatch,S_Solvent,S_electrolyte,S_Specification,S_cellName\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_porosity,V_settlingtime,V_complianceI,V_numCell,V_numDev,V_endVolt,V_length,V_run,V_incrVolt,V_Henry,PDFflag,V_delay\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=9,b=3,c=7;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf4 \strokec4 S_UserName=popStr;\cf3 \strokec3  \cf4 \strokec4 S_cellName=S_Username;\cf3 \strokec3  \cf4 \strokec4 V_complianceI=2e-3;\cf3 \strokec3   \cf4 \strokec4 V_settlingtime=0.04;\cf3 \strokec3  \cf4 \strokec4 V_endVolt=0;\cf3 \strokec3  \cf4 \strokec4 V_porosity=0.68;\cf3 \strokec3  \cf4 \strokec4 V_incrVolt=1e-2;\cf3 \strokec3  \cf4 \strokec4 V_run=1;\cf3 \strokec3  \cf4 \strokec4 V_Henry=0;\cf3 \strokec3  \cf4 \strokec4 PDFflag=1;\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 strswitch\cf3 \strokec3  \cf4 \strokec4 (S_UserName)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Aswani"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.16;\cf3 \strokec3  \cf4 \strokec4 V_length=1e-5\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "MG8"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Layer=\cf7 \strokec7 "Double\cf3 \strokec3  \cf7 \strokec7 (PC)\cf3 \strokec3  \cf7 \strokec7 10/4,\cf3 \strokec3  \cf7 \strokec7 sc.,+TiCl4"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "Co\cf3 \strokec3  \cf7 \strokec7 type"\cf4 \strokec4 ,S_cellName=\cf7 \strokec7 "AY"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Francine"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.158;\cf3 \strokec3  \cf4 \strokec4 V_porosity=0.58;\cf3 \strokec3  \cf4 \strokec4 V_settlingtime=0.1;\cf3 \strokec3  \cf4 \strokec4 c=10;\cf3 \strokec3  \cf4 \strokec4 b=2;\cf3 \strokec3  \cf4 \strokec4 V_numCell=1;\cf3 \strokec3  \cf4 \strokec4 V_numDev=1;\cf3 \strokec3  \cf4 \strokec4 V_length=1.2e-5\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "Z907"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_DyeBatch=\cf7 \strokec7 "270200"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Specification=\cf7 \strokec7 "Z907,DMF"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Solvent=\cf7 \strokec7 "DMF"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_electrolyte=\cf7 \strokec7 "Zxxx"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "DL-PC,ttt"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_cellName=\cf7 \strokec7 "FDA"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Joel"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.16;\cf3 \strokec3  \cf4 \strokec4 V_settlingtime=0.01;\cf3 \strokec3  \cf4 \strokec4 V_length=5e-7;\cf3 \strokec3  \cf4 \strokec4 c=5\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "Perovskite"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_electrolyte=\cf7 \strokec7 "OMeTAD"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Layer=\cf7 \strokec7 "Evapourated\cf3 \strokec3  \cf7 \strokec7 sc.,+TiCl4"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "SI\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,S_cellName=\cf7 \strokec7 "JTNT"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Paul"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.157;\cf3 \strokec3  \cf4 \strokec4 V_complianceI=5e-3;\cf3 \strokec3  \cf4 \strokec4 a=10;\cf3 \strokec3  \cf4 \strokec4 V_length=1.2e-5;\cf3 \strokec3  \cf4 \strokec4 PDFflag=0\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "N719"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_electrolyte=\cf7 \strokec7 "332"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Layer=\cf7 \strokec7 "Double\cf3 \strokec3  \cf7 \strokec7 (PC)\cf3 \strokec3  \cf7 \strokec7 12/4,\cf3 \strokec3  \cf7 \strokec7 sc.,+TiCl4"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "PC\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,S_cellName=\cf7 \strokec7 "PL"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Perovskite"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.16;\cf3 \strokec3  \cf4 \strokec4 V_complianceI=2e-3;\cf3 \strokec3  \cf4 \strokec4 c=13;\cf3 \strokec3  \cf4 \strokec4 V_numCell=1;\cf3 \strokec3  \cf4 \strokec4 V_length=1e-6;\cf3 \strokec3  \cf4 \strokec4 V_settlingtime=0.2;\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "Perovskite"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "Perovskite"\cf4 \strokec4 ,S_cellName=\cf7 \strokec7 "Perov"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Norman"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.285;\cf3 \strokec3  \cf4 \strokec4 V_settlingtime=0.2;\cf3 \strokec3  \cf4 \strokec4 c=11;\cf3 \strokec3  \cf4 \strokec4 V_delay=5;\cf3 \strokec3  \cf4 \strokec4 V_incrVolt=5e-3\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "CH3NH3PbI3"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_electrolyte=\cf7 \strokec7 "Spiro-OMeTAD"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "Perovskite\cf3 \strokec3  \cf7 \strokec7 cell"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_cellName=\cf7 \strokec7 "np-"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Layer\cf3 \strokec3  \cf4 \strokec4 =\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Jessi"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Zhipan"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Takeru"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Seigo"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Juno"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Le"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Nok"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Mingqui"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Kuang"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Peng"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.158;\cf3 \strokec3  \cf4 \strokec4 V_length=1e-5\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "K19"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_electrolyte=\cf7 \strokec7 "Z208"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Layer=\cf7 \strokec7 "Double\cf3 \strokec3  \cf7 \strokec7 (PC)\cf3 \strokec3  \cf7 \strokec7 10/4,\cf3 \strokec3  \cf7 \strokec7 sc.,+TiCl4"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "PC\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_cellName=\cf7 \strokec7 "kdb"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Sophie"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.159;\cf3 \strokec3  \cf4 \strokec4 V_length=1e-5\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "Z907"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_electrolyte=\cf7 \strokec7 "Z646"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Layer=\cf7 \strokec7 "(PC)\cf3 \strokec3  \cf7 \strokec7 5.3,\cf3 \strokec3  \cf7 \strokec7 sc.,+TiCl4"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "SI\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,S_cellName=\cf7 \strokec7 "sw_"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Andreas"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Visitor"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.16;\cf3 \strokec3  \cf4 \strokec4 V_numCell=1;\cf3 \strokec3  \cf4 \strokec4 V_length=6e-6\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "N719"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Solvent=\cf7 \strokec7 "MeCN/tBuOH"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Specification=\cf7 \strokec7 "MeCN/tBuOH"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_electrolyte=\cf7 \strokec7 "956"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Layer=\cf7 \strokec7 "Double\cf3 \strokec3  \cf7 \strokec7 (PC)\cf3 \strokec3  \cf7 \strokec7 12/4,\cf3 \strokec3  \cf7 \strokec7 sc.,+TiCl4"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "PC\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 default\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 V_area=0.5;\cf3 \strokec3  \cf4 \strokec4 V_complianceI=2e-3;\cf3 \strokec3  \cf4 \strokec4 V_numCell=1;\cf3 \strokec3  \cf4 \strokec4 V_length=8e-6;\cf3 \strokec3  \cf4 \strokec4 V_run=1;\cf3 \strokec3  \cf4 \strokec4 antidote()\
\cf3 \strokec3 			\cf4 \strokec4 S_dye=\cf7 \strokec7 "Si"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Specification=\cf7 \strokec7 "LCE\cf3 \strokec3  \cf7 \strokec7 50"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Layer=\cf7 \strokec7 "Transp.\cf3 \strokec3  \cf7 \strokec7 (PC),\cf3 \strokec3  \cf7 \strokec7 sc.,+TiCl4"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_electrolyte=\cf7 \strokec7 "e-h+"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_Type=\cf7 \strokec7 "Si\cf3 \strokec3  \cf7 \strokec7 Ref\cf3 \strokec3  \cf7 \strokec7 #7\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Antidote()\
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_avg\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=a;\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_gain1,win=configpanel,mode=c;\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ncell\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=V_numCell\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_incr\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=b;\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ndev\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=V_numDev;\cf3 \strokec3  \cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 sp_num\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=V_run\
\cf3 \strokec3 	\cf4 \strokec4 ScanDirection(\cf7 \strokec7 ""\cf4 \strokec4 ,1,\cf7 \strokec7 ""\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 ca_dir,win=configpanel,mode=1\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 default\cf3 \strokec3  \cf2 \strokec2 Sweep:\cf3 \strokec3  \cf2 \strokec2 High\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 Low\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 SetDelay(\cf7 \strokec7 "settling"\cf4 \strokec4 ,c,\cf6 \strokec6 num2str\cf4 \strokec4 (V_settlingtime*1e3))\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "SetCompliance(\\"avg\\",%g,\\"%s\\")"\cf4 \strokec4 ,a,\cf6 \strokec6 num2str\cf4 \strokec4 (V_complianceI*1e6);\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "SetIncrement(\\"incr\\",%g,\\"%s\\")"\cf4 \strokec4 ,V_incrVolt,\cf6 \strokec6 num2str\cf4 \strokec4 (V_incrVolt*1e3);\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SelectCell(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Sample\cf3 \strokec3  \cf2 \strokec2 or\cf3 \strokec3  \cf2 \strokec2 Reference\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (popNum<3)\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 		\cf2 \strokec2 ArduinoDigital(4,popNum-1)\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Go(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_username\
\cf3 \strokec3 	\cf8 \strokec8 ControlInfo\cf3 \strokec3  \cf4 \strokec4 tab0\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 controlType=V_Value;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (controlType)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 0:\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\
\cf3 \strokec3 			\cf4 \strokec4 CellTest(S_username)\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\
\cf3 \strokec3 			\cf4 \strokec4 MultiCellTest(1)\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 3:\
\cf3 \strokec3 			\cf4 \strokec4 Stability()\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 5:\
\cf3 \strokec3 			\cf4 \strokec4 VdP(\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetAverage(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 scans\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 NIDAQ\cf3 \strokec3  \cf2 \strokec2 data\cf3 \strokec3  \cf2 \strokec2 acquisitions\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_navg\
\cf3 \strokec3 	\cf4 \strokec4 V_navg=\cf6 \strokec6 str2num\cf4 \strokec4 (popStr)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 PPTDuration(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_PPTDuration\
\cf3 \strokec3 	\cf4 \strokec4 V_PPTDuration=\cf6 \strokec6 str2num\cf4 \strokec4 (popStr)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 pulsedMode(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_pulsedMode\
\cf3 \strokec3 	\cf4 \strokec4 V_pulsedMode=popNum-1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 dutyCycle(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_dutyCycle\
\cf3 \strokec3 	\cf4 \strokec4 V_dutyCycle=\cf6 \strokec6 str2num\cf4 \strokec4 (popStr)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 setInteg(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_integTime\
\cf3 \strokec3 	\cf4 \strokec4 V_integTime=\cf6 \strokec6 str2num\cf4 \strokec4 (popStr)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetWE(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_ModeWE\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_WE\
\cf3 \strokec3 	\cf4 \strokec4 S_WE=popStr;\cf3 \strokec3  \cf4 \strokec4 V_ModeWE=popNum\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetTreatment(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_WETreatment\
\cf3 \strokec3 	\cf4 \strokec4 S_WETreatment=popStr\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetCE(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_CE\
\cf3 \strokec3 	\cf4 \strokec4 S_CE=popStr\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetDye(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_ModeDye\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Dye\
\cf3 \strokec3 	\cf4 \strokec4 S_Dye=popStr;\cf3 \strokec3  \cf4 \strokec4 V_ModeDye=popNum\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 cmpstr\cf4 \strokec4 (S_Dye,\cf7 \strokec7 "none"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf4 \strokec4 new_molecule()\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_dye0,win=ConfigPanel,title=\cf7 \strokec7 "Dye:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +popStr\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 LoadPICT/O/Q/M="Select\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 ChemDraw\cf3 \strokec3  \cf2 \strokec2 Molecule"/P=Moleculepath\cf3 \strokec3  \cf2 \strokec2 S_Dye,PICT_0\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetSolvent(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_modeSolvent\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Solvent\
\cf3 \strokec3 	\cf4 \strokec4 S_Solvent=popStr;\cf3 \strokec3  \cf4 \strokec4 V_modeSolvent=popNum\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 New_molecule()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Dye\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf9 \strokec9 Prompt\cf3 \strokec3  \cf4 \strokec4 a,\cf7 \strokec7 "Enter\cf3 \strokec3  \cf7 \strokec7 the\cf3 \strokec3  \cf7 \strokec7 name\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 the\cf3 \strokec3  \cf7 \strokec7 Molecule,\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 first\cf3 \strokec3  \cf7 \strokec7 having\cf3 \strokec3  \cf7 \strokec7 copied\cf3 \strokec3  \cf7 \strokec7 it\cf3 \strokec3  \cf7 \strokec7 from\cf3 \strokec3  \cf7 \strokec7 ChemDraw"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "New\cf3 \strokec3  \cf7 \strokec7 Dye\cf3 \strokec3  \cf7 \strokec7 Molecule"\cf4 \strokec4 ,a\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 S_Dye=a\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 Dye()\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Dye\cf3 \strokec3  \cf2 \strokec2 Specifications\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_Time,V_dyeConc\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_specification,S_DyeBatch,S_Solvent\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 S_specification,\cf7 \strokec7 "(%s),%s,\cf3 \strokec3  \cf7 \strokec7 %.0W0PM,\cf3 \strokec3  \cf7 \strokec7 %gh"\cf4 \strokec4 ,S_DyeBatch,S_Solvent,V_dyeConc,V_time\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 WE()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_length,V_Porosity,V_FireTemp\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_layer,S_WE,S_WEBatch,S_WETreatment\
\cf3 \strokec3 	\cf4 \strokec4 S_layer=S_WEBatch+\cf7 \strokec7 ","\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_length*1e6)+\cf7 \strokec7 "\'b5m-"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_Porosity)+\cf7 \strokec7 "%,\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_FireTemp)+\cf7 \strokec7 "\'b0C,\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_WETreatment\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ColumnLabels()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 Electrolytes\
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 WaveExists\cf4 \strokec4 (Electrolytes))\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 i,ncols=\cf6 \strokec6 DimSize\cf4 \strokec4 (Electrolytes,1)\
\cf3 \strokec3 	\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<ncols;\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 		\cf8 \strokec8 SetDimLabel\cf3 \strokec3  \cf4 \strokec4 1,i,$\cf6 \strokec6 StringFromList\cf4 \strokec4 (i,\cf7 \strokec7 "Electrolyte;\cf3 \strokec3   \cf7 \strokec7 Conc;Molten\cf3 \strokec3  \cf7 \strokec7 Salt;\cf3 \strokec3      \cf7 \strokec7 [I2];\cf3 \strokec3     \cf7 \strokec7 [Base];\cf3 \strokec3   \cf7 \strokec7 Additives;\cf3 \strokec3    \cf7 \strokec7 Solvent"\cf4 \strokec4 ),Electrolytes\
\cf3 \strokec3 	\cf9 \strokec9 endfor\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Colours()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 Electrolytes\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 sjack\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(\cf6 \strokec6 DimSize\cf4 \strokec4 (Electrolytes,0),-1,3)\cf3 \strokec3  \cf4 \strokec4 sjack\
\cf3 \strokec3 	\cf8 \strokec8 SetDimLabel\cf3 \strokec3  \cf4 \strokec4 2,1,foreColors,sjack;\cf3 \strokec3  \cf8 \strokec8 SetDimLabel\cf3 \strokec3  \cf4 \strokec4 2,2,backColors,sjack\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Colour\cf3 \strokec3  \cf2 \strokec2 determined\cf3 \strokec3  \cf2 \strokec2 by\cf3 \strokec3  \cf2 \strokec2 DimLabel\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 sjack[][][1]=3;\cf3 \strokec3  \cf4 \strokec4 sjack[][][2]=1\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 colours\cf3 \strokec3  \cf2 \strokec2 from\cf3 \strokec3  \cf2 \strokec2 ColourWave\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 CellMode(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf8 \strokec8 ListBox\cf3 \strokec3  \cf4 \strokec4 lb0,mode=(popNum-1)?8:3\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetElectrolyte(ctrlName,row,col,event)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName;\cf3 \strokec3  	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 row,col,event\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 w=Electrolytes\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 sjack\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_modeElectrolyte\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Electrolyte\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 i\
\cf3 \strokec3 	\cf8 \strokec8 ControlInfo\cf4 \strokec4 /W=Electrolyte\cf3 \strokec3  \cf4 \strokec4 pop\
\cf3 \strokec3 	\cf4 \strokec4 S_Electrolyte=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (event==2)\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Value==1)\
\cf3 \strokec3 			\cf9 \strokec9 for\cf4 \strokec4 (i=1;\cf3 \strokec3  \cf4 \strokec4 i<7;\cf3 \strokec3  \cf4 \strokec4 i+=1)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 blanks\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 S_Electrolyte+=\cf6 \strokec6 SelectString\cf4 \strokec4 (\cf6 \strokec6 strlen\cf4 \strokec4 (w[row][i][0])>0,\cf7 \strokec7 ""\cf4 \strokec4 ,w[row][i]+\cf7 \strokec7 ","\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 for\cf4 \strokec4 (i=1;\cf3 \strokec3  \cf4 \strokec4 i<7;\cf3 \strokec3  \cf4 \strokec4 i+=1)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 Electrolytes\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Multiple\cf3 \strokec3  \cf2 \strokec2 selections\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 S_Electrolyte+=\cf6 \strokec6 SelectString\cf4 \strokec4 (sjack[row][i][0]&~0x02,\cf7 \strokec7 ""\cf4 \strokec4 ,w[row][i]+\cf7 \strokec7 ","\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_modeElectrolyte=row;\cf3 \strokec3  \cf4 \strokec4 S_Electrolyte=S_Electrolyte[0,\cf6 \strokec6 strlen\cf4 \strokec4 (S_Electrolyte)-2]\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_el0,win=ConfigPanel,title=\cf7 \strokec7 "Electrolyte:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +w[row][0]\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetLamp(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 DiodeLabels,MenuLabels\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_lamp,V_misMatch\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_lamp\
\cf3 \strokec3 	\cf4 \strokec4 V_lamp=(popNum>1);\cf3 \strokec3  \cf4 \strokec4 V_misMatch=(popNum>1)?1:1.12;\cf3 \strokec3  \cf4 \strokec4 S_Lamp=popStr\
\cf3 \strokec3 	\cf4 \strokec4 MenuLabels=DiodeLabels[p][V_lamp]\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Lamp)\
\cf3 \strokec3 		\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,1,\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0,disable=0\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,5,\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0,disable=1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 LampControl(ctrlName,varNum,event)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 SetVariableControl\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Slider\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 varNum,event\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 dummyw1,PSUSettings\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_lamp\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,level\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_lamp)\
\cf3 \strokec3 		\cf8 \strokec8 Findlevel\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 PSUSettings,varNum;\cf3 \strokec3  \cf4 \strokec4 b=\cf6 \strokec6 round\cf4 \strokec4 (V_levelx)\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 light\cf3 \strokec3  \cf2 \strokec2 level\cf3 \strokec3  \cf2 \strokec2 #\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 a=6-(1*(b==0)+2*(b==2)+3*(b==4)+4*(b==5)+5*(b==10));\cf3 \strokec3  \cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,a,ctrlName)\
\cf3 \strokec3 		\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=a;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 filter0\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 level=varNum*136.5\
\cf3 \strokec3 		\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,5,\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Ensure\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 filter\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 open\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (level>4096)\
\cf3 \strokec3 			\cf4 \strokec4 level=4096\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 ArduinoOutAnalog(0,level)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Calibrated\cf3 \strokec3  \cf2 \strokec2 light\cf3 \strokec3  \cf2 \strokec2 intensities\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 DAC0\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 FilterWheel(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Digital\cf3 \strokec3  \cf2 \strokec2 out\cf3 \strokec3  \cf2 \strokec2 0,\cf3 \strokec3  \cf2 \strokec2 x000xxxx\cf3 \strokec3  \cf2 \strokec2 on\cf3 \strokec3  \cf2 \strokec2 Keithley\cf3 \strokec3  \cf2 \strokec2 Source\cf3 \strokec3  \cf2 \strokec2 meter\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR2:TTL:LEV\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (\cf6 \strokec6 mod\cf4 \strokec4 (popNum+1,6)))\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetIncrement(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_incrVolt\
\cf3 \strokec3 	\cf4 \strokec4 V_incrVolt=\cf6 \strokec6 str2num\cf4 \strokec4 (popStr)*1e-3\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Scale\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 mV\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 VoltLimit(ctrlName,varNum,varStr,varName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 SetVariableControl\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 400mV\cf3 \strokec3  \cf2 \strokec2 limit\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,varStr,varName;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 varNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_voltFlag,V_endVolt\
\cf3 \strokec3 	\cf4 \strokec4 V_voltFlag=varNum>0.2?1\cf3 \strokec3  \cf4 \strokec4 :0\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Calibrate(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Refdiodes\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_corrGain,V_numpnts,V_RefCalibration5,V_RefCalibration,V_RefCalibration2,V_RefCalibration3,V_RefCalibration4,V_RefCalibration5\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_CalibrationFile,S_username\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,c,d,e,f,ref=6;\cf3 \strokec3  \cf4 \strokec4 V_numpnts=100\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 cmpstr\cf4 \strokec4 (S_username,\cf7 \strokec7 "Robin"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf7 \strokec7 "Who\cf3 \strokec3  \cf7 \strokec7 you!.\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_username+\cf7 \strokec7 ",\cf3 \strokec3  \cf7 \strokec7 you\cf3 \strokec3  \cf7 \strokec7 are\cf3 \strokec3  \cf7 \strokec7 not\cf3 \strokec3  \cf7 \strokec7 qualified\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 do\cf3 \strokec3  \cf7 \strokec7 a\cf3 \strokec3  \cf7 \strokec7 calibration!\cf3 \strokec3  \cf7 \strokec7 -\cf3 \strokec3  \cf7 \strokec7 Ask\cf3 \strokec3  \cf7 \strokec7 Robin\cf3 \strokec3  \cf7 \strokec7 -"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 abort\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 CtrlBackground\cf3 \strokec3  \cf4 \strokec4 stop\
\cf3 \strokec3 	\cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf7 \strokec7 "Put\cf3 \strokec3  \cf7 \strokec7 a\cf3 \strokec3  \cf7 \strokec7 Calibrated\cf3 \strokec3  \cf7 \strokec7 Si\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 in\cf3 \strokec3  \cf7 \strokec7 the\cf3 \strokec3  \cf7 \strokec7 Test\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 holder"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Cell_Area();\cf3 \strokec3  \cf4 \strokec4 V_corrGain=1\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Amplifier\cf3 \strokec3  \cf2 \strokec2 Gain\cf3 \strokec3  \cf2 \strokec2 Correction\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Keithley\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 assumed\cf3 \strokec3  \cf2 \strokec2 as\cf3 \strokec3  \cf2 \strokec2 1\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:ELEM\cf3 \strokec3  \cf7 \strokec7 CURR"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:MODE\cf3 \strokec3  \cf7 \strokec7 FIX;:SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 0.01"\cf4 \strokec4 )\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fixed\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (\cf6 \strokec6 ceil\cf4 \strokec4 (16*V_area)/1e3))\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:AUTO\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Test\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf4 \strokec4 SelectCell(\cf7 \strokec7 "Cell"\cf4 \strokec4 ,2,\cf7 \strokec7 "Test\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 Test\cf3 \strokec3  \cf2 \strokec2 Cell\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 6;\cf3 \strokec3  \cf4 \strokec4 a=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 dark\cf3 \strokec3  \cf2 \strokec2 intensity\cf3 \strokec3  \cf2 \strokec2 value\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,2,\cf7 \strokec7 "Open"\cf4 \strokec4 )\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Open\cf3 \strokec3  \cf2 \strokec2 Shutter\cf3 \strokec3  \cf2 \strokec2 #1\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 2;\cf3 \strokec3  \cf4 \strokec4 b=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 intensity\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,7,\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=5\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 6;\cf3 \strokec3  \cf4 \strokec4 c=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 sun\cf3 \strokec3  \cf2 \strokec2 intensity\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 SelectCell(\cf7 \strokec7 "Cell"\cf4 \strokec4 ,1,\cf7 \strokec7 "Ref\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 Reference\cf3 \strokec3  \cf2 \strokec2 Cell\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 2;\cf3 \strokec3  \cf4 \strokec4 a+=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 dark\cf3 \strokec3  \cf2 \strokec2 intensity\cf3 \strokec3  \cf2 \strokec2 value\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,3,\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=1\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 SelectCell(\cf7 \strokec7 "Cell"\cf4 \strokec4 ,1,\cf7 \strokec7 "Ref\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 Reference\cf3 \strokec3  \cf2 \strokec2 Cell\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Reference\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf4 \strokec4 a/2,b,c\
\cf3 \strokec3 	\cf4 \strokec4 b-=(a/2);\cf3 \strokec3  \cf4 \strokec4 c-=(a/2)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Ref.\cf3 \strokec3  \cf7 \strokec7 calibration\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 0.1\cf3 \strokec3  \cf7 \strokec7 sun:\cf3 \strokec3  \cf7 \strokec7 Calibration\cf3 \strokec3  \cf7 \strokec7 Si\cf3 \strokec3  \cf7 \strokec7 cell,\cf3 \strokec3  \cf7 \strokec7 new\cf3 \strokec3  \cf7 \strokec7 value:"\cf4 \strokec4 ,b,\cf7 \strokec7 "%\cf3 \strokec3  \cf7 \strokec7 error:"\cf4 \strokec4 ,100*(Refdiodes[ref][2]/V_corrGain/b-1)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Ref.\cf3 \strokec3  \cf7 \strokec7 calibration\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3     \cf7 \strokec7 1\cf3 \strokec3  \cf7 \strokec7 sun:\cf3 \strokec3  \cf7 \strokec7 Calibration\cf3 \strokec3  \cf7 \strokec7 Si\cf3 \strokec3  \cf7 \strokec7 cell,\cf3 \strokec3  \cf7 \strokec7 new\cf3 \strokec3  \cf7 \strokec7 value:"\cf4 \strokec4 ,c,\cf7 \strokec7 "%\cf3 \strokec3  \cf7 \strokec7 error:"\cf4 \strokec4 ,100*(Refdiodes[ref][6]/V_corrGain/c-1)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Amplifier\cf3 \strokec3  \cf7 \strokec7 Gain\cf3 \strokec3  \cf7 \strokec7 Correction,\cf3 \strokec3  \cf7 \strokec7 -\cf3 \strokec3  \cf7 \strokec7 new:"\cf4 \strokec4 ,Refdiodes[ref][6]/c,\cf7 \strokec7 ",\cf3 \strokec3  \cf7 \strokec7 -\cf3 \strokec3  \cf7 \strokec7 old:"\cf4 \strokec4 ,V_corrGain\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((\cf6 \strokec6 abs\cf4 \strokec4 (100*Refdiodes[ref][2]/V_corrGain/b-1)>0.05)%|(\cf6 \strokec6 abs\cf4 \strokec4 (100*Refdiodes[ref][6]/V_corrGain/c-1)>0.02)==1)\
\cf3 \strokec3 		\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 beep\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 1,\cf7 \strokec7 "Calibration\cf3 \strokec3  \cf7 \strokec7 values\cf3 \strokec3  \cf7 \strokec7 have\cf3 \strokec3  \cf7 \strokec7 drifted\cf3 \strokec3  \cf7 \strokec7 out.\cf3 \strokec3  \cf7 \strokec7 Check\cf3 \strokec3  \cf7 \strokec7 PhotoCell,\cf3 \strokec3  \cf7 \strokec7 Xe\cf3 \strokec3  \cf7 \strokec7 lamp\cf3 \strokec3  \cf7 \strokec7 or\cf3 \strokec3  \cf7 \strokec7 calibration\cf3 \strokec3  \cf7 \strokec7 values!"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag==1)\
\cf3 \strokec3 			\cf4 \strokec4 V_corrGain=Refdiodes[ref][6]/c\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Update\cf3 \strokec3  \cf2 \strokec2 Buffer\cf3 \strokec3  \cf2 \strokec2 Amplifier\cf3 \strokec3  \cf2 \strokec2 Gain\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 a=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 dark\cf3 \strokec3  \cf2 \strokec2 intensity\cf3 \strokec3  \cf2 \strokec2 value\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,2,\cf7 \strokec7 "Open"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Open\cf3 \strokec3  \cf2 \strokec2 Shutter\cf3 \strokec3  \cf2 \strokec2 #1\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 b=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 sun\cf3 \strokec3  \cf2 \strokec2 intensity\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,4,\cf7 \strokec7 "30%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=2\
\cf3 \strokec3 			\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 6;\cf3 \strokec3  \cf4 \strokec4 c=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 1/3\cf3 \strokec3  \cf2 \strokec2 sun\cf3 \strokec3  \cf2 \strokec2 intensity\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,5,\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=3\
\cf3 \strokec3 			\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 6;\cf3 \strokec3  \cf4 \strokec4 d=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 1/2\cf3 \strokec3  \cf2 \strokec2 sun\cf3 \strokec3  \cf2 \strokec2 intensity\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,6,\cf7 \strokec7 "64%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=4\
\cf3 \strokec3 			\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 6;\cf3 \strokec3  \cf4 \strokec4 e=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 3/4\cf3 \strokec3  \cf2 \strokec2 sun\cf3 \strokec3  \cf2 \strokec2 intensity\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,7,\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=5\
\cf3 \strokec3 			\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 6;\cf3 \strokec3  \cf4 \strokec4 f=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 sun\cf3 \strokec3  \cf2 \strokec2 intensity\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,1,\cf7 \strokec7 "Close"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Close\cf3 \strokec3  \cf2 \strokec2 Shutter\cf3 \strokec3  \cf2 \strokec2 #1\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 6;\cf3 \strokec3  \cf4 \strokec4 a+=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 dark\cf3 \strokec3  \cf2 \strokec2 intensity\cf3 \strokec3  \cf2 \strokec2 value\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,3,\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=1\cf3 \strokec3 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 V_RefCalibration5=0.0096/Refdiodes[9][4];\cf3 \strokec3  \cf4 \strokec4 V_RefCalibration4=0.0305/Refdiodes[9][3]\
\cf3 \strokec3 			\cf4 \strokec4 V_RefCalibration3=0.053/Refdiodes[9][2];\cf3 \strokec3  \cf4 \strokec4 V_RefCalibration2=0.064/Refdiodes[9][1]\
\cf3 \strokec3 			\cf4 \strokec4 V_RefCalibration=0.1/Refdiodes[9][0]\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 1000\cf3 \strokec3  \cf2 \strokec2 or\cf3 \strokec3  \cf2 \strokec2 964\cf3 \strokec3  \cf2 \strokec2 W/m2/nm\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Correction\cf3 \strokec3  \cf7 \strokec7 Factors\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 0.1\cf3 \strokec3  \cf7 \strokec7 sun:"\cf4 \strokec4 ,V_RefCalibration5,\cf7 \strokec7 ",\cf3 \strokec3  \cf7 \strokec7 @1\cf3 \strokec3  \cf7 \strokec7 sun:"\cf4 \strokec4 ,V_RefCalibration\
\cf3 \strokec3 			\cf4 \strokec4 S_CalibrationFile=\cf7 \strokec7 "KIDAC:\cf3 \strokec3  \cf7 \strokec7 Ref\cf3 \strokec3  \cf7 \strokec7 Cell#"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (ref)+\cf7 \strokec7 ",\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 Date\cf4 \strokec4 ()\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 SelectCell(\cf7 \strokec7 "Cell"\cf4 \strokec4 ,2,\cf7 \strokec7 "Test\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 Test\cf3 \strokec3  \cf2 \strokec2 Cell\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ScanFinish()\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Standby"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf3 \strokec3 	\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Stability()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Direct\cf3 \strokec3  \cf2 \strokec2 Scan\cf3 \strokec3  \cf2 \strokec2 control\cf3 \strokec3  \cf2 \strokec2 from\cf3 \strokec3  \cf2 \strokec2 Igor\cf3 \strokec3  \cf2 \strokec2 macro\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 DiodeLabels\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,PhotoDiode,Voltage,Potential,Thermopile,Input0,Input1,Input2,Input3,Input4\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_counter,V_scans,V_steptime,V_numpnts\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,S_status,S_windowname,option5\
\cf3 \strokec3 	\cf8 \strokec8 ControlInfo\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 Filter\cf3 \strokec3  \cf2 \strokec2 Wheel\cf3 \strokec3  \cf2 \strokec2 Text#\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 wname=\cf7 \strokec7 "PhotoCurrent"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_Value);\cf3 \strokec3  \cf4 \strokec4 S_Status=S_Value+\cf7 \strokec7 ";"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_Value)\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=200\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_scans)\cf3 \strokec3  \cf4 \strokec4 Input0,Input1,Input2,Input3,Input4\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 0,V_steptime,\cf7 \strokec7 "m"\cf3 \strokec3  \cf4 \strokec4 Input0,Input1,Input2,Input3,Input4\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 GraphTStability\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "GraphTStability()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_counter=0;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "GraphTStability"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf4 \strokec4 allwaves=wname+\cf7 \strokec7 ","\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "IVGraph()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "AcquireStyle1()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 allwaves=\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "PhotoCurrent*"\cf4 \strokec4 ,\cf7 \strokec7 ","\cf4 \strokec4 ,\cf7 \strokec7 "win:IVGraph"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 StrSearch\cf4 \strokec4 (allwaves,wname,0)<0)\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 if\cf3 \strokec3  \cf2 \strokec2 wave\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 already\cf3 \strokec3  \cf2 \strokec2 displayed\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 AppendtoGraph\cf3 \strokec3  \cf4 \strokec4 $wname;\cf3 \strokec3  \cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle($wname)=V_Value\
\cf3 \strokec3 			\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=text0/J/F=0/A=MC/X=62/Y=-48\cf3 \strokec3  \cf4 \strokec4 Legendtext(allwaves+wname,1)\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Testing\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 Voc"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf4 \strokec4 ScanTest(0)\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 Thermopile,PhotoDiode,Voltage,PhotoCurrent,Potential\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Testing\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 Stability"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf8 \strokec8 SetBackground\cf3 \strokec3  \cf4 \strokec4 IVScan()\
\cf3 \strokec3 	\cf8 \strokec8 CtrlBackground\cf3 \strokec3  \cf4 \strokec4 period=(V_steptime*60*60),start\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Approx\cf3 \strokec3  \cf2 \strokec2 60*60/m\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Data"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 IVScan()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Offset,PhotoCurrent,Thermopile\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Input0,Input1,Input2,Input3,Input4,PSUSettings\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVparams\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_DataChannel2,V_RefCalibration,V_sun,V_counter\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Status\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 b=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringfromList\cf4 \strokec4 (1,S_Status))\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=12*(7-b)\
\cf3 \strokec3 	\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(b),4)\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Open\cf3 \strokec3  \cf2 \strokec2 Shutter\cf3 \strokec3  \cf2 \strokec2 #1\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 cmd,\cf7 \strokec7 "Sun(\\"%s\\",%g)"\cf4 \strokec4 ,\cf6 \strokec6 StringfromList\cf4 \strokec4 (0,S_Status),b;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!(V_sun-1))\
\cf3 \strokec3 		\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(b),4)\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 For\cf3 \strokec3  \cf2 \strokec2 non-stop\cf3 \strokec3  \cf2 \strokec2 Sun\cf3 \strokec3  \cf2 \strokec2 control\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 cmd,\cf7 \strokec7 "IV_params(\\"%s\\")"\cf4 \strokec4 ,\cf7 \strokec7 "PhotoCurrent"\cf4 \strokec4 +\cf6 \strokec6 StringfromList\cf4 \strokec4 (1,S_Status);\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 cmd\cf3 \strokec3 														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Calculate\cf3 \strokec3  \cf2 \strokec2 Voc,\cf3 \strokec3  \cf2 \strokec2 Isc,\cf3 \strokec3  \cf2 \strokec2 Upmax\cf3 \strokec3  \cf2 \strokec2 &\cf3 \strokec3  \cf2 \strokec2 Ipmax\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf4 \strokec4 Input0[V_counter]=IVparams[a+3];\cf3 \strokec3  \cf4 \strokec4 Input1[V_counter]=IVparams[a+4];\cf3 \strokec3  \cf4 \strokec4 Input2[V_counter]=IVparams[a+6];\cf3 \strokec3  \cf4 \strokec4 Input3[V_counter]=IVparams[a+7]\
\cf3 \strokec3 	\cf4 \strokec4 Input4[V_counter]=\cf6 \strokec6 abs\cf4 \strokec4 (V_DataChannel2*V_RefCalibration)\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Power\cf3 \strokec3  \cf2 \strokec2 in\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Save\cf4 \strokec4 /C/O/P=home\cf3 \strokec3  \cf4 \strokec4 Input0,Input1,Input2,Input3,Input4\
\cf3 \strokec3 	\cf4 \strokec4 V_counter+=1\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_counter>(\cf6 \strokec6 numpnts\cf4 \strokec4 (Input0)-1))\
\cf3 \strokec3 		\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(4),4)\
\cf3 \strokec3 		\cf4 \strokec4 cmd=\cf7 \strokec7 "ScanFinish()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 GraphTStability\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ScanRef()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 To\cf3 \strokec3  \cf2 \strokec2 estimate\cf3 \strokec3  \cf2 \strokec2 Voc\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_complianceI,V_DataChannel0,V_DataChannel2,V_area,V_numpnts\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b\
\cf3 \strokec3 	\cf4 \strokec4 b=\cf6 \strokec6 floor\cf4 \strokec4 (\cf6 \strokec6 log\cf4 \strokec4 (\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (0.04*V_area/V_complianceI)*V_complianceI)));\cf3 \strokec3  \cf4 \strokec4 a=\cf6 \strokec6 ceil\cf4 \strokec4 (\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (0.04*V_area/V_complianceI)*V_complianceI)*10^-b)*10^b\cf3 \strokec3 		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 max\cf3 \strokec3  \cf2 \strokec2 Compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a)\cf3 \strokec3 	\cf4 \strokec4 )\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 (Area\cf3 \strokec3  \cf2 \strokec2 x\cf3 \strokec3  \cf2 \strokec2 40)\cf3 \strokec3  \cf2 \strokec2 mA\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:AUTO\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_DataChannel0=ReadData(1)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Read\cf3 \strokec3  \cf2 \strokec2 Current\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 SelectCell("Cell",1,"Ref\cf3 \strokec3  \cf2 \strokec2 Cell")\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 Ref.\cf3 \strokec3  \cf2 \strokec2 Cell\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:FRSW\cf3 \strokec3  \cf7 \strokec7 REAR"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 rear,\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 switches\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 OFF\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 2\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 )\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 0.01"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 10\cf3 \strokec3  \cf2 \strokec2 mA\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Ref\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_numpnts=128;\cf3 \strokec3  \cf4 \strokec4 a=V_area;\cf3 \strokec3  \cf4 \strokec4 V_area=0.5\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 So\cf3 \strokec3  \cf2 \strokec2 switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf3 \strokec3  \cf2 \strokec2 again\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_DataChannel2=ReadDataWave(0.5,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Sense\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf2 \strokec2 on\cf3 \strokec3  \cf2 \strokec2 0.5\cf3 \strokec3  \cf2 \strokec2 cm^2\cf3 \strokec3  \cf2 \strokec2 Si\cf3 \strokec3  \cf2 \strokec2 Ref\cf3 \strokec3  \cf2 \strokec2 diode\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:FRSW\cf3 \strokec3  \cf7 \strokec7 FRON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 front\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 SelectCell("Cell",2,"Test\cf3 \strokec3  \cf2 \strokec2 Cell")\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 Test\cf3 \strokec3  \cf2 \strokec2 Cell\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 V_area=a;\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 2\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ScanDirection(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_scanDir\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_userName\
\cf3 \strokec3 	\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (popNum)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\
\cf3 \strokec3 			\cf4 \strokec4 V_scanDir=1;\cf3 \strokec3  \cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 iv_start,win=ConfigPanel,title=\cf7 \strokec7 "<-"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\
\cf3 \strokec3 			\cf4 \strokec4 V_scanDir=-1;\cf3 \strokec3  \cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 iv_start,win=ConfigPanel,title=\cf7 \strokec7 "->"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 VocMode(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 Voc\cf3 \strokec3  \cf2 \strokec2 drift\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_vocDrift\
\cf3 \strokec3 	\cf4 \strokec4 V_vocDrift=popNum-1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ScanTest(flg)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 To\cf3 \strokec3  \cf2 \strokec2 estimate\cf3 \strokec3  \cf2 \strokec2 Voc,\cf3 \strokec3  \cf2 \strokec2 no\cf3 \strokec3  \cf2 \strokec2 AUTO\cf3 \strokec3  \cf2 \strokec2 scaling\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 flg\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,Voltage\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_complianceI,V_defaultVoc,V_numCell,V_settlingtime,V_4WThreshold,V_startVolt,V_endVolt,V_incrVolt,V_scanDir,V_numpnts,V_VocDrift,V_v0,V_v1\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,bias=0,c=0.048*V_area,t,v1,v2\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 'VOLT:DC'"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Define\cf3 \strokec3  \cf2 \strokec2 sense\cf3 \strokec3  \cf2 \strokec2 function\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 get\cf3 \strokec3  \cf2 \strokec2 Voc\cf3 \strokec3  \cf2 \strokec2 estimate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:VOLT:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numCell*V_defaultVoc+0.6))\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:FUNC:MODE\cf3 \strokec3  \cf7 \strokec7 CURR"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_settlingtime<0)\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:CURR:MODE\cf3 \strokec3  \cf7 \strokec7 FIX;:SOUR:DEL:AUTO\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Auto\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:CURR:MODE\cf3 \strokec3  \cf7 \strokec7 FIX;:SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (4*V_settlingtime))\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fixed\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (bias))\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Estimate\cf3 \strokec3  \cf2 \strokec2 Voc\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 v1=ReadData(0)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Read\cf3 \strokec3  \cf2 \strokec2 Voltage\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Vocdrift&flg)\
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 Graph0\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_flag)\
\cf3 \strokec3 			\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "Graph0()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=0/R=ConfigPanel\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 		\cf2 \strokec2 t=StartMSTimer\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 		\cf4 \strokec4 a=VocDrift(v1);\cf3 \strokec3  \cf4 \strokec4 v2=a\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 		\cf2 \strokec2 print\cf3 \strokec3  \cf2 \strokec2 StopMSTimer(t)/1e6\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_settlingtime))\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 SettlingTime\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:CURR:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_complianceI))\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Estimate\cf3 \strokec3  \cf2 \strokec2 slope/series\cf3 \strokec3  \cf2 \strokec2 resistance\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 v2=ReadData(0)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Read\cf3 \strokec3  \cf2 \strokec2 Voltage\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 'CURR:DC'"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 default\cf3 \strokec3  \cf2 \strokec2 SENS\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:FUNC:MODE\cf3 \strokec3  \cf7 \strokec7 VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:AUTO\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Disable\cf3 \strokec3  \cf2 \strokec2 Autoranging\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 b=\cf6 \strokec6 floor\cf4 \strokec4 (\cf6 \strokec6 log\cf4 \strokec4 (\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (0.04*V_area))));\cf3 \strokec3  \cf4 \strokec4 a=\cf6 \strokec6 ceil\cf4 \strokec4 (\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (0.04*V_area))*10^-b)*10^b\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 max\cf3 \strokec3  \cf2 \strokec2 Compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((-V_area*0.025)<V_4WThreshold)\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 0.05A\cf3 \strokec3  \cf2 \strokec2 threshold\cf3 \strokec3  \cf2 \strokec2 limit\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 default\cf3 \strokec3  \cf2 \strokec2 area,\cf3 \strokec3  \cf2 \strokec2 25mA/cm^2\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 1,\cf7 \strokec7 "High\cf3 \strokec3  \cf7 \strokec7 Current\cf3 \strokec3  \cf7 \strokec7 Device.\cf3 \strokec3  \cf7 \strokec7 Have\cf3 \strokec3  \cf7 \strokec7 you\cf3 \strokec3  \cf7 \strokec7 configured\cf3 \strokec3  \cf7 \strokec7 Sourcemeter\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 4-wire\cf3 \strokec3  \cf7 \strokec7 Sense.\cf3 \strokec3   \cf7 \strokec7 \\rAttention,\cf3 \strokec3  \cf7 \strokec7 potentially\cf3 \strokec3  \cf7 \strokec7 lethal\cf3 \strokec3  \cf7 \strokec7 currents!!!"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag>1)\
\cf3 \strokec3 			\cf8 \strokec8 abort\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:RSEN\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a))\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 \'8326mA/cm2\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 max\cf4 \strokec4 (\cf6 \strokec6 ceil\cf4 \strokec4 (c/V_complianceI)*V_complianceI,V_complianceI))\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Limit\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 values\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:UPP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a));\cf3 \strokec3  \cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a))\cf3 \strokec3 													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 expected\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 range\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_numpnts=\cf6 \strokec6 ceil\cf4 \strokec4 ((v2-V_endVolt)/V_incrVolt)+1;\cf3 \strokec3  \cf4 \strokec4 V_startVolt=V_incrVolt*(V_numpnts-1)+V_endVolt\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_endVolt>V_startVolt)\
\cf3 \strokec3 		\cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf7 \strokec7 "Device\cf3 \strokec3  \cf7 \strokec7 has\cf3 \strokec3  \cf7 \strokec7 serious\cf3 \strokec3  \cf7 \strokec7 problem.\cf3 \strokec3  \cf7 \strokec7 Ensure\cf3 \strokec3  \cf7 \strokec7 that\cf3 \strokec3  \cf7 \strokec7 the\cf3 \strokec3  \cf7 \strokec7 Upper\cf3 \strokec3  \cf7 \strokec7 Voltage\cf3 \strokec3  \cf7 \strokec7 limit("\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_startVolt)+\cf7 \strokec7 "V)\cf3 \strokec3  \cf7 \strokec7 is\cf3 \strokec3  \cf7 \strokec7 >\cf3 \strokec3  \cf7 \strokec7 than\cf3 \strokec3  \cf7 \strokec7 Lower\cf3 \strokec3  \cf7 \strokec7 limit("\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_endVolt)+\cf7 \strokec7 "V)"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 abort\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_v0=V_startVolt;\cf3 \strokec3  \cf4 \strokec4 V_v1=V_endVolt\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_scanDir==-1)\
\cf3 \strokec3 		\cf4 \strokec4 V_v0=V_endVolt;\cf3 \strokec3  \cf4 \strokec4 V_v1=V_startVolt\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 Voltage,PhotoCurrent;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf4 \strokec4 /I\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 V_v0,V_v1,\cf7 \strokec7 "V"\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON,\cf3 \strokec3  \cf2 \strokec2 yet\cf3 \strokec3  \cf2 \strokec2 again\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 VocDrift(V)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 To\cf3 \strokec3  \cf2 \strokec2 watch\cf3 \strokec3  \cf2 \strokec2 Voc\cf3 \strokec3  \cf2 \strokec2 drift\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 V\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Input3\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Input3\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 V\cf3 \strokec3  \cf2 \strokec2 vs\cf3 \strokec3  \cf2 \strokec2 s\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_delay,V_settlingtime,V_Vocdrift\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_warning\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,c=\cf6 \strokec6 min\cf4 \strokec4 (1,0.048*V_area),d1,d2,v2,n=1,npnts=2000,flg1,flg2\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 250\cf3 \strokec3  \cf2 \strokec2 points\cf3 \strokec3  \cf2 \strokec2 gives\cf3 \strokec3  \cf2 \strokec2 about\cf3 \strokec3  \cf2 \strokec2 60s\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(npnts)\cf3 \strokec3  \cf4 \strokec4 input3;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 0,0.1137,\cf7 \strokec7 "s"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 Input3;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 Input3;\cf3 \strokec3  \cf4 \strokec4 input3=\cf6 \strokec6 NaN\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 Input3[0]=V\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 0.04"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fixed\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 v2=ReadData(0);\cf3 \strokec3  \cf4 \strokec4 input3[n]=v2\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Read\cf3 \strokec3  \cf2 \strokec2 Voltage,\cf3 \strokec3  \cf2 \strokec2 Source\cf3 \strokec3  \cf2 \strokec2 0\cf3 \strokec3  \cf2 \strokec2 current\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=[n-16,n]\cf3 \strokec3  \cf4 \strokec4 input3;\cf3 \strokec3  \cf4 \strokec4 d2=V_avg\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Try\cf3 \strokec3  \cf2 \strokec2 different\cf3 \strokec3  \cf2 \strokec2 statistics:\cf3 \strokec3  \cf2 \strokec2 V_avg\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((flg1)&(n>8)&(\cf6 \strokec6 abs\cf4 \strokec4 (d2-d1)>5e-5))\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 flg\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 steep\cf3 \strokec3  \cf2 \strokec2 slope\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 flg1=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flg1)\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((n>8)&((d2-d1)>5e-5))\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 flg\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 +ve\cf3 \strokec3  \cf2 \strokec2 slope\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 flg2=1\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((V_Vocdrift==2)&flg2&(\cf6 \strokec6 abs\cf4 \strokec4 (d2-d1)<2e-5))\
\cf3 \strokec3 				\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Large\cf3 \strokec3  \cf7 \strokec7 +ve\cf3 \strokec3  \cf7 \strokec7 slpoe"\cf4 \strokec4 ,n,\cf7 \strokec7 "Voltage:"\cf4 \strokec4 ,V_avg,\cf7 \strokec7 "Delta:"\cf4 \strokec4 ,d2-d1,flg1,flg2\
\cf3 \strokec3 				\cf4 \strokec4 S_warning=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((n>8)&(\cf6 \strokec6 abs\cf4 \strokec4 (d2-d1)<5e-6))\
\cf3 \strokec3 				\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Small\cf3 \strokec3  \cf7 \strokec7 slope"\cf4 \strokec4 ,n,\cf7 \strokec7 "Voltage:"\cf4 \strokec4 ,V_avg,\cf7 \strokec7 "Delta:"\cf4 \strokec4 ,d2-d1,flg1,flg2\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (n>npnts-1)\
\cf3 \strokec3 			\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Max\cf3 \strokec3  \cf7 \strokec7 limit:"\cf4 \strokec4 ,n,d2-d1,V_avg,flg1\
\cf3 \strokec3 			\cf4 \strokec4 S_warning=\cf7 \strokec7 "Voc\cf3 \strokec3  \cf7 \strokec7 drift\cf3 \strokec3  \cf7 \strokec7 limit"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 d1=d2\
\cf3 \strokec3 	\cf9 \strokec9 while\cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 Input3;\cf3 \strokec3  \cf8 \strokec8 Cursor\cf4 \strokec4 /W=Graph0\cf3 \strokec3  \cf4 \strokec4 A\cf3 \strokec3  \cf4 \strokec4 Input3\cf3 \strokec3  \cf4 \strokec4 V_maxLoc\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 v2\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ScanSettings()\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 user\cf3 \strokec3  \cf2 \strokec2 supplied\cf3 \strokec3  \cf2 \strokec2 scan\cf3 \strokec3  \cf2 \strokec2 limits\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,Voltage\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_DataChannel0,V_startVolt,V_endVolt,V_v0,V_v1,V_incrVolt,V_numpnts,V_complianceI,V_scanDir\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 max\cf4 \strokec4 (\cf6 \strokec6 ceil\cf4 \strokec4 (-1.2*V_DataChannel0/V_complianceI)*V_complianceI,0.1)\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 default\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 100mA\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a));\cf3 \strokec3  \cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:UPP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a))\cf3 \strokec3 													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 expected\cf3 \strokec3  \cf2 \strokec2 current\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:AUTO\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 V_v0=V_startVolt;\cf3 \strokec3  \cf4 \strokec4 V_v1=V_endVolt;\cf3 \strokec3  \cf4 \strokec4 V_numpnts=\cf6 \strokec6 ceil\cf4 \strokec4 ((V_v0-V_v1)/V_incrVolt)+1\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_scanDir==-1)\
\cf3 \strokec3 		\cf4 \strokec4 V_v0=V_endVolt;\cf3 \strokec3  \cf4 \strokec4 V_v1=V_startVolt\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 Voltage,PhotoCurrent;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf4 \strokec4 /I\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 V_v0,V_v1,\cf7 \strokec7 "V"\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON,\cf3 \strokec3  \cf2 \strokec2 yet\cf3 \strokec3  \cf2 \strokec2 again\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ScanVoltage()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 DataWave,PhotoCurrent,Voltage\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 sourcemeter,V_v0,V_v1,V_numpnts,V_settlingtime\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,n\
\cf3 \strokec3 	\cf4 \strokec4 a=(V_v1-V_v0)/(V_numpnts-1)\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Calculte\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 Voltage\cf3 \strokec3  \cf2 \strokec2 Increment\cf3 \strokec3  \cf2 \strokec2 &\cf3 \strokec3  \cf2 \strokec2 sign\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(2*V_numpnts)\cf3 \strokec3  \cf4 \strokec4 DataWave\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":STAT:MEAS:ENAB\cf3 \strokec3  \cf7 \strokec7 512"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 SRQ\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":*SRE\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_settlingtime))\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:MODE\cf3 \strokec3  \cf7 \strokec7 SWE"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Sweep\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:START\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_v0)+\cf7 \strokec7 ";\cf3 \strokec3  \cf7 \strokec7 STOP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_v1)+\cf7 \strokec7 ";\cf3 \strokec3  \cf7 \strokec7 STEP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a))\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:CLE"\cf4 \strokec4 )\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Clear\cf3 \strokec3  \cf2 \strokec2 Buffer\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:POIN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numpnts)+\cf7 \strokec7 ";:TRIG:COUN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numpnts))\cf3 \strokec3 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 Triggers\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:FEED:CONT\cf3 \strokec3  \cf7 \strokec7 NEXT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":INIT"\cf4 \strokec4 )\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 time\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 zero\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\}\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag>32)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 ((status%&32)==32)\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":TRAC:DATA?"\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 consider\cf3 \strokec3  \cf2 \strokec2 GPIBWrite2\cf3 \strokec3  \cf2 \strokec2 ":READ?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinaryWave2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 DataWave;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf4 \strokec4 Voltage=Datawave[2*p];\cf3 \strokec3  \cf4 \strokec4 Photocurrent=Datawave[2*p+1]\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ScanPulsed(sense,source)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 sense,source\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 DataWave,Voltage,PhotoCurrent\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 sourcemeter,V_i0,V_i1,V_v0,V_v1,V_dutyCycle,V_integTime,V_incrCurrent,V_incrVolt,V_numpnts\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_windowname\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,bias,m,n,npnts,pulseWidth,start,finish,step\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 CmpStr\cf4 \strokec4 (sense,\cf7 \strokec7 "CURR"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf4 \strokec4 start=V_v0;\cf3 \strokec3  \cf4 \strokec4 finish=V_v1;\cf3 \strokec3  \cf4 \strokec4 step=V_incrVolt\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 start=V_i0;\cf3 \strokec3  \cf4 \strokec4 finish=V_i1;\cf3 \strokec3  \cf4 \strokec4 step=V_incrCurrent\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 npnts=\cf6 \strokec6 abs\cf4 \strokec4 (\cf6 \strokec6 round\cf4 \strokec4 ((finish-start)/step))+1;\cf3 \strokec3  \cf4 \strokec4 bias=\cf6 \strokec6 round\cf4 \strokec4 (start/step)*step\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Calculate\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 Voltage\cf3 \strokec3  \cf2 \strokec2 Increment\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 b=\cf6 \strokec6 min\cf4 \strokec4 (start,finish);\cf3 \strokec3  \cf4 \strokec4 step*=\cf6 \strokec6 sign\cf4 \strokec4 (finish-start)\
\cf3 \strokec3 	\cf4 \strokec4 pulseWidth=40*V_dutyCycle/100\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(10+npnts*40)\cf3 \strokec3  \cf4 \strokec4 Voltage,Photocurrent\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Uploading\cf3 \strokec3  \cf7 \strokec7 Waveform"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibtmo=\{sourcemeter,15\}\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":STAT:MEAS:ENAB\cf3 \strokec3  \cf7 \strokec7 512"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 SRQ\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":*SRE\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:ELEM\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +sense+\cf7 \strokec7 ","\cf4 \strokec4 +source)\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 format\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 '"\cf4 \strokec4 +sense+\cf7 \strokec7 ":DC'"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Define\cf3 \strokec3  \cf2 \strokec2 sense\cf3 \strokec3  \cf2 \strokec2 function\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:"\cf4 \strokec4 +source+\cf7 \strokec7 ":MODE\cf3 \strokec3  \cf7 \strokec7 LIST"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Custom\cf3 \strokec3  \cf2 \strokec2 Sweep\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:LIST:"\cf4 \strokec4 +source+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +wave2str(10,b))\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Build\cf3 \strokec3  \cf2 \strokec2 waveform\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 m=10\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:LIST:"\cf4 \strokec4 +source+\cf7 \strokec7 ":APP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +wave2str(pulseWidth,bias))\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:LIST:"\cf4 \strokec4 +source+\cf7 \strokec7 ":APP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +wave2str(40-pulseWidth,b))\
\cf3 \strokec3 		\cf4 \strokec4 bias+=step\
\cf3 \strokec3 		\cf4 \strokec4 m+=40\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<npnts+1)\
\cf3 \strokec3 	\cf4 \strokec4 V_numpnts=n-1\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(2*m)\cf3 \strokec3  \cf4 \strokec4 DataWave\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:"\cf4 \strokec4 +sense+\cf7 \strokec7 ":NPLC\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_integTime))\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Integration\cf3 \strokec3  \cf2 \strokec2 Time\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRIG:DEL\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:AZER:STAT\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Auto\cf3 \strokec3  \cf2 \strokec2 zero\cf3 \strokec3  \cf2 \strokec2 OFF\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:CLE"\cf4 \strokec4 )\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Clear\cf3 \strokec3  \cf2 \strokec2 Buffer\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":DISP:ENAB\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:TIME:RES"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 time\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 zero\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:POIN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (m)+\cf7 \strokec7 ";:TRIG:COUN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (m))\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 Triggers\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Test\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:FEED:CONT\cf3 \strokec3  \cf7 \strokec7 NEXT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":INIT"\cf4 \strokec4 )\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 time\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 zero\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\}\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag>32)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 ((status%&32)==32)\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":TRAC:DATA?"\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 consider\cf3 \strokec3  \cf2 \strokec2 GPIBWrite2\cf3 \strokec3  \cf2 \strokec2 ":READ?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinaryWave2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 DataWave;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf4 \strokec4 Voltage=Datawave[2*p];\cf3 \strokec3  \cf4 \strokec4 Photocurrent=Datawave[2*p+1]\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":DISP:ENAB\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 ProcessData()\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ProcessData()\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 For\cf3 \strokec3  \cf2 \strokec2 datawaves\cf3 \strokec3  \cf2 \strokec2 scaled\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 points\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Voltage,PhotoCurrent,PhotoCurrent0,input0,W_FindLevels\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3   \cf4 \strokec4 V_v0,V_v1,V_incrVolt,V_numpnts,V_dutyCycle\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b=\cf6 \strokec6 min\cf4 \strokec4 (V_v0,V_v1),c\
\cf3 \strokec3 	\cf8 \strokec8 FindLevels\cf4 \strokec4 /Q/B=3\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,5e-5\
\cf3 \strokec3 	\cf8 \strokec8 FindLevels\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 Voltage,\cf6 \strokec6 abs\cf4 \strokec4 (b+V_incrVolt/2)\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 p0=(\cf6 \strokec6 mod\cf4 \strokec4 (V_levelsFound,2)>0),p1=V_levelsFound\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=((p1-p0)/2)\cf3 \strokec3  \cf4 \strokec4 Input0\
\cf3 \strokec3 	\cf4 \strokec4 Input0=W_FindLevels[2*p+1]-W_FindLevels[2*p]\
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 Input0;\cf3 \strokec3  \cf4 \strokec4 c=100*V_avg/V_dutyCycle\
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 round\cf4 \strokec4 ((\cf6 \strokec6 pnt2x\cf4 \strokec4 (Voltage,\cf6 \strokec6 numpnts\cf4 \strokec4 (Voltage)-1)-\cf6 \strokec6 pnt2x\cf4 \strokec4 (Voltage,0))/c)\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(2*a)\cf3 \strokec3  \cf4 \strokec4 W_FindLevels\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_v0<V_v1)\
\cf3 \strokec3 		\cf8 \strokec8 Rotate\cf3 \strokec3  \cf4 \strokec4 2,W_FindLevels\
\cf3 \strokec3 		\cf4 \strokec4 W_FindLevels[0]=W_FindLevels[2]-c;\cf3 \strokec3  \cf4 \strokec4 W_FindLevels[1]=W_FindLevels[2]-(c-V_avg)\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 W_FindLevels[2*a-2]=W_FindLevels[2*a-3]+Input0[a-1];\cf3 \strokec3  \cf4 \strokec4 W_FindLevels[2*a-1]=W_FindLevels[2*a-3]+2*Input0[a-1]\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 PhotoCurrent0=\cf6 \strokec6 mean\cf4 \strokec4 (PhotoCurrent,\cf6 \strokec6 pnt2x\cf4 \strokec4 (PhotoCurrent,\cf6 \strokec6 x2pnt\cf4 \strokec4 (Voltage,W_FindLevels[2*p])+1),\cf6 \strokec6 pnt2x\cf4 \strokec4 (PhotoCurrent,\cf6 \strokec6 x2pnt\cf4 \strokec4 (Voltage,W_FindLevels[2*p+1])-1))\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /I\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 V_v0,V_v1,\cf7 \strokec7 "V"\cf4 \strokec4 ,PhotoCurrent0\
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent0,PhotoCurrent\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ScanFinish()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Close\cf3 \strokec3  \cf2 \strokec2 Shutter\cf3 \strokec3  \cf2 \strokec2 #1\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 Shutter("",1,"Close")\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 FlushKeithley()\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 FlushKeithley()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_biasVoltage\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 OFF\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":*CLS"\cf4 \strokec4 )\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":*SRE\cf3 \strokec3  \cf7 \strokec7 48"\cf4 \strokec4 )\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:ELEM\cf3 \strokec3  \cf7 \strokec7 VOLT,CURR"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //Output\cf3 \strokec3  \cf2 \strokec2 type\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":STAT:MEAS:ENAB\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:VOLT:NPLC\cf3 \strokec3  \cf7 \strokec7 1.0;:SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 'CURR:DC'"\cf4 \strokec4 )\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Default\cf3 \strokec3  \cf2 \strokec2 Integration\cf3 \strokec3  \cf2 \strokec2 Time\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Standby"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:FUNC:MODE\cf3 \strokec3  \cf7 \strokec7 VOLT;:SOUR:VOLT:MODE\cf3 \strokec3  \cf7 \strokec7 FIX;:SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 V_biasVoltage=0\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRIG:COUN\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 		\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Sun(ctrlName,level)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 level\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVParams,PhotoCurrent,PSUSettings\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_length,V_dataChannel0,V_dataChannel2,V_refCalibration,V_supos,V_numpnts\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_complianceI,V_delay,V_pulsedMode,V_settlingtime,V_incrVolt,V_Lamp,V_v0,V_voltFlag,V_Henry\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,d_t,S_exptType,option3,option5,S_warning,S_windowname\
\cf3 \strokec3 	\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,win=configPanel,value=1;\cf3 \strokec3  \cf4 \strokec4 tabPanels(\cf7 \strokec7 "tab0"\cf4 \strokec4 ,1)\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Lamp)\
\cf3 \strokec3 		\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUsettings[level],4)\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 xx%\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 8\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Need\cf3 \strokec3  \cf2 \strokec2 if\cf3 \strokec3  \cf2 \strokec2 measuring\cf3 \strokec3  \cf2 \strokec2 only\cf3 \strokec3  \cf2 \strokec2 1\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 LampControl(\cf7 \strokec7 "Diode"\cf4 \strokec4 ,PSUsettings[level],4)\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 xx%\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str,wname;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=12*level\
\cf3 \strokec3 	\cf4 \strokec4 S_warning=\cf7 \strokec7 ""\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_exptType=\cf7 \strokec7 ".sIV"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 V_supos=0\
\cf3 \strokec3 	\cf4 \strokec4 wname=\cf6 \strokec6 SelectString\cf4 \strokec4 ((level<10),\cf7 \strokec7 "DarkCurrent"\cf4 \strokec4 ,\cf7 \strokec7 "PhotoCurrent"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (level))\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 NI4882\cf3 \strokec3  \cf2 \strokec2 iblock=\{gpib_bus\}\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (level<7)\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Block\cf3 \strokec3  \cf2 \strokec2 if\cf3 \strokec3  \cf2 \strokec2 Dark\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Reference\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 		\cf4 \strokec4 ScanRef()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 Reference\cf3 \strokec3  \cf2 \strokec2 light\cf3 \strokec3  \cf2 \strokec2 Intensity\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 IVParams[a+11][V_supos]=V_DataChannel0;\cf3 \strokec3  \cf4 \strokec4 IVParams[a][V_supos]=V_DataChannel2\
\cf3 \strokec3 	\cf4 \strokec4 IVparams[a+1][V_supos]=\cf6 \strokec6 abs\cf4 \strokec4 (V_DataChannel2*V_RefCalibration)\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf4 \strokec4 allwaves=wname+\cf7 \strokec7 ","\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "IVGraph()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "AcquireStyle1()"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 DisplayAddons()\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 allwaves=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "*Current*"\cf4 \strokec4 ,\cf7 \strokec7 ","\cf4 \strokec4 ,\cf7 \strokec7 "win:IVGraph"\cf4 \strokec4 ),\cf7 \strokec7 ","\cf4 \strokec4 ,16)\
\cf3 \strokec3 		\cf8 \strokec8 CheckDisplayed\cf4 \strokec4 /W=IVGraph\cf3 \strokec3  \cf4 \strokec4 $wname\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 if\cf3 \strokec3  \cf2 \strokec2 wave\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 already\cf3 \strokec3  \cf2 \strokec2 displayed\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 			\cf8 \strokec8 AppendtoGraph\cf3 \strokec3  \cf4 \strokec4 $wname;\cf3 \strokec3  \cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle($wname)=level\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 cmpstr\cf4 \strokec4 (\cf7 \strokec7 "DarkCurrent"\cf4 \strokec4 ,wname)==0)\
\cf3 \strokec3 				\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle(darkcurrent)=0,rgb(darkcurrent)=(0,65535,0)\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=textL/J/F=0/A=MC/X=60/Y=0\cf3 \strokec3  \cf4 \strokec4 Legendtext(allwaves+wname,1)\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "IVGraph"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_voltFlag)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Flag\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 manual\cf3 \strokec3  \cf2 \strokec2 setting\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 Voltage\cf3 \strokec3  \cf2 \strokec2 sweep\cf3 \strokec3  \cf2 \strokec2 limits\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 ScanSettings()\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Testing\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 Voc"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 ScanTest(level<7)\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +ctrlName;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_v0))\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 potential\cf3 \strokec3  \cf2 \strokec2 on\cf3 \strokec3  \cf2 \strokec2 cell\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 Start\cf3 \strokec3  \cf2 \strokec2 Voltage\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 V_delay\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_pulsedMode)\
\cf3 \strokec3 			\cf4 \strokec4 V_incrVolt=0.02;\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_incr,mode=4;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 ScanPulsed(\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 ScanVoltage()\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Selected\cf3 \strokec3  \cf2 \strokec2 gain\cf3 \strokec3  \cf2 \strokec2 depends\cf3 \strokec3  \cf2 \strokec2 on\cf3 \strokec3  \cf2 \strokec2 light\cf3 \strokec3  \cf2 \strokec2 intensity\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,$wname\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (level<10)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Block\cf3 \strokec3  \cf2 \strokec2 if\cf3 \strokec3  \cf2 \strokec2 Dark\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 IV_Params(wname,0)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 V_supos\cf3 \strokec3  \cf2 \strokec2 not\cf3 \strokec3  \cf2 \strokec2 yet\cf3 \strokec3  \cf2 \strokec2 incremented\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "IT:%g;AR:%g;FT:%g;CM:%g;ST:%g;SV:%g;ET:%g"\cf4 \strokec4 ,IVparams[a+1][V_supos],V_area,V_length,V_complianceI,V_settlingTime,V_v0,V_delay\
\cf3 \strokec3 		\cf8 \strokec8 Note\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 $wname,str\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (KillJoy())\
\cf3 \strokec3 			\cf4 \strokec4 ScanFinish()\
\cf3 \strokec3 			\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Abort\cf3 \strokec3  \cf7 \strokec7 "You\cf3 \strokec3  \cf7 \strokec7 have\cf3 \strokec3  \cf7 \strokec7 killed\cf3 \strokec3  \cf7 \strokec7 the\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Routine"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 abs\cf4 \strokec4 (IVparams[a+4][V_supos])<V_complianceI/1000)\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Jsc\cf3 \strokec3  \cf2 \strokec2 <\cf3 \strokec3  \cf2 \strokec2 32\cf3 \strokec3  \cf2 \strokec2 mA/cm2\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 S_warning=\cf7 \strokec7 "\\f01<Bad\cf3 \strokec3  \cf7 \strokec7 Cell>\\f00"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((IVparams[a+4][V_supos]>(0.9*IVparams[a+7][V_supos]))&!V_Henry)\cf3 \strokec3 																	\cf2 \strokec2 //abs(IVParams[a+10][V_supos])>0.85)\cf3 \strokec3 	\cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 high\cf3 \strokec3  \cf2 \strokec2 Fill\cf3 \strokec3  \cf2 \strokec2 Factor\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ControlInfo\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 iv_gain1\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Value==12)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 If\cf3 \strokec3  \cf2 \strokec2 Settling\cf3 \strokec3  \cf2 \strokec2 Time\cf3 \strokec3  \cf2 \strokec2 becomes\cf3 \strokec3  \cf2 \strokec2 large,\cf3 \strokec3  \cf2 \strokec2 abort\cf3 \strokec3  \cf2 \strokec2 experiment\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Abort\cf3 \strokec3  \cf7 \strokec7 "Have\cf3 \strokec3  \cf7 \strokec7 killed\cf3 \strokec3  \cf7 \strokec7 the\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Routine\cf3 \strokec3  \cf7 \strokec7 due\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 cell\cf3 \strokec3  \cf7 \strokec7 failure"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_gain1\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=V_Value+1\
\cf3 \strokec3 			\cf8 \strokec8 ControlInfo\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 iv_gain1\
\cf3 \strokec3 			\cf4 \strokec4 SetDelay(\cf7 \strokec7 "SettlingTime"\cf4 \strokec4 ,V_Value,S_Value);\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 iv_gain1\
\cf3 \strokec3 			\cf4 \strokec4 Command(\cf7 \strokec7 ":*CLS"\cf4 \strokec4 )\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_settlingtime))\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Exit\cf3 \strokec3  \cf2 \strokec2 loop\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf4 \strokec4 ScanFinish()\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 NI4882\cf3 \strokec3  \cf2 \strokec2 ibunlock=\{gpib_bus\}\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=(0,0.1)\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent;\cf3 \strokec3  \cf4 \strokec4 IVparams[a+2][V_supos]=\cf6 \strokec6 abs\cf4 \strokec4 (100*V_sdev/V_avg)\cf3 \strokec3 														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Estimate\cf3 \strokec3  \cf2 \strokec2 noise\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 measuremnt\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (((\cf6 \strokec6 abs\cf4 \strokec4 (V_max-V_min)/V_area)>1e3)&(level==7))\
\cf3 \strokec3 		\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 1,\cf7 \strokec7 "Large\cf3 \strokec3  \cf7 \strokec7 shunt\cf3 \strokec3  \cf7 \strokec7 or\cf3 \strokec3  \cf7 \strokec7 Device\cf3 \strokec3  \cf7 \strokec7 is\cf3 \strokec3  \cf7 \strokec7 Ohmic.\cf3 \strokec3   \cf7 \strokec7 \\rCheck\cf3 \strokec3  \cf7 \strokec7 cables\cf3 \strokec3  \cf7 \strokec7 or\cf3 \strokec3  \cf7 \strokec7 Bad\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 $wname;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,V_complianceI*V_area,\cf6 \strokec6 floor\cf4 \strokec4 (V_min*5e3)/5e3\
\cf3 \strokec3 	\cf4 \strokec4 d_t=\cf6 \strokec6 date\cf4 \strokec4 ()+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 /\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 time\cf4 \strokec4 ()\
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 All\cf3 \strokec3  \cf7 \strokec7 Data"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 CellTest(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Complete\cf3 \strokec3  \cf2 \strokec2 Diagnostic\cf3 \strokec3  \cf2 \strokec2 package\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PSUSettings\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_Henry\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,option3,option5\
\cf3 \strokec3 	\cf4 \strokec4 allwaves=\cf7 \strokec7 ""\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Define\cf3 \strokec3  \cf2 \strokec2 area\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Uoc\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,win=configPanel,value=1;\cf3 \strokec3  \cf4 \strokec4 tabPanels(\cf7 \strokec7 "tab0"\cf4 \strokec4 ,1);\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /A\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=\cf6 \strokec6 StartMSTimer\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_Henry=1;\cf3 \strokec3  \cf4 \strokec4 Sun(\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,10);\cf3 \strokec3  \cf4 \strokec4 V_Henry=0\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Dark\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf2 \strokec2 Scan\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 strswitch\cf3 \strokec3  \cf4 \strokec4 (ctrlName)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Robin"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,5);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/100\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/2\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 MeasureIPCE(\cf7 \strokec7 "550"\cf4 \strokec4 ,8)\
\cf3 \strokec3 			\cf4 \strokec4 DynamicsWrapper(\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Francine"\cf4 \strokec4 :\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Aswani"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/2\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 DynamicsWrapper(\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 break\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Perovskite"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_gain1,win=ConfigPanel,mode=4\cf3 \strokec3   																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 40ms\cf3 \strokec3  \cf2 \strokec2 Settling\cf3 \strokec3  \cf2 \strokec2 Time\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 PPTStability(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0)\
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 Sun\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 			\cf2 \strokec2 DynamicsWrapper("CURR",\cf3 \strokec3  \cf2 \strokec2 "VOLT")\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 			\cf4 \strokec4 option5=\cf7 \strokec7 "Layout_Perovskite"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 ;\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "DSC"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_gain1,win=ConfigPanel,mode=4\cf3 \strokec3  																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 40ms\cf3 \strokec3  \cf2 \strokec2 Settling\cf3 \strokec3  \cf2 \strokec2 Time\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 PPTStability(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0)\
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,5);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/100\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/2\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 DynamicsWrapper(\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "ssDSC"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_gain1,win=ConfigPanel,mode=6\cf3 \strokec3   																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 80ms\cf3 \strokec3  \cf2 \strokec2 Settling\cf3 \strokec3  \cf2 \strokec2 Time\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 PPTStability(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0)\
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/2\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 DynamicsWrapper(\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 break\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Andreas"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/2\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 DynamicsWrapper(\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 default\cf4 \strokec4 :\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,5);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/100\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/10\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/2\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 1/1\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 DynamicsWrapper(\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Return\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 default\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 MultiCellTest(flg)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Complete\cf3 \strokec3  \cf2 \strokec2 Diagnostic\cf3 \strokec3  \cf2 \strokec2 package\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 flg\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 RefDiodes,PSUSettings\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_delay,V_IPCE550,V_refNum,V_numDev,V_RefCalibration,V_run,V_Henry\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,S_Filename,S_number,S_username,option3,option5\
\cf3 \strokec3 	\cf8 \strokec8 DoUpdate\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Define\cf3 \strokec3  \cf2 \strokec2 area\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Uoc\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b=\cf6 \strokec6 StartMSTimer\cf4 \strokec4 ,n;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 s\
\cf3 \strokec3 	\cf4 \strokec4 V_refNum=10;\cf3 \strokec3  \cf4 \strokec4 V_RefCalibration=0.1/RefDiodes[V_refNum][6]\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 ArduinoDigital(7,n-1)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 Cell#\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 cell0,win=configpanel,mode=2+n;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 cell0\
\cf3 \strokec3 		\cf4 \strokec4 V_Henry=1;\cf3 \strokec3  \cf4 \strokec4 Sun(\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,13);\cf3 \strokec3  \cf4 \strokec4 V_Henry=0\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Dark\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf2 \strokec2 Scan\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flg)\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 flg:\cf3 \strokec3  \cf2 \strokec2 0\cf3 \strokec3  \cf2 \strokec2 -\cf3 \strokec3  \cf2 \strokec2 Conductivity,\cf3 \strokec3  \cf2 \strokec2 1\cf3 \strokec3  \cf2 \strokec2 -\cf3 \strokec3  \cf2 \strokec2 Full\cf3 \strokec3  \cf2 \strokec2 test\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,5)\
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,4)\
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,2)\
\cf3 \strokec3 			\cf4 \strokec4 Sun(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,0)\
\cf3 \strokec3 			\cf4 \strokec4 MeasureIPCE(\cf7 \strokec7 "550"\cf4 \strokec4 ,7);\cf3 \strokec3  \cf4 \strokec4 V_IPCE550/=2.39035\
\cf3 \strokec3 			\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(right)=48,margin(bottom)=40,wbRGB=(65535,65535,65535)\
\cf3 \strokec3 			\cf8 \strokec8 Legend\cf4 \strokec4 /K/N=textL\
\cf3 \strokec3 			\cf4 \strokec4 Dynamics(\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 )\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 RadiantPower()\cf3 \strokec3 	\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 V_beta=VocvsIo()\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "Layout1()"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (KillJoy())\
\cf3 \strokec3 			\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 beep\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Abort\cf3 \strokec3  \cf7 \strokec7 "You\cf3 \strokec3  \cf7 \strokec7 have\cf3 \strokec3  \cf7 \strokec7 killed\cf3 \strokec3  \cf7 \strokec7 the\cf3 \strokec3  \cf7 \strokec7 MultiDevice\cf3 \strokec3  \cf7 \strokec7 Routine"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Filename();\cf3 \strokec3  \cf4 \strokec4 S_number+=\cf7 \strokec7 "/"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (n)\
\cf3 \strokec3 		\cf4 \strokec4 S_Filename=S_number\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flg)\
\cf3 \strokec3 			\cf4 \strokec4 PrintSave(0)\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 allwaves=\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ","\cf4 \strokec4 ,\cf7 \strokec7 "win:IVGraph"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "SaveIVData()"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_run-=1\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Hold\cf3 \strokec3  \cf2 \strokec2 run\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 constant\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<V_numDev*4)\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 nb=\cf7 \strokec7 "NotebookInfo"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 $nb\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_flag)\
\cf3 \strokec3 		\cf8 \strokec8 NewNotebook\cf4 \strokec4 /F=1/N=$nb\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "End\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Experiment\cf3 \strokec3  \cf7 \strokec7 Notebook"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Notebook\cf3 \strokec3  \cf4 \strokec4 $nb,\cf3 \strokec3  \cf4 \strokec4 showRuler=0\
\cf3 \strokec3 		\cf8 \strokec8 Notebook\cf3 \strokec3  \cf4 \strokec4 $nb,\cf3 \strokec3  \cf4 \strokec4 text=S_Username+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 has\cf3 \strokec3  \cf7 \strokec7 successfully\cf3 \strokec3  \cf7 \strokec7 finished\cf3 \strokec3  \cf7 \strokec7 his/her\cf3 \strokec3  \cf7 \strokec7 Multi-user\cf3 \strokec3  \cf7 \strokec7 experiment\cf3 \strokec3  \cf7 \strokec7 on\\r"\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 at\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 time\cf4 \strokec4 ()+\cf7 \strokec7 "\\r"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Notebook\cf3 \strokec3  \cf4 \strokec4 $nb,\cf3 \strokec3  \cf4 \strokec4 text=\cf7 \strokec7 "Experiment\cf3 \strokec3  \cf7 \strokec7 #"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_run)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 took\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (\cf6 \strokec6 StopMSTimer\cf4 \strokec4 (b)/1e6/60)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 secs.\\r\\r"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Notebook\cf3 \strokec3  \cf4 \strokec4 $nb,\cf3 \strokec3  \cf4 \strokec4 text=\cf7 \strokec7 "Goodnight,\cf3 \strokec3  \cf7 \strokec7 Igor"\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SaveNotebook\cf4 \strokec4 /O/P=webPath/S=5\cf3 \strokec3  \cf4 \strokec4 $nb\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "ExperimentStatus.html"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 $nb\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_run+=1\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Now\cf3 \strokec3  \cf2 \strokec2 increment\cf3 \strokec3  \cf2 \strokec2 run\cf3 \strokec3  \cf2 \strokec2 #\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 All\cf3 \strokec3  \cf7 \strokec7 Data"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 		\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 LeClanche()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 LeClanche\cf3 \strokec3  \cf2 \strokec2 Diagnostic\cf3 \strokec3  \cf2 \strokec2 package\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PSUSettings\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_Henry\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,option3,option5\
\cf3 \strokec3 	\cf4 \strokec4 Cell_Area();\cf3 \strokec3  \cf4 \strokec4 allwaves=\cf7 \strokec7 ""\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Define\cf3 \strokec3  \cf2 \strokec2 area\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Uoc\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 SetDelay(\cf7 \strokec7 "Delay"\cf4 \strokec4 ,9,\cf7 \strokec7 "1000"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_gain1,win=configpanel,mode=9\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 At\cf3 \strokec3  \cf2 \strokec2 low\cf3 \strokec3  \cf2 \strokec2 light\cf3 \strokec3  \cf2 \strokec2 levels\cf3 \strokec3  \cf2 \strokec2 need\cf3 \strokec3  \cf2 \strokec2 slow\cf3 \strokec3  \cf2 \strokec2 scan\cf3 \strokec3  \cf2 \strokec2 rate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 SetCompliance(\cf7 \strokec7 "Compliance"\cf4 \strokec4 ,6,\cf7 \strokec7 "200"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_avg,win=configpanel,mode=6\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 200\cf3 \strokec3  \cf2 \strokec2 uA\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_Henry=1;\cf3 \strokec3  \cf4 \strokec4 Sun(\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,13);\cf3 \strokec3  \cf4 \strokec4 V_Henry=0\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Dark\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf2 \strokec2 Scan\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Sun(\cf7 \strokec7 "0.1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,6);\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 LeClanche\cf3 \strokec3  \cf2 \strokec2 Ref.\cf3 \strokec3  \cf2 \strokec2 Intensity\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3   \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 GetAxis\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,5e-6,\cf6 \strokec6 floor\cf4 \strokec4 (V_max*5e5)/5e5\
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 All\cf3 \strokec3  \cf7 \strokec7 Data"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ChargevsPotential()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 charge\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_charge,V_biasVoltage,V_chargedensity,V_area,V_numpnts\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_layoutname\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 bias=0.3,n,V_npnts=\cf6 \strokec6 ceil\cf4 \strokec4 ((1.2-0.3)/0.05)+1\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 charge;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 0.3,0.05,\cf7 \strokec7 "V"\cf3 \strokec3  \cf4 \strokec4 charge\
\cf3 \strokec3 	\cf4 \strokec4 S_layoutname=\cf7 \strokec7 "Layout3()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 ChronoAmperometry()\
\cf3 \strokec3 		\cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 charge[n]=V_charge\
\cf3 \strokec3 		\cf4 \strokec4 V_biasVoltage+=0.05\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 50mV\cf3 \strokec3  \cf2 \strokec2 increment\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<\cf6 \strokec6 numpnts\cf4 \strokec4 (charge))\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 ChargeGraph\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "ChargeGraph()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Smooth\cf4 \strokec4 /S=2\cf3 \strokec3  \cf4 \strokec4 5,charge;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 charge\
\cf3 \strokec3 	\cf4 \strokec4 V_chargedensity=V_max/V_area\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=2\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf3 \strokec3 		\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 		\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ChronoAmperometry()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Datawave,transient2,transient5\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_biasVoltage,V_charge,V_complianceI,V_DataChannel0,V_numpnts\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_windowname\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,n\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(2*V_numpnts)\cf3 \strokec3  \cf4 \strokec4 Datawave;\cf3 \strokec3  \cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 transient2,transient5\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:ELEM\cf3 \strokec3  \cf7 \strokec7 VOLT,CURR,TIME"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 format\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 'CURR:DC'"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 default\cf3 \strokec3  \cf2 \strokec2 SENS\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:FUNC:MODE\cf3 \strokec3  \cf7 \strokec7 VOLT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:AUTO\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Disable\cf3 \strokec3  \cf2 \strokec2 Autoranging\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:MODE\cf3 \strokec3  \cf7 \strokec7 LIST"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Custom\cf3 \strokec3  \cf2 \strokec2 Sweep\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:LIST:VOLT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +wave2str(20,0.0))\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Build\cf3 \strokec3  \cf2 \strokec2 waveform\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_numpnts=20\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:LIST:VOLT:APP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +wave2str(25,V_biasVoltage))\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:LIST:VOLT:APP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +wave2str(25,V_biasVoltage))\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Duplicate\cf3 \strokec3  \cf2 \strokec2 up\cf3 \strokec3  \cf2 \strokec2 due\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 string\cf3 \strokec3  \cf2 \strokec2 length\cf3 \strokec3  \cf2 \strokec2 restriction\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:LIST:VOLT:APP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +wave2str(20,0.0))\
\cf3 \strokec3 		\cf4 \strokec4 V_numpnts+=70\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<4)\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 0.01"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:VOLT:NPLC\cf3 \strokec3  \cf7 \strokec7 0.02"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Integration\cf3 \strokec3  \cf2 \strokec2 Time\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (40*V_area)/1e3)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 max\cf3 \strokec3  \cf2 \strokec2 Compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_DataChannel0>0.5)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 0.5\cf3 \strokec3  \cf2 \strokec2 A\cf3 \strokec3  \cf2 \strokec2 limit\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 1,\cf7 \strokec7 "High\cf3 \strokec3  \cf7 \strokec7 Current\cf3 \strokec3  \cf7 \strokec7 Device.\cf3 \strokec3  \cf7 \strokec7 Have\cf3 \strokec3  \cf7 \strokec7 you\cf3 \strokec3  \cf7 \strokec7 configured\cf3 \strokec3  \cf7 \strokec7 Sourcemeter\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 4-wire\cf3 \strokec3  \cf7 \strokec7 Sense.\cf3 \strokec3   \cf7 \strokec7 \\rAttention,\cf3 \strokec3  \cf7 \strokec7 potentially\cf3 \strokec3  \cf7 \strokec7 lethal\cf3 \strokec3  \cf7 \strokec7 currents!!!"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag>1)\
\cf3 \strokec3 			\cf8 \strokec8 abort\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:RSEN\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a)\cf3 \strokec3 	\cf4 \strokec4 )\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 \'8326mA/cm2\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 max\cf4 \strokec4 (\cf6 \strokec6 ceil\cf4 \strokec4 (a/V_complianceI)*V_complianceI,V_complianceI)\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:UPP\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a))\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Select\cf3 \strokec3  \cf2 \strokec2 expected\cf3 \strokec3  \cf2 \strokec2 current\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRIG:DEL\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:AZER:STAT\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Autozero\cf3 \strokec3  \cf2 \strokec2 OFF\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:CLE"\cf4 \strokec4 )\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Clear\cf3 \strokec3  \cf2 \strokec2 Buffer\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRIG:COUN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numpnts))\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 Triggers\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":DISP:ENAB\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:TIME:RES"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 time\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 zero\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":READ?"\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Trigger\cf3 \strokec3  \cf2 \strokec2 Sweep\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 read\cf3 \strokec3  \cf2 \strokec2 data\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinaryWave2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 Datawave\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 IEEE\cf3 \strokec3  \cf2 \strokec2 Single\cf3 \strokec3  \cf2 \strokec2 precision\cf3 \strokec3  \cf2 \strokec2 Floating\cf3 \strokec3  \cf2 \strokec2 point\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 read\cf3 \strokec3  \cf2 \strokec2 junk\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 transient2=Datawave[2*p];\cf3 \strokec3  \cf4 \strokec4 transient5=Datawave[2*p+1]\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 0,transient5[0],\cf7 \strokec7 "s"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 transient2\
\cf3 \strokec3 	\cf4 \strokec4 S_windowname=\cf7 \strokec7 "ChronoAmpGraph"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 ChronoAmpGraph\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "ChronoAmpGraph()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "AcquireStyle1()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ScanFinish()\
\cf3 \strokec3 	\cf4 \strokec4 V_charge=CalcCharge()\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 wave2str(n,voltage)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n,voltage\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 i;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<n;\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 		\cf4 \strokec4 s+=\cf6 \strokec6 num2str\cf4 \strokec4 (voltage)+\cf7 \strokec7 ","\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 s[0,\cf6 \strokec6 strlen\cf4 \strokec4 (s)-2]\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 CalcCharge()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,Voltage,W_Findlevels\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,box=3,n,npos=0,nf=\cf6 \strokec6 pnt2x\cf4 \strokec4 (PhotoCurrent,\cf6 \strokec6 numpnts\cf4 \strokec4 (PhotoCurrent)),\cf6 \strokec6 sum\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=[0,18]\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent;\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent-=V_avg;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\cf3 \strokec3 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Offset\cf3 \strokec3  \cf2 \strokec2 wave\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 zero\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 FindLevels\cf4 \strokec4 /Q/M=0.2/R=(npos,nf)/B=(box)/N=2\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,V_max/24\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Threshold\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 one\cf3 \strokec3  \cf2 \strokec2 sixty\cf3 \strokec3  \cf2 \strokec2 fourth\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 a=W_Findlevels[0]+0.01;\cf3 \strokec3  \cf4 \strokec4 b=W_Findlevels[1]-0.02\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fudge\cf3 \strokec3  \cf2 \strokec2 limits\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag!=0)\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Cursor\cf3 \strokec3  \cf4 \strokec4 A\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,W_Findlevels[0];\cf3 \strokec3  \cf8 \strokec8 Cursor\cf3 \strokec3  \cf4 \strokec4 B\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,W_Findlevels[1]\
\cf3 \strokec3 		\cf6 \strokec6 sum\cf4 \strokec4 +=(\cf6 \strokec6 area\cf4 \strokec4 (PhotoCurrent,a,b)-(PhotoCurrent(b)*(b-a)))\
\cf3 \strokec3 		\cf4 \strokec4 npos=W_Findlevels[1]+0.1\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Look\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 next\cf3 \strokec3  \cf2 \strokec2 pulse\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (npos<nf)\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf6 \strokec6 sum\cf4 \strokec4 /n\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TimeDependenceWrapper(ctrlName,sense,source,level)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,sense,source;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 level\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PSUSettings,transient0,ywav\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_Area,V_biasCurrent,V_biasVoltage,V_defaultVoc,V_delay,V_numCell,V_nPulse,V_pulseWidth,V_PPTDuration,V_settlingTime,V_supos\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_windowname,S_ExptType,option5\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,bias,compliance,n,npnts=2048,nplc,tempst=V_settlingTime;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 cmd,str,wname\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 CmpStr\cf4 \strokec4 (sense,\cf7 \strokec7 "CURR"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf4 \strokec4 bias=V_BiasVoltage\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 Source\cf3 \strokec3  \cf2 \strokec2 Voltage\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 Prompt\cf3 \strokec3  \cf4 \strokec4 bias,\cf7 \strokec7 "Select\cf3 \strokec3  \cf7 \strokec7 Bias\cf3 \strokec3  \cf7 \strokec7 Voltage\cf3 \strokec3  \cf7 \strokec7 (V)"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 Bias"\cf4 \strokec4 ,bias\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag)\
\cf3 \strokec3 			\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_BiasVoltage=bias>1.3?0.8\cf3 \strokec3  \cf4 \strokec4 :bias;\cf3 \strokec3  \cf4 \strokec4 bias=V_biasVoltage\
\cf3 \strokec3 		\cf4 \strokec4 compliance=\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (32*V_area)/1e3)\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 max\cf3 \strokec3  \cf2 \strokec2 Compliance\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 str=\cf7 \strokec7 "Units:\cf3 \strokec3  \cf7 \strokec7 A\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 t"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "TransientCGraph"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 wname=\cf7 \strokec7 "transient2"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 bias=V_biasCurrent\
\cf3 \strokec3 		\cf9 \strokec9 Prompt\cf3 \strokec3  \cf4 \strokec4 bias,\cf7 \strokec7 "Select\cf3 \strokec3  \cf7 \strokec7 Bias\cf3 \strokec3  \cf7 \strokec7 Current\cf3 \strokec3  \cf7 \strokec7 (-ve\cf3 \strokec3  \cf7 \strokec7 A)"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 Bias"\cf4 \strokec4 ,bias\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag)\
\cf3 \strokec3 			\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_biasCurrent=((bias>2e-3)|(bias<-0.01))?0.0\cf3 \strokec3  \cf4 \strokec4 :bias;\cf3 \strokec3  \cf4 \strokec4 bias=V_biasCurrent\
\cf3 \strokec3 		\cf4 \strokec4 compliance=V_numCell*V_defaultVoc+0.6\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 voltage\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 str=\cf7 \strokec7 "Units:\cf3 \strokec3  \cf7 \strokec7 V\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 t"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "TransientVGraph"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 wname=\cf7 \strokec7 "transient0"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_PPTDuration<33)\
\cf3 \strokec3 		\cf4 \strokec4 V_settlingTime=0.002\
\cf3 \strokec3 	\cf9 \strokec9 elseif\cf3 \strokec3  \cf4 \strokec4 (V_PPTDuration<257)\
\cf3 \strokec3 		\cf4 \strokec4 V_settlingTime=0.01\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_settlingTime=0.08\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 nplc=\cf6 \strokec6 round\cf4 \strokec4 (1000*(((V_PPTDuration-225e-6-2.15e-3)/npnts)-V_settlingTime-185e-6-50e-6)*50/3)/1000\cf3 \strokec3 											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 225us\cf3 \strokec3  \cf2 \strokec2 trigger\cf3 \strokec3  \cf2 \strokec2 latency,\cf3 \strokec3  \cf2 \strokec2 2.15ms\cf3 \strokec3  \cf2 \strokec2 Overhead,\cf3 \strokec3  \cf2 \strokec2 50us\cf3 \strokec3  \cf2 \strokec2 Source\cf3 \strokec3  \cf2 \strokec2 Config,\cf3 \strokec3  \cf2 \strokec2 185us\cf3 \strokec3  \cf2 \strokec2 A/D\cf3 \strokec3  \cf2 \strokec2 conversion\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(level),4);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 8\
\cf3 \strokec3 	\cf4 \strokec4 TimeDependence(bias,compliance,npnts,nplc,sense,source)\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 $S_windowname\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 S_windowname+\cf7 \strokec7 "()"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 CmpStr\cf4 \strokec4 (sense,\cf7 \strokec7 "CURR"\cf4 \strokec4 ))\
\cf3 \strokec3 			\cf8 \strokec8 RemoveFromGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 transient0,transient1,transient3,transient4,transient5,transient6\
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lstyle($wname)=0,rgb($wname)=(65535,0,0)\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(left)=54,margin(right)=80,mirror(left)=1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$wname\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 CmpStr\cf4 \strokec4 (sense,\cf7 \strokec7 "CURR"\cf4 \strokec4 ))\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Invert\cf3 \strokec3  \cf2 \strokec2 wave\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 current\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 transient0,w;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 w;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "A"\cf4 \strokec4 ,w;\cf3 \strokec3  \cf4 \strokec4 w*=(-1);\cf3 \strokec3  \cf4 \strokec4 ywav=-V_avg\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 cmd,\cf7 \strokec7 "\\Z10Bias\cf3 \strokec3  \cf7 \strokec7 Voltage:\cf3 \strokec3  \cf7 \strokec7 %.2W0PA\\rCurrent\cf3 \strokec3  \cf7 \strokec7 average:\cf3 \strokec3  \cf7 \strokec7 %.3W0PA\\rRMS\cf3 \strokec3  \cf7 \strokec7 Noise:\cf3 \strokec3  \cf7 \strokec7 %g"\cf4 \strokec4 ,V_biasVoltage,V_avg,100*V_sdev/V_avg;\cf3 \strokec3  \cf8 \strokec8 TextBox\cf4 \strokec4 /C/N=text0/F=0/A=LT/X=88/Y=4\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 w;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,w;\cf3 \strokec3  \cf4 \strokec4 ywav=V_avg\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 cmd,\cf7 \strokec7 "\\Z10Bias\cf3 \strokec3  \cf7 \strokec7 Current:\cf3 \strokec3  \cf7 \strokec7 %.2W0PA\\rVoltage\cf3 \strokec3  \cf7 \strokec7 average:\cf3 \strokec3  \cf7 \strokec7 %.3W0PA\\rRMS\cf3 \strokec3  \cf7 \strokec7 Noise:\cf3 \strokec3  \cf7 \strokec7 %g"\cf4 \strokec4 ,V_biasCurrent,V_avg,100*V_sdev/V_avg;\cf3 \strokec3  \cf8 \strokec8 TextBox\cf4 \strokec4 /C/N=text0/F=0/A=LT/X=88/Y=4\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,1,\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "%s:PW:%g;NP:%g;IT:%g;BI:%g"\cf4 \strokec4 ,str,V_PulseWidth,0,level,bias;\cf3 \strokec3  \cf8 \strokec8 Note\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 w,str\
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel\
\cf3 \strokec3 	\cf4 \strokec4 S_ExptType=\cf7 \strokec7 ".pPT"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 V_settlingTime=tempst;\cf3 \strokec3  \cf4 \strokec4 V_supos=0\
\cf3 \strokec3 	\cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 PPT"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TimeDependence(bias,compliance,npnts,nplc,sense,source)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 sense,source;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 bias,compliance,npnts,nplc\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Datawave,transient0,transient4,transient5\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_delay,V_settlingTime,sourcemeter\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,n;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(2*npnts)\cf3 \strokec3  \cf4 \strokec4 Datawave;\cf3 \strokec3  \cf8 \strokec8 Redimension\cf4 \strokec4 /N=(npnts)\cf3 \strokec3  \cf4 \strokec4 transient0,transient4,transient5\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3  \cf7 \strokec7 Scan"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":STAT:MEAS:ENAB\cf3 \strokec3  \cf7 \strokec7 512"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 SRQ\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 "*SRE\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:ELEM\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +sense+\cf7 \strokec7 ",TIME"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 format\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 '"\cf4 \strokec4 +sense+\cf7 \strokec7 ":DC'"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Define\cf3 \strokec3  \cf2 \strokec2 sense\cf3 \strokec3  \cf2 \strokec2 function\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:FUNC:MODE\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +source)\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:"\cf4 \strokec4 +source+\cf7 \strokec7 ":MODE\cf3 \strokec3  \cf7 \strokec7 FIX;:SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (0.01))\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fixed\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode,\cf3 \strokec3  \cf2 \strokec2 SettlingTime=0.01ms\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:"\cf4 \strokec4 +source+\cf7 \strokec7 ":LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (bias))\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:VOLT:NPLC\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (nplc))\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:"\cf4 \strokec4 +sense+\cf7 \strokec7 ":PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (compliance))\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:CLE"\cf4 \strokec4 )\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Clear\cf3 \strokec3  \cf2 \strokec2 Buffer\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:TIME:RES"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 time\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 zero\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 "TRAC:POIN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (npnts)+\cf7 \strokec7 ";:TRIG:COUN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (npnts))\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:FEED:CONT\cf3 \strokec3  \cf7 \strokec7 NEXT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":DISP:ENAB\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 1\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":INIT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\}\
\cf3 \strokec3 		\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 0.1\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag>32)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 ((status%&32)==32)\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":TRAC:DATA?"\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 consider\cf3 \strokec3  \cf2 \strokec2 GPIBWrite2\cf3 \strokec3  \cf2 \strokec2 ":READ?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinaryWave2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 Datawave;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf4 \strokec4 transient4=Datawave[2*p];\cf3 \strokec3  \cf4 \strokec4 transient5=Datawave[2*p+1]\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 p1=transient5[0],p2=transient5[npnts-1]\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /I\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 p1,p2,\cf7 \strokec7 "s"\cf4 \strokec4 ,transient0\
\cf3 \strokec3 	\cf8 \strokec8 Interpolate2\cf4 \strokec4 /T=1/N=(npnts)/Y=transient0\cf3 \strokec3  \cf4 \strokec4 transient5,transient4;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf4 \strokec4 /I\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 p1,p2,\cf7 \strokec7 "s"\cf4 \strokec4 ,transient0\
\cf3 \strokec3 	\cf4 \strokec4 ScanFinish()\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 OFF\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 DynamicsWrapper(sense,source)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 sense,source\
\cf3 \strokec3 	\cf4 \strokec4 Dynamics(sense,source)\
\cf3 \strokec3 	\cf4 \strokec4 TransientData(sense)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Dynamics(sense,source)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 sense,source\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PSUsettings,Datawave,PhotoCurrent,transient0,transient4,transient5,RefDiodes,Voltage\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_biasCurrent,V_biasVoltage,V_lamp,V_nPulse,V_numCell,V_numpnts,V_pulseWidth,sourcemeter\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_windowname\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,i,n,status;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 s\
\cf3 \strokec3 	\cf4 \strokec4 V_numpnts=672\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Transients"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(2*V_numpnts)\cf3 \strokec3  \cf4 \strokec4 Datawave;\cf3 \strokec3  \cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 transient0,transient4,transient5;\cf3 \strokec3  \cf4 \strokec4 transient0=0\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":STAT:MEAS:ENAB\cf3 \strokec3  \cf7 \strokec7 512"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 SRQ\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 "*SRE\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:ELEM\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +sense+\cf7 \strokec7 ",TIME"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 format\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 '"\cf4 \strokec4 +sense+\cf7 \strokec7 ":DC'"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Define\cf3 \strokec3  \cf2 \strokec2 sense\cf3 \strokec3  \cf2 \strokec2 function\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:FUNC:MODE\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +source)\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:"\cf4 \strokec4 +source+\cf7 \strokec7 ":MODE\cf3 \strokec3  \cf7 \strokec7 FIX;:SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 0.01"\cf4 \strokec4 )\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fixed\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (40*V_area)/1e3)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 max\cf3 \strokec3  \cf2 \strokec2 Compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 CmpStr\cf4 \strokec4 (sense,\cf7 \strokec7 "CURR"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_biasVoltage))\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (\cf6 \strokec6 ceil\cf4 \strokec4 (40*V_area)/1e3))\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 		\cf2 \strokec2 Command(":SENS:CURR:RANGE:UPP\cf3 \strokec3  \cf2 \strokec2 10e-3")\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 		\cf4 \strokec4 S_windowname=\cf7 \strokec7 "TransientCGraph"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:CURR:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_biasCurrent))\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:VOLT:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numCell*1+0.6))\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 voltage\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 		\cf2 \strokec2 Command(":SENS:VOLT:RANGE:UPP\cf3 \strokec3  \cf2 \strokec2 1")\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 		\cf4 \strokec4 S_windowname=\cf7 \strokec7 "TransientVGraph"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:"\cf4 \strokec4 +sense+\cf7 \strokec7 ":NPLC\cf3 \strokec3  \cf7 \strokec7 0.18"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:CLE"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:POIN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numpnts)+\cf7 \strokec7 ";:TRIG:COUN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numpnts))\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:FEED:CONT\cf3 \strokec3  \cf7 \strokec7 NEXT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":DISP:ENAB\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_lamp==0)\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":INIT"\cf4 \strokec4 )\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Timing\cf3 \strokec3  \cf2 \strokec2 Issue:\cf3 \strokec3   \cf2 \strokec2 INIT\cf3 \strokec3  \cf2 \strokec2 prior\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 diode\cf3 \strokec3  \cf2 \strokec2 control\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_lamp==1)\
\cf3 \strokec3 		\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,4,\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 0.5\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Trigger\cf3 \strokec3  \cf2 \strokec2 filter\cf3 \strokec3  \cf2 \strokec2 wheel\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 turn\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 FilterWheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,1,\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<10;\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s,\cf7 \strokec7 "\\F'Chicago'\\Z12%1.2f"\cf4 \strokec4 ,100*RefDiodes[12][i]\
\cf3 \strokec3 			\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 0.75;\cf3 \strokec3  \cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=s+\cf7 \strokec7 "%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUsettings(9-i),4)\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 xx%\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 0.75;\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 0%\cf3 \strokec3  \cf2 \strokec2 Sun\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_lamp==1)\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":INIT"\cf4 \strokec4 )\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Timing\cf3 \strokec3  \cf2 \strokec2 Issue:\cf3 \strokec3   \cf2 \strokec2 INIT\cf3 \strokec3  \cf2 \strokec2 after\cf3 \strokec3  \cf2 \strokec2 Xe\cf3 \strokec3  \cf2 \strokec2 lamp\cf3 \strokec3  \cf2 \strokec2 fliter\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\};\cf3 \strokec3  \cf4 \strokec4 status=V_Flag\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((status%&1)==1)\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":TRAC:DATA?"\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 consider\cf3 \strokec3  \cf2 \strokec2 GPIBWrite2\cf3 \strokec3  \cf2 \strokec2 ":READ?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinaryWave2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 Datawave;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\cf3 \strokec3 													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 IEEE\cf3 \strokec3  \cf2 \strokec2 Single\cf3 \strokec3  \cf2 \strokec2 precision\cf3 \strokec3  \cf2 \strokec2 Floating\cf3 \strokec3  \cf2 \strokec2 point\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 transient4=-Datawave[2*p];\cf3 \strokec3  \cf4 \strokec4 transient5=Datawave[2*p+1]\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 p1=transient5[0],p2=transient5[V_numpnts-1]\
\cf3 \strokec3 	\cf8 \strokec8 Interpolate2\cf4 \strokec4 /T=1/N=(V_numpnts)/Y=transient0\cf3 \strokec3  \cf4 \strokec4 transient5,transient4\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /I\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 p1,p2,\cf7 \strokec7 "s"\cf3 \strokec3  \cf4 \strokec4 transient0\
\cf3 \strokec3 	\cf4 \strokec4 ScanFinish()\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":DISP:ENAB\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUsettings[10],4)\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 $S_windowname\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 S_windowname+\cf7 \strokec7 "()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "AcquireStyle1()"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 cmpStr\cf4 \strokec4 (sense,\cf7 \strokec7 "CURR"\cf4 \strokec4 ))\
\cf3 \strokec3 			\cf8 \strokec8 RemovefromGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 transient2_INT\
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lstyle(transient0)=0,rgb(transient0)=(65535,0,0)\
\cf3 \strokec3 			\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "A"\cf4 \strokec4 ,transient0\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 mirror(left)=1\
\cf3 \strokec3 			\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,transient0\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=IVGraph\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s\cf3 \strokec3  \cf7 \strokec7 "PW:%g;NP:%g;IT:%g;LP:%s"\cf3 \strokec3  \cf4 \strokec4 V_pulseWidth,V_nPulse,0.5,\cf7 \strokec7 "Xelamp"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Note\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 transient0,s\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TransientData(sense)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 sense\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 transient0,W_FIndlevels,ywav\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_origin,V_threshold\
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=(0.04,15)\cf3 \strokec3  \cf4 \strokec4 transient0\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 CmpStr\cf4 \strokec4 (sense,\cf7 \strokec7 "CURR"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf8 \strokec8 FindLevels\cf4 \strokec4 /Q/B=3/N=20/R=(0.04,18)\cf3 \strokec3  \cf4 \strokec4 transient0,V_min+(V_max-V_min)/128\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Threshold\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 half\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 1\cf3 \strokec3  \cf2 \strokec2 hundreth\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 1\cf3 \strokec3  \cf2 \strokec2 sun\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 FindLevels\cf4 \strokec4 /Q/B=5/N=14/R=(0.04,18)\cf3 \strokec3  \cf4 \strokec4 transient0,V_min+(V_max-V_min)/32\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Threshold\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 half\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 1\cf3 \strokec3  \cf2 \strokec2 tenth\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 1\cf3 \strokec3  \cf2 \strokec2 sun\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ywav=0\
\cf3 \strokec3 	\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (V_Flag)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\
\cf3 \strokec3 			\cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,V_min,V_max\
\cf3 \strokec3 			\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 b=10^-\cf6 \strokec6 floor\cf4 \strokec4 (\cf6 \strokec6 log\cf4 \strokec4 (V_max-V_min))\
\cf3 \strokec3 			\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=\cf6 \strokec6 round\cf4 \strokec4 ((V_max-V_min)*b)/b/40;\cf3 \strokec3  \cf4 \strokec4 V_origin=8*a;\cf3 \strokec3  \cf4 \strokec4 ywav=V_origin\
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 quickdrag(ywav)=1,live(ywav)=1\
\cf3 \strokec3 			\cf8 \strokec8 ControlInfo\cf4 \strokec4 /W=transientCgraph\cf3 \strokec3  \cf4 \strokec4 button0\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 				\cf8 \strokec8 ControlBar\cf3 \strokec3  \cf4 \strokec4 20\
\cf3 \strokec3 				\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 button0,pos=\{160,2\},size=\{80,16\},\cf9 \strokec9 proc\cf4 \strokec4 =TransientAccept,title=\cf7 \strokec7 "Get\cf3 \strokec3  \cf7 \strokec7 data"\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 SetVariable\cf3 \strokec3  \cf4 \strokec4 setvar0,pos=\{0,2\},size=\{144,16\},\cf9 \strokec9 proc\cf4 \strokec4 =SetThreshold,title=\cf7 \strokec7 "Peak\cf3 \strokec3  \cf7 \strokec7 Threshold"\cf4 \strokec4 ,fSize=10,frame=0,limits=\{V_min,V_max,a\},value=V_threshold\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 SetFormula\cf3 \strokec3  \cf4 \strokec4 V_threshold,\cf7 \strokec7 "UpdateXHairGlobals(root:WinGlobals:TransientCGraph:S_TraceOffsetInfo)"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 offset(ywav)=\{0,V_Origin\}\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 then\cf3 \strokec3  \cf2 \strokec2 fall\cf3 \strokec3  \cf2 \strokec2 through\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 default\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (V_LevelsFound)\
\cf3 \strokec3 				\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 4:\
\cf3 \strokec3 					\cf4 \strokec4 W_Findlevels=\{0.65,2.25,2.65,4.25,4.5,6.25,6.4,8.15,8.35,10.1\}\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Sulphur\cf3 \strokec3  \cf2 \strokec2 lamp\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 default\cf4 \strokec4 :\
\cf3 \strokec3 					\cf4 \strokec4 W_Findlevels=\{0.68,1.51,2.20,3.05,3.72,4.59,5.24,6.11,6.75,7.65,8.27,9.17,9.83,10.71,11.35,12.23,12.89,13.77,14.41,15.29\}\
\cf3 \strokec3 			\cf9 \strokec9 endswitch\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 W_Findlevels\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 filled\cf3 \strokec3  \cf2 \strokec2 by\cf3 \strokec3  \cf2 \strokec2 Findlevels\cf3 \strokec3  \cf2 \strokec2 auotmatically\cf3 \strokec3  \cf2 \strokec2 Therfore\cf3 \strokec3  \cf2 \strokec2 OK,\cf3 \strokec3  \cf2 \strokec2 ie\cf3 \strokec3  \cf2 \strokec2 14\cf3 \strokec3  \cf2 \strokec2 level\cf3 \strokec3  \cf2 \strokec2 crossings\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 default\cf4 \strokec4 :\
\cf3 \strokec3 			\cf4 \strokec4 W_Findlevels=\{0.68,1.51,2.20,3.05,3.72,4.59,5.24,6.11,6.75,7.65,8.27,9.17,9.83,10.71,11.35,12.23,12.89,13.77,14.41,15.29\}\
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 TransientCalc(sense)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 smooth_it(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 transient1\
\cf3 \strokec3 	\cf8 \strokec8 Smooth\cf3 \strokec3  \cf4 \strokec4 2,\cf3 \strokec3  \cf4 \strokec4 transient1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TransientAccept(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 transient0\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_threshold\
\cf3 \strokec3 	\cf8 \strokec8 FindLevels\cf4 \strokec4 /Q/B=7/N=4\cf3 \strokec3  \cf4 \strokec4 transient0,V_threshold\
\cf3 \strokec3 	\cf8 \strokec8 KillControl\cf3 \strokec3  \cf4 \strokec4 button0;\cf3 \strokec3  \cf8 \strokec8 KillControl\cf3 \strokec3  \cf4 \strokec4 button1;\cf3 \strokec3  \cf8 \strokec8 KillControl\cf3 \strokec3  \cf4 \strokec4 setvar0\
\cf3 \strokec3 	\cf8 \strokec8 ControlBar\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf4 \strokec4 TransientCalc(\cf7 \strokec7 "CURR"\cf4 \strokec4 )\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TransientCalc(sense)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 sense\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 RadPower,RefDiodes,transient0,W_FindLevels\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_system\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 i,a,b,np=\cf6 \strokec6 numpnts\cf4 \strokec4 (W_FIndLevels)/2,ref=13;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 s,units\
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=(0,W_FIndlevels[0]-0.4)\cf3 \strokec3  \cf4 \strokec4 transient0\cf2 \strokec2 //;\cf3 \strokec3  \cf2 \strokec2 transient0-=V_avg\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 transient0,transient1,transient2,transient3,transient4,transient5,transient6,transient7,transient8,transient9,transient10\
\cf3 \strokec3 	\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<np;\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 		\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$(\cf7 \strokec7 "transient"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (np-i))\cf3 \strokec3 	\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 w=0\
\cf3 \strokec3 		\cf4 \strokec4 w[\cf6 \strokec6 x2pnt\cf4 \strokec4 (transient0,W_FindLevels[2*i]-0.1),\cf6 \strokec6 x2pnt\cf4 \strokec4 (transient0,W_FindLevels[2*i+1]+0.1)]=transient0[p]/RefDiodes[ref][i]\
\cf3 \strokec3 	\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 mean\cf4 \strokec4 (transient0,W_FindLevels[0]+0.1,W_FindLevels[1]-0.4)\
\cf3 \strokec3 	\cf4 \strokec4 b=\cf6 \strokec6 max\cf4 \strokec4 (\cf6 \strokec6 mean\cf4 \strokec4 (transient5,W_FindLevels[0]+0.4,W_FindLevels[1]-0.4),\cf6 \strokec6 mean\cf4 \strokec4 (transient0,W_FindLevels[2*(np-1)]+0.4,W_FindLevels[2*(np-1)+1]-0.4))\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 CmpStr\cf4 \strokec4 (sense,\cf7 \strokec7 "CURR"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf4 \strokec4 units=\cf7 \strokec7 "%1.3f\cf3 \strokec3  \cf7 \strokec7 Sun:\cf3 \strokec3  \cf7 \strokec7 %2.3W1PA"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf4 \strokec4 V_min,1.2*b\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Scale\cf3 \strokec3  \cf2 \strokec2 axis\cf3 \strokec3  \cf2 \strokec2 @\cf3 \strokec3  \cf2 \strokec2 110%\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 trim\cf3 \strokec3  \cf2 \strokec2 spikes\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 units=\cf7 \strokec7 "%1.3f\cf3 \strokec3  \cf7 \strokec7 Sun:\cf3 \strokec3  \cf7 \strokec7 %2.3W1PV"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=1\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 GetAxis\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf4 \strokec4 V_min,V_max\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(np)\cf3 \strokec3  \cf4 \strokec4 RadPower\
\cf3 \strokec3 	\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<np;\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 		\cf4 \strokec4 RadPower[i]=\cf6 \strokec6 mean\cf4 \strokec4 (transient0,W_FindLevels[2*i]+0.4,W_FindLevels[2*i+1]-0.4)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s,units,RefDiodes[ref][i],RadPower[i]\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s,\cf7 \strokec7 "Tag/C/N=text%d/F=0/X=0.0/Y=%g\cf3 \strokec3  \cf7 \strokec7 Transient0,%g,\\"%s\\""\cf4 \strokec4 ,i,6*\cf6 \strokec6 sign\cf4 \strokec4 (np-i-1),(W_FindLevels[2*i]+W_FindLevels[2*i+1])/2,s\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 s\
\cf3 \strokec3 	\cf9 \strokec9 endfor\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 PPT(sense,level)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Simple\cf3 \strokec3  \cf2 \strokec2 PPT\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 level;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 sense\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 DiodeLabels\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Input3,Input4,Input5,Input6,Input7,Input8,IVparams\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_Voc,V_Jsc,V_delay,V_endVolt,V_Henry,V_incrVolt,V_powerIn1,V_PPTDuration,V_RefCalibration,V_settlingTime\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_windowname,S_exptType,option5\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,t;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,value=1;\cf3 \strokec3  \cf4 \strokec4 tabPanels(\cf7 \strokec7 "tab0"\cf4 \strokec4 ,1)\
\cf3 \strokec3 	\cf4 \strokec4 V_delay=(V_delay<4)?4:\cf3 \strokec3  \cf4 \strokec4 V_delay;\cf3 \strokec3  \cf4 \strokec4 V_Henry=1;\cf3 \strokec3  \cf4 \strokec4 V_incrVolt=0.01;\cf3 \strokec3  \cf4 \strokec4 V_settlingTime=0.5\
\cf3 \strokec3 	\cf4 \strokec4 Sun(DiodeLabels[level+1][1],level);\cf3 \strokec3  \cf4 \strokec4 a=\cf6 \strokec6 round\cf4 \strokec4 (IVparams[12*level+6][0]/0.0005)*0.0005\cf3 \strokec3 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Find\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 Vpmax\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_powerIn1=IVparams[12*level+1][0]\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Stability\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +DiodeLabels[level+1][1];\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 SweepPPT(\cf7 \strokec7 "Current"\cf4 \strokec4 ,a,\cf6 \strokec6 round\cf4 \strokec4 (V_PPTDuration*28/23))\
\cf3 \strokec3 	\cf4 \strokec4 ScanFinish()\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,Input3;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 Input3,Input6;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "A"\cf4 \strokec4 ,Input4;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 Input4,Input7;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "%"\cf4 \strokec4 ,Input5,Input3;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 Input5,Input8\
\cf3 \strokec3 	\cf4 \strokec4 Input3*=(Input4/(V_Voc*V_Jsc*V_area));\cf3 \strokec3  \cf4 \strokec4 Input5*=(1e3/-V_area);\cf3 \strokec3  \cf4 \strokec4 Input8*=(1e3/-V_area)*(0.1/IVparams[12*level+1][0])\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 GraphPPT\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "GraphPPT()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWIndow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 GraphIV\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "GraphIV()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel\cf3 \strokec3  \cf4 \strokec4 GraphPPT;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "GraphPPT"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=GraphPPT\
\cf3 \strokec3 	\cf4 \strokec4 S_ExptType=\cf7 \strokec7 ".pPT"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 PPT"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SweepPPT(sense,initialBias,totalTime)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 sense;\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 initialBias,totalTime\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 DataWave,Input3,Input4,input5\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_delay,V_settlingTime\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (40*V_area)/1e3),bias,delta=0.0064,flg=1,n,npnts=\cf6 \strokec6 round\cf4 \strokec4 (totalTime/0.3+1),t\cf3 \strokec3 													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Point\cf3 \strokec3  \cf2 \strokec2 every\cf3 \strokec3  \cf2 \strokec2 0.3s,\cf3 \strokec3  \cf2 \strokec2 ...s\cf3 \strokec3  \cf2 \strokec2 sweep\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_settlingTime=0.5;\cf3 \strokec3  \cf4 \strokec4 V_delay=0;\cf3 \strokec3  \cf4 \strokec4 bias=initialBias>1.2?1.2\cf3 \strokec3  \cf4 \strokec4 :initialBias\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Returns\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 minimum\cf3 \strokec3  \cf2 \strokec2 settling\cf3 \strokec3  \cf2 \strokec2 time\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 max\cf3 \strokec3  \cf2 \strokec2 ppt\cf3 \strokec3  \cf2 \strokec2 tracking\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(npnts)\cf3 \strokec3  \cf4 \strokec4 Input3,Input4,Input5\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a))\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 (Area\cf3 \strokec3  \cf2 \strokec2 x\cf3 \strokec3  \cf2 \strokec2 40)\cf3 \strokec3  \cf2 \strokec2 mA\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:RANGE:AUTO\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (0.01))\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fixed\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 t=\cf6 \strokec6 StartMStimer\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (bias))\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 Voltage\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Input3[n]=bias\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Voltage\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Input4[n]=ReadData(1)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 OK\cf3 \strokec3  \cf2 \strokec2 here\cf3 \strokec3  \cf2 \strokec2 we\cf3 \strokec3  \cf2 \strokec2 have\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 value\cf3 \strokec3  \cf2 \strokec2 after\cf3 \strokec3  \cf2 \strokec2 some\cf3 \strokec3  \cf2 \strokec2 Hocus\cf3 \strokec3  \cf2 \strokec2 Pocus\cf3 \strokec3  \cf2 \strokec2 that\cf3 \strokec3  \cf2 \strokec2 only\cf3 \strokec3  \cf2 \strokec2 Robin\cf3 \strokec3  \cf2 \strokec2 understands\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Input5[n]=Input3[n]*Input4[n]\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (n>0)\
\cf3 \strokec3 			\cf4 \strokec4 delta=(Input5[n]<Input5[n-1]\cf3 \strokec3  \cf4 \strokec4 )?delta\cf3 \strokec3  \cf4 \strokec4 :-delta\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 bias\cf3 \strokec3  \cf2 \strokec2 value\cf3 \strokec3  \cf2 \strokec2 based\cf3 \strokec3  \cf2 \strokec2 on\cf3 \strokec3  \cf2 \strokec2 Power\cf3 \strokec3  \cf2 \strokec2 values\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 sign\cf4 \strokec4 (delta)!=flg)\
\cf3 \strokec3 			\cf4 \strokec4 delta=(\cf6 \strokec6 abs\cf4 \strokec4 (delta)<0.0002)?delta\cf3 \strokec3  \cf4 \strokec4 :delta/2\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 bias+=delta\cf3 \strokec3 		 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 what's\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 new\cf3 \strokec3  \cf2 \strokec2 voltage\cf3 \strokec3  \cf2 \strokec2 ?\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!(bias>0.3)&(bias<1))\
\cf3 \strokec3 			\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Error\cf3 \strokec3  \cf7 \strokec7 !\cf3 \strokec3  \cf7 \strokec7 Trying\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 set\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (bias)+\cf7 \strokec7 ".\cf3 \strokec3  \cf7 \strokec7 Voltage\cf3 \strokec3  \cf7 \strokec7 out\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Range"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<npnts)\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 stopMSTimer\cf4 \strokec4 (t)/1e6/npnts\
\cf3 \strokec3 	\cf4 \strokec4 bias=0;\cf3 \strokec3  \cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (bias))\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Put\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 cell\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 0V\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 FlushKeithley()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Here\cf3 \strokec3  \cf2 \strokec2 we\cf3 \strokec3  \cf2 \strokec2 can\cf3 \strokec3  \cf2 \strokec2 keep\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 device\cf3 \strokec3  \cf2 \strokec2 under\cf3 \strokec3  \cf2 \strokec2 illumination\cf3 \strokec3  \cf2 \strokec2 !\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 0,a,\cf7 \strokec7 "s"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 Input3,Input4,Input5\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 PPTEquilibration(ctrlName,level)\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Norman's\cf3 \strokec3  \cf2 \strokec2 routines\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 level;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 DiodeLabels\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVparams,Input0,transient0,transient3\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_numpnts,V_biasVoltage,V_complianceI,V_complianceV,V_delay,V_incrVolt,V_integrationTime,V_settlingTime,V_Henry\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_Jsc,V_Voc,V_ff,V_Jpp,V_Vpp,V_pwr,V_supos,sourcemeter\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 d_t,S_windowname,S_exptType,option3,option5\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=12*level,b,c,compliance,d=3,i,n,npnts=256,nplc,m1,t;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 list=\cf7 \strokec7 "2;4;8;12;16;20;24;32;64"\cf4 \strokec4 ,str,s0=\cf7 \strokec7 "Scan\cf3 \strokec3  \cf7 \strokec7 Rates:\\r"\cf4 \strokec4 ,sense=\cf7 \strokec7 "CURR"\cf4 \strokec4 ,source=\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,wname\
\cf3 \strokec3 	\cf4 \strokec4 V_Henry=1;\cf3 \strokec3  \cf4 \strokec4 V_incrVolt=0.01\
\cf3 \strokec3 	\cf4 \strokec4 V_complianceI=\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (32*V_area)/1e3);\cf3 \strokec3  \cf4 \strokec4 m1=level\
\cf3 \strokec3 	\cf9 \strokec9 Prompt\cf3 \strokec3  \cf4 \strokec4 d,\cf7 \strokec7 "Sweep\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3  \cf7 \strokec7 (s)"\cf4 \strokec4 ,popup,list\
\cf3 \strokec3 	\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Measurement\cf3 \strokec3  \cf7 \strokec7 Time"\cf4 \strokec4 ,d\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag)\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "SetIncrement(\\"incr\\",%g,\\"%s\\")"\cf4 \strokec4 ,V_incrVolt,\cf6 \strokec6 num2str\cf4 \strokec4 (V_incrVolt*1e3);\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf4 \strokec4 Sun(\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,13)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Dark\cf3 \strokec3  \cf2 \strokec2 current\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Sun(DiodeLabels[level][0],level);\cf3 \strokec3  \cf4 \strokec4 c=\cf6 \strokec6 round\cf4 \strokec4 (V_Vpp/0.0005)*0.0005\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 1\cf3 \strokec3  \cf2 \strokec2 sun\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 t=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringfromList\cf4 \strokec4 (d-1,list))\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Desired\cf3 \strokec3  \cf2 \strokec2 measurement\cf3 \strokec3  \cf2 \strokec2 times\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (t<33)\
\cf3 \strokec3 		\cf4 \strokec4 V_settlingTime=0.002\
\cf3 \strokec3 	\cf9 \strokec9 elseif\cf3 \strokec3  \cf4 \strokec4 (t<257)\
\cf3 \strokec3 		\cf4 \strokec4 V_settlingTime=0.01\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_settlingTime=0.08\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 nplc=\cf6 \strokec6 round\cf4 \strokec4 (1000*(((t-225e-6-2.15e-3)/npnts)-V_settlingTime-185e-6-50e-6)*50/3)/1000\cf3 \strokec3 														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 225us\cf3 \strokec3  \cf2 \strokec2 trigger\cf3 \strokec3  \cf2 \strokec2 latency,\cf3 \strokec3  \cf2 \strokec2 2.15ms\cf3 \strokec3  \cf2 \strokec2 Overhead,\cf3 \strokec3  \cf2 \strokec2 50us\cf3 \strokec3  \cf2 \strokec2 Source\cf3 \strokec3  \cf2 \strokec2 Config,\cf3 \strokec3  \cf2 \strokec2 185us\cf3 \strokec3  \cf2 \strokec2 A/D\cf3 \strokec3  \cf2 \strokec2 conversion\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(npnts)\cf3 \strokec3  \cf4 \strokec4 transient0\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3  \cf7 \strokec7 Scan"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_ff>60)\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Only\cf3 \strokec3  \cf2 \strokec2 if\cf3 \strokec3  \cf2 \strokec2 FF\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 >\cf3 \strokec3  \cf2 \strokec2 60%\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Input0=\{0,c-0.1,c-0.05,c,c+0.02,c+0.05,V_Voc\}\
\cf3 \strokec3 		\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<5;\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 			\cf4 \strokec4 V_biasVoltage=Input0[i]\
\cf3 \strokec3 			\cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,2,\cf7 \strokec7 "Open"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf4 \strokec4 TimeDependence(V_biasVoltage,V_complianceI,npnts,nplc,sense,source)\
\cf3 \strokec3 			\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,1,\cf7 \strokec7 "Close"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf4 \strokec4 wname=\cf7 \strokec7 "transient"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (i)\
\cf3 \strokec3 			\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 TransientCGraph\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 				\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "TransientCGraph()"\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(left)=54,margin(right)=54,grid=2\
\cf3 \strokec3 				\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\\\Z12\\\\f01Current\cf3 \strokec3  \cf7 \strokec7 Sweep\cf3 \strokec3  \cf7 \strokec7 /\\U"\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=IVGraph\cf3 \strokec3  \cf4 \strokec4 TransientCGraph\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lstyle($wname)=i,rgb($wname)=(i*5000,0,65535-i*5000)\
\cf3 \strokec3 			\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$wname;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 transient0,w;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 w\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "\\Z09Bias\cf3 \strokec3  \cf7 \strokec7 Voltage:\cf3 \strokec3  \cf7 \strokec7 %.1W0PV,\cf3 \strokec3  \cf7 \strokec7 Current\cf3 \strokec3  \cf7 \strokec7 Ave:\cf3 \strokec3  \cf7 \strokec7 %.2W0PA"\cf4 \strokec4 ,V_biasVoltage,V_avg\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Tag/C/N=text%g/F=0/A=LC/L=1/X=0/Y=%g\cf3 \strokec3  \cf7 \strokec7 %s,%g,\\"%s\\""\cf4 \strokec4 ,i,(-10*\cf6 \strokec6 mod\cf4 \strokec4 (i,6)),wname,(0.8*t),str;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 		 \cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,1,\cf7 \strokec7 "Open"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf4 \strokec4 TimeDependence(0,V_complianceV,npnts,nplc,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 )\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 MonitorCurrent\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,0,\cf7 \strokec7 "Close"\cf4 \strokec4 )\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 wname=\cf7 \strokec7 "transient"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (12);\cf3 \strokec3  \cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$wname;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 transient0,w;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 w;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,$wname\
\cf3 \strokec3 		\cf8 \strokec8 AppendtoGraph\cf4 \strokec4 /R\cf3 \strokec3  \cf4 \strokec4 $wname;\cf3 \strokec3  \cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lstyle($wname)=0,rgb($wname)=(65535,0,0);\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1\cf3 \strokec3  \cf4 \strokec4 right;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\\\Z12\\\\f01Voltage\cf3 \strokec3  \cf7 \strokec7 Sweep\cf3 \strokec3  \cf7 \strokec7 /\\U"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=(0,0.1)\cf3 \strokec3  \cf4 \strokec4 transient0;\cf3 \strokec3  \cf4 \strokec4 V_Jsc=V_avg;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 transient3;\cf3 \strokec3  \cf4 \strokec4 V_Jpp=V_avg;\cf3 \strokec3  \cf4 \strokec4 V_Vpp=c;\cf3 \strokec3  \cf4 \strokec4 V_pwr=V_Jpp*V_Vpp\
\cf3 \strokec3 		\cf4 \strokec4 a=\cf6 \strokec6 rightx\cf4 \strokec4 ($wname);\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=(a-0.1,a)\cf3 \strokec3  \cf4 \strokec4 $wname;\cf3 \strokec3  \cf4 \strokec4 V_Voc=V_avg\
\cf3 \strokec3 		\cf4 \strokec4 IVparams[12*m1+3][0]=V_Voc;\cf3 \strokec3  \cf4 \strokec4 IVparams[12*m1+6][0]=V_Jsc;\cf3 \strokec3  \cf4 \strokec4 IVparams[12*m1+7][0]=V_Jsc/V_area;\cf3 \strokec3  \cf4 \strokec4 IVparams[12*m1+8][0]=V_Vpp;\cf3 \strokec3  \cf4 \strokec4 IVparams[12*m1+9][0]=V_Jpp\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_biasVoltage=0;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "TransientCGraph"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 PPTStability"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 PPTStability(ctrlName,level)\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Norman's\cf3 \strokec3  \cf2 \strokec2 routines\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 level;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 DiodeLabels\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 DarkCurrent,PhotoCurrent0,PhotoCurrent1,HysteresisValues,RefDiodes,ScanRates,SettlingTimes,transient0\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVparams,Input0,Input1,Input2,Input3,Input4,Input5,Input6,Input7,Input8,Input9,Input10\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_numpnts,V_biasVoltage,V_biasCurrent,V_complianceI,V_complianceV,V_delay,V_integrationTime,V_settlingTime,V_Henry,V_incrVolt,V_endVolt,V_v0\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_supos,V_area,V_length,V_refCalibration,sourcemeter\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 d_t,S_windowname,S_exptType,option3,option5\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=12*level,b,c,d=3,i,n,Pin=RefDiodes[15][6-level]/10,t;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 list=\cf7 \strokec7 "2;4;8;12;16;20;24"\cf4 \strokec4 ,str,s0=\cf7 \strokec7 "Scan\cf3 \strokec3  \cf7 \strokec7 Rates:\\r"\cf4 \strokec4 ,wname0,wname1\
\cf3 \strokec3 	\cf4 \strokec4 V_Henry=1;\cf3 \strokec3  \cf4 \strokec4 V_endVolt=-0.2;\cf3 \strokec3  \cf4 \strokec4 V_incrVolt=0.01\
\cf3 \strokec3 	\cf9 \strokec9 Prompt\cf3 \strokec3  \cf4 \strokec4 d,\cf7 \strokec7 "Sweep\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3  \cf7 \strokec7 (s)"\cf4 \strokec4 ,popup,list\
\cf3 \strokec3 	\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Measurement\cf3 \strokec3  \cf7 \strokec7 Time"\cf4 \strokec4 ,d\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag)\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 t=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringfromList\cf4 \strokec4 (d-1,list))\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Desired\cf3 \strokec3  \cf2 \strokec2 measurement\cf3 \strokec3  \cf2 \strokec2 times\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "SetIncrement(\\"incr\\",%g,\\"%s\\")"\cf4 \strokec4 ,V_incrVolt,\cf6 \strokec6 num2str\cf4 \strokec4 (V_incrVolt*1e3);\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf4 \strokec4 V_Henry=1;\cf3 \strokec3  \cf4 \strokec4 Sun(\cf7 \strokec7 "0%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,10);\cf3 \strokec3  \cf4 \strokec4 V_Henry=0\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Dark\cf3 \strokec3  \cf2 \strokec2 current\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Sun(DiodeLabels[level+1][1],level);\cf3 \strokec3  \cf4 \strokec4 c=\cf6 \strokec6 round\cf4 \strokec4 (IVparams[12*level+6][0]/0.0005)*0.0005\cf3 \strokec3 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 1\cf3 \strokec3  \cf2 \strokec2 sun\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 4\
\cf3 \strokec3 	\cf4 \strokec4 b=V_settlingTime\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Temporary\cf3 \strokec3  \cf2 \strokec2 store\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +ctrlName;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 SweepPPT(\cf7 \strokec7 "Current"\cf4 \strokec4 ,c,t+3)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Start\cf3 \strokec3  \cf2 \strokec2 measuring\cf3 \strokec3  \cf2 \strokec2 stuff\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 Input3,Input6,Input0;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 Input4,Input7;\cf3 \strokec3  \cf4 \strokec4 Input7/=V_area;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 Input5,Input8;\cf3 \strokec3  \cf4 \strokec4 Input8/=-V_area\
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 transient0\cf3 \strokec3  \cf4 \strokec4 Input0;\cf3 \strokec3  \cf4 \strokec4 Input0=RefDiodes[15][6-level]/10;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/M=1\cf3 \strokec3  \cf4 \strokec4 Input0;\cf3 \strokec3  \cf4 \strokec4 Pin=V_avg\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "W\cf3 \strokec3  \cf7 \strokec7 cm\\S-2\\M"\cf4 \strokec4 ,Input0;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 Input3\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Jsc\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +ctrlName;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_numpnts=34*t\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 pnts\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 DataWave\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ReadDataWave(V_area,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,V_biasVoltage);\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 transient0\cf3 \strokec3  \cf4 \strokec4 Input1;\cf3 \strokec3  \cf4 \strokec4 Input1/=V_area;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "A\cf3 \strokec3  \cf7 \strokec7 cm\\S-1\\M"\cf4 \strokec4 ,Input1\cf3 \strokec3 				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measures\cf3 \strokec3  \cf2 \strokec2 Jsc\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 while\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Voc\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +ctrlName;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ReadDataWave(V_area,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,V_biasCurrent);\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 transient0\cf3 \strokec3  \cf4 \strokec4 Input9\cf3 \strokec3 	\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,Input9,Input10\cf3 \strokec3 								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measures\cf3 \strokec3  \cf2 \strokec2 Voc\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 while\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_settlingTime=b;\cf3 \strokec3  \cf4 \strokec4 V_delay=2\
\cf3 \strokec3 	\cf4 \strokec4 HysteresisWrapper(ctrlName,level,1)\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 GraphStability\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "GraphStability()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=0/R=ConfigPanel\cf3 \strokec3  \cf4 \strokec4 GraphStability\
\cf3 \strokec3 	\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,1,\cf7 \strokec7 "Open"\cf4 \strokec4 )\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Open\cf3 \strokec3  \cf2 \strokec2 shutter\cf3 \strokec3  \cf2 \strokec2 again\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Jsc\cf3 \strokec3  \cf7 \strokec7 again"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 b=V_settlingTime\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Temporary\cf3 \strokec3  \cf2 \strokec2 store\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_numpnts=34*t;\cf3 \strokec3  \cf4 \strokec4 c=\cf6 \strokec6 round\cf4 \strokec4 (IVparams[a+6][0]/0.002)*0.002\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 pnts\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 DataWave\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ReadDataWave(V_area,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,V_biasVoltage);\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 transient0\cf3 \strokec3  \cf4 \strokec4 Input2;\cf3 \strokec3  \cf4 \strokec4 Input2/=V_area\cf3 \strokec3 												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measures\cf3 \strokec3  \cf2 \strokec2 Jsc\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 while\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "A\cf3 \strokec3  \cf7 \strokec7 cm\\S-1\\M"\cf4 \strokec4 ,Input2\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 again"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 SweepPPT(\cf7 \strokec7 "Current"\cf4 \strokec4 ,c,t+3);\cf3 \strokec3  \cf4 \strokec4 Input4/=V_area;\cf3 \strokec3  \cf4 \strokec4 Input5/=-V_area\cf3 \strokec3 		\cf2 \strokec2 //=(Pin/100/V_area)\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Voc\cf3 \strokec3  \cf7 \strokec7 again"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ReadDataWave(V_area,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,V_biasCurrent);\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 transient0\cf3 \strokec3  \cf4 \strokec4 Input10\cf3 \strokec3 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measures\cf3 \strokec3  \cf2 \strokec2 Voc\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 while\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,1,\cf7 \strokec7 "Close"\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_Henry=0;\cf3 \strokec3  \cf4 \strokec4 V_endVolt=0;\cf3 \strokec3  \cf4 \strokec4 V_supos=-1;\cf3 \strokec3  \cf4 \strokec4 V_delay=0\cf3 \strokec3  \cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 V_settlingTime=b\
\cf3 \strokec3 	\cf4 \strokec4 d_t=\cf6 \strokec6 date\cf4 \strokec4 ()+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 /\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 time\cf4 \strokec4 ();\cf3 \strokec3  \cf4 \strokec4 S_exptType=\cf7 \strokec7 ".pPT"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibtmo=\{sourcemeter,12\}\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 3s\cf3 \strokec3  \cf2 \strokec2 Timeout\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 PPTStability"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 MeasureIPCE(ctrlName,varNum)\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 fixed\cf3 \strokec3  \cf2 \strokec2 Wavelength\cf3 \strokec3  \cf2 \strokec2 540nm\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 ctrlName;\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 varNum\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,PhotoDiode,Voltage,Potential,Thermopile\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_numpnts,V_dataChannel2,corrIPCE=$(\cf7 \strokec7 "V_corrIPCE"\cf4 \strokec4 +ctrlName),ipce=$(\cf7 \strokec7 "V_IPCE"\cf4 \strokec4 +ctrlName)\
\cf3 \strokec3 	\cf4 \strokec4 Filterwheel(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,varNum,ctrlName);\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 2\
\cf3 \strokec3 	\cf4 \strokec4 Shutter(\cf7 \strokec7 ""\cf4 \strokec4 ,2,\cf7 \strokec7 "Open"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "IVGraph()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "AcquireStyle1()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Reference\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf4 \strokec4 ScanRef()\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Measure\cf3 \strokec3  \cf2 \strokec2 Reference\cf3 \strokec3  \cf2 \strokec2 light\cf3 \strokec3  \cf2 \strokec2 Intensity\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Titlebox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Testing\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 Voc"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf4 \strokec4 ScanTest(0)\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 Thermopile,PhotoDiode,Voltage,PhotoCurrent,Potential\
\cf3 \strokec3 	\cf8 \strokec8 Titlebox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 IPCE\cf3 \strokec3  \cf7 \strokec7 Current"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf4 \strokec4 ScanVoltage()\
\cf3 \strokec3 	\cf4 \strokec4 ScanFinish()\
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,$(\cf7 \strokec7 "IPCE"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=(0,0.1)\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\
\cf3 \strokec3 	\cf4 \strokec4 ipce=-(1239.8541*V_avg)/(\cf6 \strokec6 str2num\cf4 \strokec4 (ctrlName)*V_dataChannel2*corrIPCE)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 HysteresisWrapper(ctrlName,level,ssFlag)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 ctrlName;\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 level,ssFlag\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVparams,PhotoCurrent,PhotoCurrent1,PhotoCurrent2,PSUWhiteARD,ScanRates,SettlingTimes,PSUsettings\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos,V_area,V_v0,V_v1,V_biasVoltage,V_complianceI,V_delay,V_incrVolt,V_length,V_settlingTime,V_SSFlag,V_4Wire,V_voltFlag\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,S_ExptType,option3,option5,S_windowname\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,n;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 w1,w2,str,s0=\cf7 \strokec7 "Scan\cf3 \strokec3  \cf7 \strokec7 Rates:\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!ssFlag)\
\cf3 \strokec3 		\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_gain1\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=5;\cf3 \strokec3  \cf4 \strokec4 SetDelay(\cf7 \strokec7 "SettlingTime"\cf4 \strokec4 ,5,\cf7 \strokec7 "40"\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 iv_gain1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ClearGraphs(\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "win:3"\cf4 \strokec4 ))\
\cf3 \strokec3 	\cf4 \strokec4 S_ExptType=\cf7 \strokec7 ".hIV"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 V_supos=0\
\cf3 \strokec3 	\cf4 \strokec4 ScanDirection(\cf7 \strokec7 ""\cf4 \strokec4 ,1,\cf7 \strokec7 ""\cf4 \strokec4 )\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reset\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 default\cf3 \strokec3  \cf2 \strokec2 Sweep:\cf3 \strokec3  \cf2 \strokec2 High\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 Low\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (level<10)\
\cf3 \strokec3 		\cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUsettings[level],4);\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=level;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 filter0\
\cf3 \strokec3 		\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 6\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Allow\cf3 \strokec3  \cf2 \strokec2 time\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 filter\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 get\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 place\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 0.1\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Testing\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 Voc"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_voltFlag)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Flag\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 manual\cf3 \strokec3  \cf2 \strokec2 setting\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 Voltage\cf3 \strokec3  \cf2 \strokec2 sweep\cf3 \strokec3  \cf2 \strokec2 limits\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 ScanSettings()\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Testing\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 Voc"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 ScanTest(level<5)\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_v0));\cf3 \strokec3  \cf4 \strokec4 V_biasVoltage=V_v0\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 Voltage\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf4 \strokec4 allwaves=\cf7 \strokec7 "PhotoCurrentHR_0,PhotoCurrentHF_0"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "IVGraph()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "AcquireStyle1()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ShowInfo\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 IVGraph,\cf7 \strokec7 "Hysteresis"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=textL/J/F=0/A=MC/X=58/Y=0\cf3 \strokec3  \cf4 \strokec4 Legendtext(allwaves,7)\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle=0,rgb(PhotoCurrentHF_0)=(0,65535,0),rgb(PhotoCurrentHR_0)=(65535,0,0)\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "IVGraph"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=16\cf3 \strokec3  \cf4 \strokec4 ScanRates,SettlingTimes\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 ScanRates[n]=V_incrVolt/(V_settlingTime)\
\cf3 \strokec3 		\cf4 \strokec4 SettlingTimes[n]=V_settlingTime\
\cf3 \strokec3 		\cf4 \strokec4 w1=\cf7 \strokec7 "PhotoCurrentHR_"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (n);\cf3 \strokec3  \cf4 \strokec4 w2=\cf7 \strokec7 "PhotoCurrentHF_"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (n)\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (n>0)\
\cf3 \strokec3 			\cf4 \strokec4 allwaves+=\cf7 \strokec7 ","\cf4 \strokec4 +w1+\cf7 \strokec7 ","\cf4 \strokec4 +w2\
\cf3 \strokec3 			\cf8 \strokec8 AppendtoGraph\cf4 \strokec4 /W=IVGraph\cf3 \strokec3  \cf4 \strokec4 $w1,$w2\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 b=Hysteresis()\
\cf3 \strokec3 		\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent1,$w1;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent2,$w2\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "IT:%g;AR:%g;FT:%g;CM:%g;ST:%g;SV:%g;ET:%g"\cf4 \strokec4 ,IVparams[a+1][V_supos],V_area,V_length,V_complianceI,V_settlingTime,V_v0,V_delay;\cf3 \strokec3  \cf8 \strokec8 Note\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 $w1,str\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "IT:%g;AR:%g;FT:%g;CM:%g;ST:%g;SV:%g;ET:%g"\cf4 \strokec4 ,IVparams[a+1][V_supos],V_area,V_length,V_complianceI,V_settlingTime,V_v0,V_delay;\cf3 \strokec3  \cf8 \strokec8 Note\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 $w2,str\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle=0,rgb($w1)=(n*8000,65535,0),rgb($w2)=(65535,n*8000,0)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %.3f\cf3 \strokec3  \cf7 \strokec7 V\cf3 \strokec3  \cf7 \strokec7 s\\S-1\\M\\r\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %.3f\cf3 \strokec3  \cf7 \strokec7 V\cf3 \strokec3  \cf7 \strokec7 s\\S-1\\M\\r"\cf4 \strokec4 ,s0,w1,ScanRates[n],w2,ScanRates[n]\
\cf3 \strokec3 		\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=textL/J/F=0/A=MT/X=58/Y=0\cf3 \strokec3  \cf4 \strokec4 s0\
\cf3 \strokec3 		\cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((n==0)&(V_SSFlag))\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (b>0.025)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 2%\cf3 \strokec3  \cf2 \strokec2 hysteresis\cf3 \strokec3  \cf2 \strokec2 threshold\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ControlInfo\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 iv_gain1\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Value==12)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Bail\cf3 \strokec3  \cf2 \strokec2 out\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 2s\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 iv_gain1\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=V_Value+1;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 iv_gain1;\cf3 \strokec3  \cf8 \strokec8 ControlInfo\cf4 \strokec4 /W=ConfigPanel\cf3 \strokec3  \cf4 \strokec4 iv_gain1\
\cf3 \strokec3 			\cf4 \strokec4 V_settlingTime=\cf6 \strokec6 str2num\cf4 \strokec4 (S_Value)/1e3;\cf3 \strokec3  \cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:CURR:MODE\cf3 \strokec3  \cf7 \strokec7 FIX;:SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_settlingtime))\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<14)\
\cf3 \strokec3 	\cf4 \strokec4 FlushKeithley()\
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,V_complianceI*V_area,\cf6 \strokec6 floor\cf4 \strokec4 (V_min*5e3)/5e3\
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 All\cf3 \strokec3  \cf7 \strokec7 Data"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Hysteresis()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Voltage,PhotoCurrent\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_numpnts,V_v0,V_v1\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,a1,a2\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 Voltage,PhotoCurrent;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf4 \strokec4 /I\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 V_v0,V_v1,\cf7 \strokec7 "V"\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\cf3 \strokec3 														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 -ve\cf3 \strokec3  \cf2 \strokec2 sweep\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Test\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":*CLS"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 ScanVoltage()\
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,PhotoCurrent1;\cf3 \strokec3  \cf4 \strokec4 a1=\cf6 \strokec6 abs\cf4 \strokec4 (\cf6 \strokec6 area\cf4 \strokec4 (PhotoCurrent,0,V_v0))\
\cf3 \strokec3 	\cf4 \strokec4 a=V_v0;\cf3 \strokec3  \cf4 \strokec4 V_v0=V_v1;\cf3 \strokec3  \cf4 \strokec4 V_v1=a\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reverse\cf3 \strokec3  \cf2 \strokec2 sweep\cf3 \strokec3  \cf2 \strokec2 limits\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /I\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 V_v0,V_v1,\cf7 \strokec7 "V"\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 +ve\cf3 \strokec3  \cf2 \strokec2 sweep\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":*CLS"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 ScanVoltage()\
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,PhotoCurrent2;\cf3 \strokec3  \cf4 \strokec4 a2=\cf6 \strokec6 abs\cf4 \strokec4 (\cf6 \strokec6 area\cf4 \strokec4 (PhotoCurrent,0,V_v1))\
\cf3 \strokec3 	\cf4 \strokec4 a=V_v0;\cf3 \strokec3  \cf4 \strokec4 V_v0=V_v1;\cf3 \strokec3  \cf4 \strokec4 V_v1=a\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Reverse\cf3 \strokec3  \cf2 \strokec2 sweep\cf3 \strokec3  \cf2 \strokec2 limits\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 (a1-a2)/a1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ResistanceMethod(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_R2\
\cf3 \strokec3 	\cf9 \strokec9 strswitch\cf3 \strokec3  \cf4 \strokec4 (popStr)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "4-Point"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 re_VdP,\cf9 \strokec9 proc\cf4 \strokec4 =Res4P;\cf3 \strokec3  \cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 re_R1,title=\cf7 \strokec7 "Resistance\cf3 \strokec3  \cf7 \strokec7 4Wire:"\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 V_R2=0\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Only\cf3 \strokec3  \cf2 \strokec2 one\cf3 \strokec3  \cf2 \strokec2 measurement,\cf3 \strokec3  \cf2 \strokec2 so\cf3 \strokec3  \cf2 \strokec2 R90\'b0\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 redundant\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Van\cf3 \strokec3  \cf7 \strokec7 de\cf3 \strokec3  \cf7 \strokec7 Pauw"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 re_VdP,\cf9 \strokec9 proc\cf4 \strokec4 =VdP;\cf3 \strokec3  \cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 re_R1,title=\cf7 \strokec7 "Resistance\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 0\'b0\cf3 \strokec3   \cf7 \strokec7 :"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 VdP(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 fFunction\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_conductivity,V_length,V_R1,V_R2,V_fR1R2,V_CFVdP,V_resultVdP,V_ResRatio\
\cf3 \strokec3 	\cf4 \strokec4 ReadVdPResistance(0)\
\cf3 \strokec3 	\cf4 \strokec4 V_ResRatio=V_R1/V_R2\
\cf3 \strokec3 	\cf4 \strokec4 V_fR1R2=(V_R1-V_R2)/(V_R1+V_R2)\
\cf3 \strokec3 	\cf4 \strokec4 V_CFVdP=1-V_fR1R2^2*\cf6 \strokec6 ln\cf4 \strokec4 (2)/2-V_fR1R2^4*((\cf6 \strokec6 ln\cf4 \strokec4 (2))^2/4-(\cf6 \strokec6 ln\cf4 \strokec4 (2))^3/12)\
\cf3 \strokec3 	\cf4 \strokec4 V_resultVdP=1/SheetResistance(V_R1,V_R2)\
\cf3 \strokec3 	\cf4 \strokec4 V_conductivity=1/(V_resultVdP*V_length)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Sheet\cf3 \strokec3  \cf7 \strokec7 resistance[VdP]"\cf4 \strokec4 ,V_resultVdP,V_CFVdP,\cf7 \strokec7 "Sheet\cf3 \strokec3  \cf7 \strokec7 resistance\cf3 \strokec3  \cf7 \strokec7 [4W]"\cf4 \strokec4 ,4.532*(V_R1+V_R2)/2*V_CFVdP\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SheetResistance(a,b)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n,y,z0,z1=2*\cf6 \strokec6 ln\cf4 \strokec4 (2)/(\cf6 \strokec6 pi\cf4 \strokec4 *(a+b))\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 z0=z1\
\cf3 \strokec3 		\cf4 \strokec4 y=1/\cf6 \strokec6 exp\cf4 \strokec4 (\cf6 \strokec6 pi\cf4 \strokec4 *z0*a)+1/\cf6 \strokec6 exp\cf4 \strokec4 (\cf6 \strokec6 pi\cf4 \strokec4 *z0*b)\
\cf3 \strokec3 		\cf4 \strokec4 z1=z0-((1-y)/\cf6 \strokec6 pi\cf4 \strokec4 )/(a/\cf6 \strokec6 exp\cf4 \strokec4 (\cf6 \strokec6 pi\cf4 \strokec4 *z0*a)+b/\cf6 \strokec6 exp\cf4 \strokec4 (\cf6 \strokec6 pi\cf4 \strokec4 *z0*b))\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 ((z1-z0)/z1>0.0001)\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 z1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 		\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 AnalyzeVdP(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_resultVdP,V_R1,\cf3 \strokec3  \cf4 \strokec4 V_R2,\cf3 \strokec3  \cf4 \strokec4 V_CFVdP\
\cf3 \strokec3 	\cf4 \strokec4 V_resultVdP=1/SheetResistance(V_R1,V_R2)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ReadVdPResistance(flg)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 flg\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Datawave,Resistance0,Resistance90\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_R1,V_R2,sourcemeter\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,n\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(2*100)\cf3 \strokec3  \cf4 \strokec4 Datawave\
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Resistance"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":STAT:MEAS:ENAB\cf3 \strokec3  \cf7 \strokec7 512"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":*SRE\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:ELEM\cf3 \strokec3  \cf7 \strokec7 RES,TIME"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Data\cf3 \strokec3  \cf2 \strokec2 output\cf3 \strokec3  \cf2 \strokec2 format\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 'RES'"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:RES:RANGE:AUTO\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:RSEN\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 4\cf3 \strokec3  \cf2 \strokec2 wire\cf3 \strokec3  \cf2 \strokec2 sense\cf3 \strokec3  \cf2 \strokec2 must\cf3 \strokec3  \cf2 \strokec2 be\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 So\cf3 \strokec3  \cf2 \strokec2 switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf3 \strokec3  \cf2 \strokec2 again\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:CLE"\cf4 \strokec4 )\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Clear\cf3 \strokec3  \cf2 \strokec2 Buffer\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:POIN\cf3 \strokec3  \cf7 \strokec7 100;:TRIG:COUN\cf3 \strokec3  \cf7 \strokec7 100"\cf4 \strokec4 )\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 Triggers\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:FEED:CONT\cf3 \strokec3  \cf7 \strokec7 NEXT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":INIT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\}\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag>63)\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":TRAC:DATA?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinaryWave2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 Datawave;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Resistance0=Datawave[2*p];\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 Resistance0;\cf3 \strokec3  \cf4 \strokec4 V_R1=V_avg\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flg==0)\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 So\cf3 \strokec3  \cf2 \strokec2 switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf3 \strokec3  \cf2 \strokec2 again\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":*CLS"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Standby"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf3 \strokec3  \cf7 \strokec7 "Turn\cf3 \strokec3  \cf7 \strokec7 the\cf3 \strokec3  \cf7 \strokec7 sample\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 90\'b0"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configpanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Measuring\cf3 \strokec3  \cf7 \strokec7 Resistance"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configpanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 So\cf3 \strokec3  \cf2 \strokec2 switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf3 \strokec3  \cf2 \strokec2 again\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":TRIG:COUN\cf3 \strokec3  \cf7 \strokec7 100"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:FEED:CONT\cf3 \strokec3  \cf7 \strokec7 NEXT"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":INIT"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\}\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag>63)\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 n+=1\
\cf3 \strokec3 		\cf9 \strokec9 while\cf4 \strokec4 (1)\
\cf3 \strokec3 		\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":TRAC:DATA?"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinaryWave2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 Datawave;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Resistance90=Datawave[2*p];\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 Resistance90;\cf3 \strokec3  \cf4 \strokec4 V_R2=V_avg\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:RSEN\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 )\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 4\cf3 \strokec3  \cf2 \strokec2 wire\cf3 \strokec3  \cf2 \strokec2 OFF\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ScanFinish()\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Res4P(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 NVar\cf3 \strokec3  \cf4 \strokec4 V_resultVdP,V_R1,V_CFVdP\
\cf3 \strokec3 	\cf4 \strokec4 ReadVdPResistance(1)\
\cf3 \strokec3 	\cf4 \strokec4 V_resultVdP=4.532*V_R1*V_CFVdP\
\cf3 \strokec3 	\cf8 \strokec8 printf\cf3 \strokec3  \cf7 \strokec7 "Sheet\cf3 \strokec3  \cf7 \strokec7 resistance:\cf3 \strokec3  \cf7 \strokec7 %.4g\cf3 \strokec3  \cf7 \strokec7 \uc0\u937 /[],\cf3 \strokec3  \cf7 \strokec7 Measured\cf3 \strokec3  \cf7 \strokec7 resistance\cf3 \strokec3  \cf7 \strokec7 [4W]:\cf3 \strokec3  \cf7 \strokec7 %.4g\cf3 \strokec3  \cf7 \strokec7 \uc0\u937 \\r"\cf4 \strokec4 ,V_resultVdP,V_R1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Profile()\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Use\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 laser\cf3 \strokec3  \cf2 \strokec2 scanning\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 Electrode\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Current\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_DataChannel0,V_DataChannel3,V_numpnts\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_windowname,option5\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 junk,n\
\cf3 \strokec3 	\cf4 \strokec4 V_numpnts=50\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 current\
\cf3 \strokec3 	\cf8 \strokec8 Setscale\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 0,0.254,\cf7 \strokec7 "mm"\cf4 \strokec4 ,current\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 Graph_Profile\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		 \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "Graph_Profile()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:CLE:AUTO\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 0.01"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 10mA\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTPUT:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 10\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 speak("Are\cf3 \strokec3  \cf2 \strokec2 you\cf3 \strokec3  \cf2 \strokec2 ready");\cf3 \strokec3  \cf2 \strokec2 Sleep/S\cf3 \strokec3  \cf2 \strokec2 1\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 		\cf2 \strokec2 speak(num2str(n+1))\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 		\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":READ?"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 GPIBRead2\cf3 \strokec3  \cf4 \strokec4 V_DataChannel3,V_DataChannel0,junk;\cf3 \strokec3  \cf4 \strokec4 current[n]=-V_DataChannel0\
\cf3 \strokec3 		\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 3\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<V_numpnts)\
\cf3 \strokec3 	\cf8 \strokec8 beep\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTPUT:STAT\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:CLE:AUTO\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 S_windowname=\cf7 \strokec7 "Graph_Profile"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 Profile"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 IV(cw,x)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 FitFunc\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 wave\cf3 \strokec3  \cf4 \strokec4 cw;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 x\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_temp\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a=PhotoCurrent(x)*cw[2]\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 iR\cf3 \strokec3  \cf2 \strokec2 term\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 cw[0]-cw[1]*(\cf6 \strokec6 exp\cf4 \strokec4 ((x+a)/cw[3]/0.02567969)-1)\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 q/kT=(1.6021892e-19/1.380662e-23/298)\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 IVshunt(cw,x)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 FitFunc\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Resistive\cf3 \strokec3  \cf2 \strokec2 shunt\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 Series\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 cell\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 wave\cf3 \strokec3  \cf4 \strokec4 cw;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 x\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a=PhotoCurrent(x)*cw[2]\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 iR\cf3 \strokec3  \cf2 \strokec2 term\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 cw[0]-cw[1]*(\cf6 \strokec6 exp\cf4 \strokec4 ((x+a)/cw[3]/0.02567969)-1)+(x+a)/cw[4]\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 DataFit(model,[a])\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Interpolate\cf3 \strokec3  \cf2 \strokec2 data\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 get\cf3 \strokec3  \cf2 \strokec2 equally\cf3 \strokec3  \cf2 \strokec2 spaced\cf3 \strokec3  \cf2 \strokec2 points\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 model;\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 cw\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_complianceI,V_FitError,V_FitTol,V_FitMaxIters\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,S_Value,S_windowname,option31,option32,option5\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 wname,hold\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 ParamIsDefault\cf4 \strokec4 (a))\
\cf3 \strokec3 		\cf9 \strokec9 Prompt\cf3 \strokec3   \cf4 \strokec4 a,\cf3 \strokec3  \cf7 \strokec7 "Select\cf3 \strokec3  \cf7 \strokec7 CellCurrent\cf3 \strokec3  \cf7 \strokec7 wave\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 fitting"\cf4 \strokec4 ,popup,WaveChoice(allwaves,0)\
\cf3 \strokec3 		\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 Current"\cf4 \strokec4 ,a\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag)\
\cf3 \strokec3 			\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 a-=1\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Count\cf3 \strokec3  \cf2 \strokec2 from\cf3 \strokec3  \cf2 \strokec2 zero\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 S_Value=\cf6 \strokec6 StringFromList\cf4 \strokec4 (a,WaveChoice(allwaves,0));\cf3 \strokec3  \cf4 \strokec4 wname=\cf6 \strokec6 StringFromList\cf4 \strokec4 (a,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$wname\
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 w,PhotoCurrent,fitting,residual\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ","\cf4 \strokec4 ,\cf7 \strokec7 "win:IVGraph"\cf4 \strokec4 ),\cf7 \strokec7 "fitting"\cf4 \strokec4 ,0)<0)\
\cf3 \strokec3 		\cf8 \strokec8 AppendtoGraph\cf4 \strokec4 /L=left\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,fitting;\cf3 \strokec3  \cf8 \strokec8 AppendtoGraph\cf4 \strokec4 /L=resid\cf3 \strokec3  \cf4 \strokec4 residual\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 axisEnab(left)=\{0,0.78\},axisEnab(resid)=\{0.8,1\},freePos(Resid)=0\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 mirror(resid)=2,zero(resid)=1,lblPos(resid)=56\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 mode(residual)=2,lsize(residual)=2,mode($wname)=2,lsize($wname)=2\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 rgb(fitting)=(0,0,65535)\
\cf3 \strokec3 		\cf8 \strokec8 Label\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 resid\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Residuals"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Cursor\cf3 \strokec3  \cf4 \strokec4 A,$wname,0;\cf3 \strokec3  \cf8 \strokec8 Cursor\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 B,$wname,\cf6 \strokec6 round\cf4 \strokec4 (\cf6 \strokec6 BinarySearchInterp\cf4 \strokec4 ($wname,0)-2)\
\cf3 \strokec3 		\cf8 \strokec8 ShowInfo\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "TableFitParams()"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=0/R=ConfigPanel\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Cursor\cf4 \strokec4 /W=IVGraph\cf3 \strokec3  \cf4 \strokec4 A,PhotoCurrent,\cf6 \strokec6 leftx\cf4 \strokec4 (PhotoCurrent);\cf3 \strokec3  \cf8 \strokec8 Cursor\cf4 \strokec4 /W=IVGraph\cf3 \strokec3  \cf4 \strokec4 B,PhotoCurrent,\cf6 \strokec6 rightx\cf4 \strokec4 (PhotoCurrent)\
\cf3 \strokec3 	\cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 w\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 abs\cf4 \strokec4 (V_min)<V_max)\
\cf3 \strokec3 		\cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,V_max/4,V_min\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,\cf6 \strokec6 min\cf4 \strokec4 (V_complianceI*V_area,-V_min/2),V_min\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_FitError=0\
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 w,PhotoCurrent,PhotoCurrentIR,residual,fitting,weight;\cf3 \strokec3  \cf4 \strokec4 residual=0\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 Cmpstr\cf4 \strokec4 (\cf7 \strokec7 "IV"\cf4 \strokec4 ,model)==0)\
\cf3 \strokec3 		\cf4 \strokec4 hold=\cf7 \strokec7 "1001"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(4)\cf3 \strokec3  \cf4 \strokec4 cw;\cf3 \strokec3  \cf4 \strokec4 cw[0]=PhotoCurrent(0);\cf3 \strokec3  \cf4 \strokec4 cw[1]=cw[0]/1e8;\cf3 \strokec3  \cf4 \strokec4 cw[2]=-15*\cf6 \strokec6 sqrt\cf4 \strokec4 (V_area);\cf3 \strokec3  \cf4 \strokec4 cw[3]=1.8\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 Cmpstr\cf4 \strokec4 (\cf7 \strokec7 "DarkCurrent"\cf4 \strokec4 ,wname)==0)\
\cf3 \strokec3 			\cf4 \strokec4 hold=\cf7 \strokec7 "1011"\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 cw[0]=PhotoCurrent(0);\cf3 \strokec3  \cf4 \strokec4 cw[1]=cw[0]/1e2;\cf3 \strokec3  \cf4 \strokec4 cw[2]=-8\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 hold=\cf7 \strokec7 "00001"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(5)\cf3 \strokec3  \cf4 \strokec4 cw;\cf3 \strokec3  \cf4 \strokec4 cw[4]=1e6\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (cw[3]>2.5)\
\cf3 \strokec3 			\cf4 \strokec4 cw[3]=2.4\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_FitTol=0.0001;\cf3 \strokec3  \cf4 \strokec4 V_FitMaxIters=32\
\cf3 \strokec3 	\cf8 \strokec8 FuncFit\cf4 \strokec4 /Q/H=hold\cf3 \strokec3  \cf4 \strokec4 $model\cf3 \strokec3  \cf4 \strokec4 cw\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent(\cf6 \strokec6 xcsr\cf4 \strokec4 (A),\cf6 \strokec6 xcsr\cf4 \strokec4 (B))/D=fitting/R=residual\
\cf3 \strokec3 	\cf4 \strokec4 V_FitMaxIters=256\
\cf3 \strokec3 	\cf8 \strokec8 FuncFit\cf4 \strokec4 /Q/M=2/N\cf3 \strokec3  \cf4 \strokec4 $model\cf3 \strokec3  \cf4 \strokec4 cw\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent(\cf6 \strokec6 xcsr\cf4 \strokec4 (A),\cf6 \strokec6 xcsr\cf4 \strokec4 (B))/D=fitting/R=residual\
\cf3 \strokec3 	\cf4 \strokec4 weight=1/PhotoCurrent;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "IVGraph"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=[\cf6 \strokec6 pcsr\cf4 \strokec4 (A),\cf6 \strokec6 pcsr\cf4 \strokec4 (B)]\cf3 \strokec3  \cf4 \strokec4 residual;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 resid\cf3 \strokec3  \cf4 \strokec4 V_min,V_max\
\cf3 \strokec3 	\cf4 \strokec4 option31=\cf7 \strokec7 "IV+Shunt"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Data"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TruePhotoCurrent()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 DarkCurrent,PhotoCurrent0,PhotoCurrent1,PhotoCurrent2,PhotoCurrent3,PhotoCurrent4,PhotoCurrent5\
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 DarkCurrent,TruePCurr1,TruePCurr2,TruePCurr3,TruePCurr4,TruePCurr5\
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=(0,0.1)\cf3 \strokec3  \cf4 \strokec4 Darkcurrent\
\cf3 \strokec3 	\cf4 \strokec4 TruePCurr1=PhotoCurrent1(x)-DarkCurrent(x)+V_avg;\cf3 \strokec3  \cf4 \strokec4 TruePCurr2=PhotoCurrent2(x)-DarkCurrent(x)+V_avg\
\cf3 \strokec3 	\cf4 \strokec4 TruePCurr3=PhotoCurrent3(x)-DarkCurrent(x)+V_avg;\cf3 \strokec3  \cf4 \strokec4 TruePCurr4=PhotoCurrent4(x)-DarkCurrent(x)+V_avg\
\cf3 \strokec3 	\cf4 \strokec4 TruePCurr5=PhotoCurrent5(x)-DarkCurrent(x)+V_avg\
\cf3 \strokec3 	\cf8 \strokec8 DoWIndow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ","\cf4 \strokec4 ,\cf7 \strokec7 "win:IVGraph"\cf4 \strokec4 ),\cf7 \strokec7 "TruePCurr"\cf4 \strokec4 ,0)<0)\
\cf3 \strokec3 		\cf8 \strokec8 AppendToGraph\cf3 \strokec3  \cf4 \strokec4 TruePCurr1,TruePCurr2,TruePCurr3,TruePCurr4,TruePCurr5\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 rgb(TruePCurr1)=(0,0,0),rgb(TruePCurr2)=(0,0,0),rgb(TruePCurr3)=(0,0,0),rgb(TruePCurr4)=(0,0,0),rgb(TruePCurr5)=(0,0,0)\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lsize(TruePCurr1)=2,lsize(TruePCurr2)=2,lsize(TruePCurr3)=2,lsize(TruePCurr4)=2,lsize(TruePCurr5)=2\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 RadiantPower()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 W_coef,ChargeDensity,Jsc,VDecay\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_beta,eCharge,V_length,V_porosity\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_layoutname\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 s0\
\cf3 \strokec3 	\cf4 \strokec4 S_layoutname=\cf7 \strokec7 "layout4()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_beta=VocvsIo()\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Save\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 fit\cf3 \strokec3  \cf2 \strokec2 parameter\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_beta)\
\cf3 \strokec3 		\cf8 \strokec8 beep\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Abort\cf3 \strokec3  \cf7 \strokec7 "Not\cf3 \strokec3  \cf7 \strokec7 enough\cf3 \strokec3  \cf7 \strokec7 data\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 Radiant\cf3 \strokec3  \cf7 \strokec7 Plot.\cf3 \strokec3  \cf7 \strokec7 Require\cf3 \strokec3  \cf7 \strokec7 at\cf3 \strokec3  \cf7 \strokec7 least\cf3 \strokec3  \cf7 \strokec7 3\cf3 \strokec3  \cf7 \strokec7 intensities!"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 PowerPlot\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "PowerPlot()"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "LnPowerPlot()"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "FfPlot()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel\cf3 \strokec3  \cf4 \strokec4 PowerPlot\
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=0/R=PowerPlot\cf3 \strokec3  \cf4 \strokec4 LnPowerPlot\
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=0/R=LnPowerPlot\cf3 \strokec3  \cf4 \strokec4 FfPlot\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "Intercept:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (W_coef[0])+\cf7 \strokec7 "\\rSlope:\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (W_coef[1]*1e3)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mV"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text0/F=0/A=MC/W=LnPowerPlot/X=0/Y=-25\cf3 \strokec3  \cf4 \strokec4 s0\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 DataExtract()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 InputText\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Expt_parameters,Input0,Input1,Input2,Input3,Input4,Input5,Input6,Input7\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos\
\cf3 \strokec3 	\cf4 \strokec4 ClearGraphs(\cf6 \strokec6 RemoveFromList\cf4 \strokec4 (\cf7 \strokec7 "IVGraph"\cf4 \strokec4 ,\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "WIN:1"\cf4 \strokec4 )))\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Clear\cf3 \strokec3  \cf2 \strokec2 Graphs\cf3 \strokec3  \cf2 \strokec2 prior\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 new\cf3 \strokec3  \cf2 \strokec2 display\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(-1,V_supos+2)\cf3 \strokec3  \cf4 \strokec4 Expt_parameters\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_supos)\cf3 \strokec3  \cf4 \strokec4 InputText,Input0,Input1,Input2,Input3,Input4,Input5,Input6,Input7\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 0,1,\cf7 \strokec7 ""\cf4 \strokec4 ,Input0,Input1,Input2,Input3,Input4,Input5,Input6,Input7;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "hour"\cf4 \strokec4 ,Input0;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,Input2\
\cf3 \strokec3 	\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "Files()"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 StabilityResults(b)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 b\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Input0,Input0,Input1,Input2,Input3,Input4,Input5,Input6,Input7\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_windowname,option5,option6\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 Table1\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "Table1()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=0/R=ConfigPanel\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (b)\
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 BarGraph\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 			\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "BarGraph()"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "BarGraph"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Sort\cf3 \strokec3  \cf4 \strokec4 Input0,Input0,Input1,Input2,Input3,Input4,Input5,Input6,Input7\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Sort\cf3 \strokec3  \cf2 \strokec2 data\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 ascending\cf3 \strokec3  \cf2 \strokec2 time\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 CellStability\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 			\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "CellStability()"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_windowname=\cf7 \strokec7 "CellStability"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ControlBar\cf3 \strokec3  \cf4 \strokec4 21\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 display1,pos=\{460,0\},size=\{144,18\},\cf9 \strokec9 proc\cf4 \strokec4 =GraphStyle,mode=1,value=#\cf7 \strokec7 "\\"Overlay;Staggered\\""\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Cursor\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 A,Input1,2\
\cf3 \strokec3 			\cf8 \strokec8 Showinfo\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 Results"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option6=\cf7 \strokec7 "Print\cf3 \strokec3  \cf7 \strokec7 &\cf3 \strokec3  \cf7 \strokec7 Save"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Files()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Panel\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 NewPanel\cf4 \strokec4 /K=2/W=(84,251,644,600)\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Selected\cf3 \strokec3  \cf7 \strokec7 File\cf3 \strokec3  \cf7 \strokec7 List"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyPanel\cf3 \strokec3  \cf4 \strokec4 cbRGB=(65535,54611,49151)\
\cf3 \strokec3 	\cf8 \strokec8 ListBox\cf3 \strokec3  \cf4 \strokec4 lb0,pos=\{8,8\},size=\{544,320\},frame=2,listWave=Expt_parameters,selWave=rjack,colorWave=myColors,mode=4,editStyle=1,row=V_modeFile,widths=\{112\}\
\cf3 \strokec3 	\cf4 \strokec4 FileColours()\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 FileColours()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 Expt_parameters\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 rjack\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(\cf6 \strokec6 DimSize\cf4 \strokec4 (Expt_parameters,0),-1,3)\cf3 \strokec3  \cf4 \strokec4 rjack\
\cf3 \strokec3 	\cf8 \strokec8 SetDimLabel\cf3 \strokec3  \cf4 \strokec4 2,1,foreColors,rjack;\cf3 \strokec3  \cf8 \strokec8 SetDimLabel\cf3 \strokec3  \cf4 \strokec4 2,2,backColors,rjack\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Colour\cf3 \strokec3  \cf2 \strokec2 determined\cf3 \strokec3  \cf2 \strokec2 by\cf3 \strokec3  \cf2 \strokec2 DimLabel\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 rjack[][][1]=3;\cf3 \strokec3  \cf4 \strokec4 rjack[][][2]=1\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 colours\cf3 \strokec3  \cf2 \strokec2 from\cf3 \strokec3  \cf2 \strokec2 ColourWave\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetFile()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 w=Expt_parameters,InputText\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 rjack,Input0,Input1,Input2,Input3,Input4,Input5,Input6,Input7\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allspectra,S_xaxisLabel,S_yaxisLabel\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a,b,i;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf4 \strokec4 Input0=TranslateDate(w[9][p+1]);\cf3 \strokec3  \cf4 \strokec4 a=Input0[0];\cf3 \strokec3  \cf4 \strokec4 Input0=(Input0[p]-a)/60/60\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Convert\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 hours\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 allspectra=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 for\cf4 \strokec4 (i=1;\cf3 \strokec3  \cf4 \strokec4 i<20;\cf3 \strokec3  \cf4 \strokec4 i+=1)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 blanks\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (rjack[i][0][0]>0)\
\cf3 \strokec3 				\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (i)\
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Dye\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 3:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Additional\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 4:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Electrolyte\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 5:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Semiconductor\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 6:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 WE\cf3 \strokec3  \cf2 \strokec2 Glass\cf4 \strokec4 \
\cf3 \strokec3 						\cf4 \strokec4 b=1;\cf3 \strokec3  \cf4 \strokec4 InputText=w[i][p+1];\cf3 \strokec3  \cf4 \strokec4 S_yaxisLabel=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 						\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 12:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Isc\cf3 \strokec3  \cf2 \strokec2 -\cf3 \strokec3  \cf2 \strokec2 bit:0001\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 13:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Jsc\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 15:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Ipmax\cf4 \strokec4 \
\cf3 \strokec3 						\cf4 \strokec4 allspectra+=\cf7 \strokec7 "Input1;"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 Input1=-\cf6 \strokec6 str2num\cf4 \strokec4 (w[i][p+1])/1e3\
\cf3 \strokec3 						\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "A"\cf4 \strokec4 ,Input1;\cf3 \strokec3  \cf4 \strokec4 S_yaxisLabel=\cf7 \strokec7 "Current\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 						\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 11:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Uoc\cf3 \strokec3  \cf2 \strokec2 -\cf3 \strokec3  \cf2 \strokec2 bit:0010\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 14:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Upmax\cf4 \strokec4 \
\cf3 \strokec3 						\cf4 \strokec4 allspectra+=\cf7 \strokec7 "Input2;"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 Input2=\cf6 \strokec6 str2num\cf4 \strokec4 (w[i][p+1])\
\cf3 \strokec3 						\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,Input2;\cf3 \strokec3  \cf4 \strokec4 S_yaxisLabel=\cf7 \strokec7 "Potential\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 						\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 16:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fillfactor\cf3 \strokec3  \cf2 \strokec2 -\cf3 \strokec3  \cf2 \strokec2 bit:0100\cf4 \strokec4 \
\cf3 \strokec3 						\cf4 \strokec4 allspectra+=\cf7 \strokec7 "Input4;"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 Input4=\cf6 \strokec6 str2num\cf4 \strokec4 (w[i][p+1])*500/\cf6 \strokec6 str2num\cf4 \strokec4 (w[10][p+1])\
\cf3 \strokec3 						\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "W"\cf4 \strokec4 ,Input4;\cf3 \strokec3  \cf4 \strokec4 S_yaxisLabel=\cf7 \strokec7 "Power\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 						\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 17:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 PowerOut\cf3 \strokec3  \cf2 \strokec2 -\cf3 \strokec3  \cf2 \strokec2 bit:1000\cf4 \strokec4 \
\cf3 \strokec3 						\cf4 \strokec4 allspectra+=\cf7 \strokec7 "Input3;"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 Input3=\cf6 \strokec6 str2num\cf4 \strokec4 (w[i][p+1])\
\cf3 \strokec3 						\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 ""\cf4 \strokec4 ,Input3;\cf3 \strokec3  \cf4 \strokec4 S_yaxisLabel=\cf7 \strokec7 "Fill\cf3 \strokec3  \cf7 \strokec7 Factor"\cf4 \strokec4 \
\cf3 \strokec3 						\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 18:\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 PowerOut\cf3 \strokec3  \cf2 \strokec2 -\cf3 \strokec3  \cf2 \strokec2 bit:1000\cf4 \strokec4 \
\cf3 \strokec3 						\cf4 \strokec4 allspectra+=\cf7 \strokec7 "Input5;"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 Input5=\cf6 \strokec6 str2num\cf4 \strokec4 (w[i][p+1])*100/\cf6 \strokec6 str2num\cf4 \strokec4 (w[10][p+1])\
\cf3 \strokec3 						\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "%"\cf4 \strokec4 ,Input5;\cf3 \strokec3  \cf4 \strokec4 S_yaxisLabel=\cf7 \strokec7 "Efficiency\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 						\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 cmpstr\cf4 \strokec4 (allspectra,\cf7 \strokec7 ""\cf4 \strokec4 ))\
\cf3 \strokec3 			\cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf7 \strokec7 "You\cf3 \strokec3  \cf7 \strokec7 must\cf3 \strokec3  \cf7 \strokec7 select\cf3 \strokec3  \cf7 \strokec7 at\cf3 \strokec3  \cf7 \strokec7 least\cf3 \strokec3  \cf7 \strokec7 one\cf3 \strokec3  \cf7 \strokec7 parameter\cf3 \strokec3  \cf7 \strokec7 cell"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag==-1)\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 cmpstr\cf4 \strokec4 (allspectra,\cf7 \strokec7 ""\cf4 \strokec4 ))\
\cf3 \strokec3 	\cf4 \strokec4 allspectra=\cf6 \strokec6 sortlist\cf4 \strokec4 (allspectra)\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 ItemsinList\cf4 \strokec4 (allspectra)==1)\
\cf3 \strokec3 		\cf4 \strokec4 Extract4Bar(allspectra[0,\cf6 \strokec6 strlen\cf4 \strokec4 (allspectra)-2])\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (b==0)\
\cf3 \strokec3 			\cf4 \strokec4 InputText=\cf6 \strokec6 num2str\cf4 \strokec4 (Input0[p]);\cf3 \strokec3  \cf4 \strokec4 S_xaxisLabel=\cf7 \strokec7 "Time\cf3 \strokec3  \cf7 \strokec7 [h]"\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 b=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 StabilityResults(b)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Extract4Bar(s)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVparams\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,allspectra\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 flg,n=\cf6 \strokec6 str2num\cf4 \strokec4 (s[5]),n1,npt;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 str,list=\cf7 \strokec7 "Input1;Input2;Input3;Input4;Input5;Input6;Input7"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 n1=3*(n==2)+4*(n==1)+5*(n==3)+6*(n==4)\
\cf3 \strokec3 	\cf4 \strokec4 n=0;\cf3 \strokec3  \cf4 \strokec4 allspectra=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 str=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 npt=\cf6 \strokec6 str2num\cf4 \strokec4 (str[12,\cf6 \strokec6 strlen\cf4 \strokec4 (str)])-1\
\cf3 \strokec3 		\cf4 \strokec4 flg=\cf6 \strokec6 cmpstr\cf4 \strokec4 (str,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flg)\
\cf3 \strokec3 			\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$\cf6 \strokec6 StringFromList\cf4 \strokec4 (npt,list)\
\cf3 \strokec3 			\cf4 \strokec4 w=\cf6 \strokec6 abs\cf4 \strokec4 (IVparams[12*npt+n1][p])\
\cf3 \strokec3 			\cf4 \strokec4 allspectra+=\cf6 \strokec6 StringFromList\cf4 \strokec4 (npt,list)+\cf7 \strokec7 ";"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (flg)\
\cf3 \strokec3 	\cf4 \strokec4 allspectra=\cf6 \strokec6 sortList\cf4 \strokec4 (allspectra,\cf7 \strokec7 ";"\cf4 \strokec4 ,1)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 VocvsIo()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Voc,RadPower,LRadPower,Jsc\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 cw=W_coef\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves\
\cf3 \strokec3 	\cf4 \strokec4 allwaves=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "PhotoCurrent*"\cf4 \strokec4 ,\cf7 \strokec7 ","\cf4 \strokec4 ,\cf7 \strokec7 "WIN:IVGraph"\cf4 \strokec4 ),\cf7 \strokec7 ","\cf4 \strokec4 ,16)\
\cf3 \strokec3 	\cf4 \strokec4 SummariseData()\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 ItemsInList\cf4 \strokec4 (allwaves,\cf7 \strokec7 ","\cf4 \strokec4 )<3)\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf6 \strokec6 NaN\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 LRadPower=\cf6 \strokec6 ln\cf4 \strokec4 (RadPower)\
\cf3 \strokec3 	\cf8 \strokec8 CurveFit\cf4 \strokec4 /Q/N\cf3 \strokec3  \cf4 \strokec4 line\cf3 \strokec3  \cf4 \strokec4 Jsc/X=RadPower/D\
\cf3 \strokec3 	\cf8 \strokec8 CurveFit\cf4 \strokec4 /Q/N\cf3 \strokec3  \cf4 \strokec4 line\cf3 \strokec3  \cf4 \strokec4 Voc/X=LRadPower/R\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 cw[1]\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ClearGraphs(list)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 list\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n,flg;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 windowname\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 List\cf3 \strokec3  \cf2 \strokec2 all\cf3 \strokec3  \cf2 \strokec2 tables\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 graphs\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 windowname=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,list,\cf7 \strokec7 ";"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf4 \strokec4 flg=\cf6 \strokec6 cmpstr\cf4 \strokec4 (windowname,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flg)\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 CmpStr\cf4 \strokec4 (windowname,\cf7 \strokec7 "PhotoResponse"\cf4 \strokec4 ))\
\cf3 \strokec3 				\cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 $windowname\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (flg)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Specs(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 option5\
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s=\cf6 \strokec6 CleanupName\cf4 \strokec4 (option5,0)+\cf7 \strokec7 "()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 s\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 yScale(ctrlName,popNum,varStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Voltage\cf3 \strokec3  \cf2 \strokec2 Scale\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,varStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves\
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 str,str1;\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 i\
\cf3 \strokec3 	\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (popNum)\
\cf3 \strokec3 	\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\
\cf3 \strokec3 		\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<\cf6 \strokec6 ItemsinList\cf4 \strokec4 (allwaves,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 			\cf4 \strokec4 str=\cf6 \strokec6 StringfromList\cf4 \strokec4 (i,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 str1=\cf7 \strokec7 "TruePCurr"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (i)\
\cf3 \strokec3 			\cf8 \strokec8 AppendtoGraph\cf3 \strokec3  \cf4 \strokec4 $str;\cf3 \strokec3  \cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lStyle($str)=i\
\cf3 \strokec3 			\cf8 \strokec8 RemovefromGraph\cf3 \strokec3  \cf4 \strokec4 $str1\
\cf3 \strokec3 		\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf6 \strokec6 log\cf4 \strokec4 (left)=0\
\cf3 \strokec3 		\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\
\cf3 \strokec3 		\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<\cf6 \strokec6 ItemsinList\cf4 \strokec4 (allwaves,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 			\cf4 \strokec4 str=\cf6 \strokec6 StringfromList\cf4 \strokec4 (i,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 str1=\cf7 \strokec7 "TruePCurr"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (i)\
\cf3 \strokec3 			\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$str;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 w,$str1\
\cf3 \strokec3 			\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w1=$str1\
\cf3 \strokec3 			\cf4 \strokec4 w1=\cf6 \strokec6 abs\cf4 \strokec4 (w)\
\cf3 \strokec3 			\cf8 \strokec8 AppendtoGraph\cf3 \strokec3  \cf4 \strokec4 $str1;\cf3 \strokec3  \cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lStyle($str1)=i\
\cf3 \strokec3 			\cf8 \strokec8 RemovefromGraph\cf3 \strokec3  \cf4 \strokec4 $str\
\cf3 \strokec3 		\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf6 \strokec6 log\cf4 \strokec4 (left)=1\
\cf3 \strokec3 		\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SummariseData()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Jsc,Voc,Ff,RadPower,LRadPower,IVparams\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_PeakLoc,V_supos\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,flag,n,npt;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf4 \strokec4 allwaves=\cf6 \strokec6 RemoveFromList\cf4 \strokec4 (\cf7 \strokec7 "DarkCurrent,PhotoCurrent"\cf4 \strokec4 ,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 )\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Block\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 Dark\cf3 \strokec3  \cf2 \strokec2 Current\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(\cf6 \strokec6 ItemsInList\cf4 \strokec4 (allwaves,\cf7 \strokec7 ","\cf4 \strokec4 ))\cf3 \strokec3  \cf4 \strokec4 Jsc,Voc,Ff,RadPower,LRadPower\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 str=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 npt=\cf6 \strokec6 str2num\cf4 \strokec4 (str[\cf6 \strokec6 strlen\cf4 \strokec4 (str)-1,\cf6 \strokec6 strlen\cf4 \strokec4 (str)-1])\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (str,\cf7 \strokec7 "_"\cf4 \strokec4 ,0)>2)\
\cf3 \strokec3 			\cf4 \strokec4 str=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,str,\cf7 \strokec7 "_"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 flag=\cf6 \strokec6 CmpStr\cf4 \strokec4 (str,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flag)\
\cf3 \strokec3 			\cf4 \strokec4 a=IV_Params(str,V_supos)\
\cf3 \strokec3 			\cf4 \strokec4 Jsc[n]=-IVparams[12*npt+5][V_supos]\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Process\cf3 \strokec3  \cf2 \strokec2 intensity\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Voc[n]=IVparams[12*npt+3][V_supos]\
\cf3 \strokec3 			\cf4 \strokec4 Ff[n]=IVparams[12*npt+10][V_supos]\
\cf3 \strokec3 			\cf4 \strokec4 RadPower[n]=IVparams[12*npt+1][V_supos]\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((n==0)&((V_supos)==0))\
\cf3 \strokec3 				\cf4 \strokec4 str=\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (str)\
\cf3 \strokec3 				\cf8 \strokec8 Tag\cf4 \strokec4 /C/N=text16/F=0/X=16/Y=0\cf3 \strokec3  \cf4 \strokec4 $str,a,\cf7 \strokec7 "Max\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Pt."\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf4 \strokec4 (1)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 IV_Params(current,n)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 current;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 s=current[\cf6 \strokec6 strlen\cf4 \strokec4 (current)-1,\cf6 \strokec6 strlen\cf4 \strokec4 (current)-1],s0,s1;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=12*\cf6 \strokec6 str2num\cf4 \strokec4 (s)\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVParams,Photocurrent=$current,\cf3 \strokec3  \cf4 \strokec4 Power=$(\cf7 \strokec7 "Power"\cf4 \strokec4 +s)\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos,V_area,V_Jsc,V_Jpp,V_voc,V_Vpp,V_ff,V_pwr\
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 Photocurrent,$(\cf7 \strokec7 "Power"\cf4 \strokec4 +s);\cf3 \strokec3  \cf4 \strokec4 Power*=x;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "W"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 $(\cf7 \strokec7 "Power"\cf4 \strokec4 +s)\
\cf3 \strokec3 	\cf4 \strokec4 IVparams[a+4][n]=Photocurrent(0)\cf3 \strokec3  	  					 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Short\cf3 \strokec3  \cf2 \strokec2 circuit\cf3 \strokec3  \cf2 \strokec2 current\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 IVparams[a+5][n]=IVparams[a+4][n]/V_area\cf3 \strokec3 			 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Isc/cm2\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 FindLevel\cf4 \strokec4 /Q/B=3\cf3 \strokec3  \cf4 \strokec4 Photocurrent,0\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 IVparams[a+3][n]=\cf6 \strokec6 pnt2x\cf4 \strokec4 (Photocurrent,\cf6 \strokec6 numpnts\cf4 \strokec4 (Photocurrent)-1)\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 IVparams[a+3][n]=V_LevelX\cf3 \strokec3      											 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Open\cf3 \strokec3  \cf2 \strokec2 circuit\cf3 \strokec3  \cf2 \strokec2 Voltage\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 FindPeak\cf4 \strokec4 /Q/B=11/M=-5e-8/N\cf3 \strokec3  \cf4 \strokec4 $(\cf7 \strokec7 "Power"\cf4 \strokec4 +s)\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 threshold\cf3 \strokec3  \cf2 \strokec2 @\cf3 \strokec3  \cf2 \strokec2 0.1\'b5W\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 beep\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 IVparams[a+6][n]=V_PeakLoc;\cf3 \strokec3  \cf4 \strokec4 IVparams[a+7][n]=\cf6 \strokec6 pnt2x\cf4 \strokec4 (Photocurrent,\cf6 \strokec6 numpnts\cf4 \strokec4 (Photocurrent)-1)\cf3 \strokec3 												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Upmax\cf3 \strokec3  \cf2 \strokec2 &\cf3 \strokec3  \cf2 \strokec2 Ipmax\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 IVparams[a+6][n]=V_PeakLoc;\cf3 \strokec3  \cf4 \strokec4 IVparams[a+7][n]=Photocurrent(V_PeakLoc)\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Upmax\cf3 \strokec3  \cf2 \strokec2 &\cf3 \strokec3  \cf2 \strokec2 Ipmax\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 IVparams[a+8][n]=IVparams[a+7][n]/V_area\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Ipmax/cm2\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 IVparams[a+9][n]=\cf6 \strokec6 abs\cf4 \strokec4 (Power(V_PeakLoc))/V_area\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Power\cf3 \strokec3  \cf2 \strokec2 out\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 IVparams[a+10][n]=IVparams[a+7][n]*V_PeakLoc/(IVparams[a+4][n]*IVparams[a+3][n])\cf3 \strokec3 														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fill\cf3 \strokec3  \cf2 \strokec2 factor\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_Jsc=IVparams[a+5][n];\cf3 \strokec3  \cf4 \strokec4 V_voc=IVparams[a+3][n];\cf3 \strokec3  \cf4 \strokec4 V_ff=100*IVparams[a+10][n];\cf3 \strokec3  \cf4 \strokec4 V_pwr=IVparams[a+9][n];\cf3 \strokec3  \cf4 \strokec4 V_Jpp=IVparams[a+8][n];\cf3 \strokec3  \cf4 \strokec4 V_Vpp=IVparams[a+6][n]\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_supos<1)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "Tag/W=IVGraph/C/N=text%d/B=1/F=0/L=0/X=0/Y=-0.5\cf3 \strokec3  \cf7 \strokec7 %s,%g,%s"\cf4 \strokec4 ,a/12,current,V_PeakLoc,\cf7 \strokec7 "\\"\\Z18\'95\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s1,\cf7 \strokec7 "%.2f"\cf4 \strokec4 ,1e3*IVparams[a+1][n]\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s1,\cf7 \strokec7 "Tag/W=IVGraph/C/N=text%d/F=0/L=0/X=0/Y=0\cf3 \strokec3  \cf7 \strokec7 %s,%g,%s"\cf4 \strokec4 ,a/12+10,current,0.1,\cf7 \strokec7 "\\""\cf4 \strokec4 +s1+\cf7 \strokec7 "%\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 s0;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 s1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 V_PeakLoc\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Cell_Area()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 RefDiodes\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_numcell,V_incrVolt,V_refNum,V_RefCalibration,V_currentRef\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=V_area,b=V_numCell,e=V_refNum+1\
\cf3 \strokec3 	\cf9 \strokec9 Prompt\cf3 \strokec3   \cf4 \strokec4 a,\cf3 \strokec3  \cf7 \strokec7 "Photoactive\cf3 \strokec3  \cf7 \strokec7 Area\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Test\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 [cm2]?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 Prompt\cf3 \strokec3   \cf4 \strokec4 b,\cf3 \strokec3  \cf7 \strokec7 "#\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Cells\cf3 \strokec3  \cf7 \strokec7 in\cf3 \strokec3  \cf7 \strokec7 Module\cf3 \strokec3  \cf7 \strokec7 (max.\cf3 \strokec3  \cf7 \strokec7 140)?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 Prompt\cf3 \strokec3   \cf4 \strokec4 e,\cf3 \strokec3  \cf7 \strokec7 "Select\cf3 \strokec3  \cf7 \strokec7 Standard\cf3 \strokec3  \cf7 \strokec7 Si\cf3 \strokec3  \cf7 \strokec7 Reference\cf3 \strokec3  \cf7 \strokec7 diode"\cf4 \strokec4 ,popup,\cf7 \strokec7 "Ref\cf3 \strokec3  \cf7 \strokec7 Cell#0;Ref\cf3 \strokec3  \cf7 \strokec7 Cell#1;Ref\cf3 \strokec3  \cf7 \strokec7 Cell#2;Ref\cf3 \strokec3  \cf7 \strokec7 Cell#3;Ref\cf3 \strokec3  \cf7 \strokec7 Cell#4;Ref\cf3 \strokec3  \cf7 \strokec7 Cell#5;Ref\cf3 \strokec3  \cf7 \strokec7 Cell#6;Ref\cf3 \strokec3  \cf7 \strokec7 Cell#7;Ref\cf3 \strokec3  \cf7 \strokec7 Cell#8;Default\cf3 \strokec3  \cf7 \strokec7 Ref#9;Udo\cf3 \strokec3  \cf7 \strokec7 Ref#10"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "Optical\cf3 \strokec3  \cf7 \strokec7 Specifications"\cf4 \strokec4 ,a,b\
\cf3 \strokec3 	\cf4 \strokec4 V_area=a;\cf3 \strokec3  \cf4 \strokec4 V_numCell=\cf6 \strokec6 round\cf4 \strokec4 (b);\cf3 \strokec3  \cf4 \strokec4 V_refNum=e-1\
\cf3 \strokec3 	\cf4 \strokec4 V_incrVolt=5e-3;\cf3 \strokec3  \cf4 \strokec4 a=2\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (b>1)\
\cf3 \strokec3 		\cf4 \strokec4 V_incrVolt=1e-2;\cf3 \strokec3  \cf4 \strokec4 a=3\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (b>2)\
\cf3 \strokec3 		\cf4 \strokec4 V_incrVolt=2e-2;\cf3 \strokec3  \cf4 \strokec4 a=4\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (b>4)\
\cf3 \strokec3 		\cf4 \strokec4 V_incrVolt=5e-2;\cf3 \strokec3  \cf4 \strokec4 a=5\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Popupmenu\cf3 \strokec3  \cf4 \strokec4 iv_incr\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=a\
\cf3 \strokec3 	\cf4 \strokec4 V_RefCalibration=V_currentRef\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Default\cf3 \strokec3  \cf2 \strokec2 value\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 offset\cf3 \strokec3  \cf2 \strokec2 Ref\cf3 \strokec3  \cf2 \strokec2 Diode#3\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (e==11)\
\cf3 \strokec3 		\cf4 \strokec4 V_RefCalibration=0.1/RefDiodes[10][6]\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Filename()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_run\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_ExptType,S_number,S_cellname\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a=\cf6 \strokec6 strlen\cf4 \strokec4 (S_cellname)\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (a<2)\
\cf3 \strokec3 		\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s\
\cf3 \strokec3 		\cf9 \strokec9 prompt\cf3 \strokec3  \cf4 \strokec4 s,\cf7 \strokec7 "Enter\cf3 \strokec3  \cf7 \strokec7 a\cf3 \strokec3  \cf7 \strokec7 root\cf3 \strokec3  \cf7 \strokec7 name\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 the\cf3 \strokec3  \cf7 \strokec7 current\cf3 \strokec3  \cf7 \strokec7 Experimental\cf3 \strokec3  \cf7 \strokec7 series.\cf3 \strokec3  \cf7 \strokec7 ie\cf3 \strokec3  \cf7 \strokec7 'marie'"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "File\cf3 \strokec3  \cf7 \strokec7 Root\cf3 \strokec3  \cf7 \strokec7 Name"\cf4 \strokec4 ,s\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 S_cellname=s\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 S_number=S_cellname+\cf7 \strokec7 "_"\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()[5,\cf6 \strokec6 strlen\cf4 \strokec4 (\cf6 \strokec6 Date\cf4 \strokec4 ())-1]\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_run<10)\
\cf3 \strokec3 		\cf4 \strokec4 S_number+=\cf7 \strokec7 "#0"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_run)\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 S_number+=\cf7 \strokec7 "#"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_run)\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 S_number+=S_ExptType\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 waves2save()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 n,gotfile;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s0,s1,s2,s3=\cf7 \strokec7 ""\cf4 \strokec4 ,windowname\
\cf3 \strokec3 	\cf4 \strokec4 s0=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "win:3"\cf4 \strokec4 ))\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 list\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 Graphs\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 windowname=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,s0)\
\cf3 \strokec3 		\cf9 \strokec9 strswitch\cf4 \strokec4 (windowname)\
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "IVGraph"\cf4 \strokec4 :\
\cf3 \strokec3 				\cf4 \strokec4 s1=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "*current*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "win:"\cf4 \strokec4 +windowname),\cf7 \strokec7 ";"\cf4 \strokec4 ,16)\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 all\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 waves\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 s2=\cf6 \strokec6 ListMatch\cf4 \strokec4 (s1,\cf7 \strokec7 "!fit*"\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 s3+=\cf6 \strokec6 ListMatch\cf4 \strokec4 (s2,\cf7 \strokec7 "!res*"\cf4 \strokec4 )\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "GraphPPT"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "GraphIV"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "GraphHysteresis"\cf4 \strokec4 :\
\cf3 \strokec3 				\cf4 \strokec4 s1=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "win:"\cf4 \strokec4 +windowname),\cf7 \strokec7 ";"\cf4 \strokec4 ,16)\
\cf3 \strokec3 				\cf4 \strokec4 s2=\cf6 \strokec6 RemoveFromList\cf4 \strokec4 (s1,s3);\cf3 \strokec3  \cf4 \strokec4 s3=s2+s1\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "GraphStability"\cf4 \strokec4 :\
\cf3 \strokec3 				\cf4 \strokec4 s1=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "win:"\cf4 \strokec4 +windowname),\cf7 \strokec7 ";"\cf4 \strokec4 ,16)\
\cf3 \strokec3 				\cf4 \strokec4 s2=\cf6 \strokec6 RemoveFromList\cf4 \strokec4 (s1,s3);\cf3 \strokec3  \cf4 \strokec4 s3=s2+s1\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "RecombinationRates"\cf4 \strokec4 :\
\cf3 \strokec3 				\cf4 \strokec4 s1=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "win:"\cf4 \strokec4 +windowname),\cf7 \strokec7 ";"\cf4 \strokec4 ,16)\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 duplicates,\cf3 \strokec3  \cf2 \strokec2 remove\cf3 \strokec3  \cf2 \strokec2 them\cf3 \strokec3  \cf2 \strokec2 all\cf3 \strokec3  \cf2 \strokec2 first\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 s2=\cf6 \strokec6 RemoveFromList\cf4 \strokec4 (s1,s3);\cf3 \strokec3  \cf4 \strokec4 s3=s2+s1+\cf7 \strokec7 "cw;"\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 duplicates,\cf3 \strokec3  \cf2 \strokec2 remove\cf3 \strokec3  \cf2 \strokec2 them\cf3 \strokec3  \cf2 \strokec2 all\cf3 \strokec3  \cf2 \strokec2 first\cf3 \strokec3  \cf2 \strokec2 then\cf3 \strokec3  \cf2 \strokec2 add\cf3 \strokec3  \cf2 \strokec2 them\cf3 \strokec3  \cf2 \strokec2 in\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "GraphTau"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "TransientCGraph"\cf4 \strokec4 :\
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "TransientVGraph"\cf4 \strokec4 :\
\cf3 \strokec3 				\cf4 \strokec4 s1=\cf7 \strokec7 "transient0;"\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 s2=\cf6 \strokec6 RemoveFromList\cf4 \strokec4 (s1,s3);\cf3 \strokec3  \cf4 \strokec4 s3=s2+s1\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf4 \strokec4 (n<\cf6 \strokec6 ItemsinList\cf4 \strokec4 (s0))\
\cf3 \strokec3 	\cf4 \strokec4 s2=\cf6 \strokec6 ListMatch\cf4 \strokec4 (s3,\cf7 \strokec7 "!fit*"\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 s3=\cf6 \strokec6 ListMatch\cf4 \strokec4 (s2,\cf7 \strokec7 "!res*"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 s3\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 PrintSave(prtFlag)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 prtFlag\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos,V_loadFlag,PDFflag,hyteresisFlag\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,S_ExptType,S_Filename,S_layoutname,S_warning,S_windowname,option4,option5,option6,option8,option9\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n,gotfile;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str,windowname=\cf6 \strokec6 WinName\cf4 \strokec4 (0,4)\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (PDFflag)\
\cf3 \strokec3 		\cf8 \strokec8 SavePICT\cf4 \strokec4 /P=PDFpath/E=-2/B=72\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf6 \strokec6 ParseFilePath\cf4 \strokec4 (3,S_Filename,\cf7 \strokec7 ":"\cf4 \strokec4 ,0,0)+\cf7 \strokec7 ".pdf"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (prtFlag)\
\cf3 \strokec3 			\cf8 \strokec8 PrintLayout\cf4 \strokec4 /D\cf3 \strokec3  \cf4 \strokec4 $windowname\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 $windowname\
\cf3 \strokec3 	\cf4 \strokec4 allwaves=\cf6 \strokec6 SortList\cf4 \strokec4 (waves2save(),\cf7 \strokec7 ";"\cf4 \strokec4 ,16)\
\cf3 \strokec3 	\cf4 \strokec4 ClearGraphs(\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "win:3"\cf4 \strokec4 ))\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 all\cf3 \strokec3  \cf2 \strokec2 graphs,\cf3 \strokec3  \cf2 \strokec2 tables\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 not\cf3 \strokec3  \cf2 \strokec2 panels\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_supos>0)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 If\cf3 \strokec3  \cf2 \strokec2 Appended,\cf3 \strokec3  \cf2 \strokec2 then\cf3 \strokec3  \cf2 \strokec2 kill\cf3 \strokec3  \cf2 \strokec2 waves\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 windowname=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,allwaves)\
\cf3 \strokec3 			\cf4 \strokec4 Gotfile=\cf6 \strokec6 CmpStr\cf4 \strokec4 (windowname,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (GotFile)\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 				\cf2 \strokec2 KillWaves\cf3 \strokec3  \cf2 \strokec2 $PossiblyQuoteName(windowname)\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 n+=1\
\cf3 \strokec3 		\cf9 \strokec9 while\cf4 \strokec4 (GotFile)\
\cf3 \strokec3 		\cf9 \strokec9 strswitch\cf3 \strokec3  \cf4 \strokec4 (S_layoutname)\
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Layout5()"\cf4 \strokec4 :\
\cf3 \strokec3 				\cf4 \strokec4 SaveExtractedData()\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Data\cf3 \strokec3  \cf2 \strokec2 Extraction\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_loadFlag<1)\
\cf3 \strokec3 		\cf9 \strokec9 strswitch\cf3 \strokec3  \cf4 \strokec4 (S_layoutname)\
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 "Layout7()"\cf4 \strokec4 :\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Charge\cf3 \strokec3  \cf2 \strokec2 Extraction\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 allwaves=\cf7 \strokec7 "transient1;transient2;Peak_Capacitance;Voc;ywave;xwave"\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "SaveIVData()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_supos=-1;\cf3 \strokec3  \cf4 \strokec4 V_loadFlag=0;\cf3 \strokec3  \cf4 \strokec4 hyteresisFlag=0;\cf3 \strokec3  \cf4 \strokec4 S_layoutname=\cf7 \strokec7 "Layout1()"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 allwaves=\cf7 \strokec7 "PhotoCurrent0"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 S_warning=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (allwaves,\cf7 \strokec7 ",fitting"\cf4 \strokec4 ,0)>0)\
\cf3 \strokec3 		\cf4 \strokec4 allwaves=allwaves[0,\cf6 \strokec6 strsearch\cf4 \strokec4 (allwaves,\cf7 \strokec7 ",fitting"\cf4 \strokec4 ,0)]\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_layout,disable=2\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Disable\cf3 \strokec3  \cf2 \strokec2 Layouts\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 S_ExptType=\cf7 \strokec7 ".sIV"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option4=\cf7 \strokec7 "(Data\cf3 \strokec3  \cf7 \strokec7 Extract"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "(Layout..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option6=\cf7 \strokec7 "(Print\cf3 \strokec3  \cf7 \strokec7 &\cf3 \strokec3  \cf7 \strokec7 Save"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option8=\cf7 \strokec7 "(Append\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option9=\cf7 \strokec7 "(Save..."\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TestRoutines()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_PTTDuration\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 option5\
\cf3 \strokec3 	\cf4 \strokec4 User(\cf7 \strokec7 ""\cf4 \strokec4 ,5,\cf7 \strokec7 "Reference\cf3 \strokec3  \cf7 \strokec7 Cell"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Celltest(\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 PPT(\cf7 \strokec7 "Current"\cf4 \strokec4 ,1)\
\cf3 \strokec3 	\cf4 \strokec4 PPTStability(\cf7 \strokec7 "Current"\cf4 \strokec4 ,1)\
\cf3 \strokec3 	\cf4 \strokec4 V_PTTDuration=16;\cf3 \strokec3  \cf4 \strokec4 TimeDependenceWrapper(\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,\cf7 \strokec7 "CURR"\cf4 \strokec4 ,\cf7 \strokec7 "VOLT"\cf4 \strokec4 ,0)\
\cf3 \strokec3 	\cf4 \strokec4 option5=\cf7 \strokec7 "(Layout..."\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 ///////////////////////////////////////////////////\cf3 \strokec3  \cf2 \strokec2 FILE\cf3 \strokec3  \cf2 \strokec2 I/O\cf3 \strokec3  \cf2 \strokec2 ////////////////////////////////////////////////////\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Proc\cf3 \strokec3  \cf4 \strokec4 SaveIVData()\cf3 \strokec3        				    																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Store\cf3 \strokec3  \cf2 \strokec2 selected\cf3 \strokec3  \cf2 \strokec2 data\cf3 \strokec3  \cf2 \strokec2 wave\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 Igor\cf3 \strokec3  \cf2 \strokec2 ascii\cf3 \strokec3  \cf2 \strokec2 format\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf4 \strokec4 V_run+=1\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 file;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf4 \strokec4 Gotfile=\cf6 \strokec6 CmpStr\cf4 \strokec4 (S_Filename,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3   \cf4 \strokec4 (Gotfile)\
\cf3 \strokec3 		\cf8 \strokec8 Save\cf4 \strokec4 /B/T/P=DataPath\cf3 \strokec3  \cf4 \strokec4 allwaves\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf4 \strokec4 S_Filename\
\cf3 \strokec3 		\cf8 \strokec8 Open\cf4 \strokec4 /P=DataPath/A\cf3 \strokec3  \cf4 \strokec4 file\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf4 \strokec4 S_Filename\
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 d_t=\\""\cf4 \strokec4 +d_t+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_cellname=\\""\cf4 \strokec4 +S_cellName+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_type=\\""\cf4 \strokec4 +S_type+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_temp=\\""\cf4 \strokec4 +S_temp+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_dye=\\""\cf4 \strokec4 +S_dye+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_electrolyte=\\""\cf4 \strokec4 +S_electrolyte+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_layer=\\""\cf4 \strokec4 +S_layer+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_WE=\\""\cf4 \strokec4 +S_WE+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_CE=\\""\cf4 \strokec4 +S_CE+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_specification=\\""\cf4 \strokec4 +S_specification+S_warning+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 V_length="\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_length)\
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 V_porosity="\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_porosity)\
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 V_numCell="\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numCell)\
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 V_ipce550="\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_ipce550)\
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 V_ipce700="\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_ipce700)\
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_Calibrationfile=\\""\cf4 \strokec4 +S_Calibrationfile+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\r"\cf4 \strokec4 ,\cf7 \strokec7 "X\cf3 \strokec3  \cf7 \strokec7 S_Username=\\""\cf4 \strokec4 +S_Username+\cf7 \strokec7 "\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Close\cf3 \strokec3  \cf4 \strokec4 file\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SaveExtractedData()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Input0,Input1,Input2,Input3,Input4,Input5,Input6\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 InputText\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 GotFile\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Filename\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 filename=S_Filename[0,\cf6 \strokec6 strsearch\cf4 \strokec4 (S_Filename,\cf7 \strokec7 "_"\cf4 \strokec4 ,0)-1]\
\cf3 \strokec3 	\cf4 \strokec4 Gotfile=\cf6 \strokec6 CmpStr\cf4 \strokec4 (filename,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (Gotfile)\
\cf3 \strokec3 		\cf8 \strokec8 Save\cf4 \strokec4 /B/T/P=DataPath\cf3 \strokec3  \cf7 \strokec7 "InputText;Input0;Input1;Input2;Input3;Input4;Input5"\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf4 \strokec4 filename\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 LoadIVData()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVparams\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos,V_loadFlag,V_voltFlag,V_area,V_complianceI,V_RefCalibration,V_settlingTime\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,allspectra,S_Filename1,option3,option31,option5\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n,n1,flg;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 fileName=\cf6 \strokec6 StringfromList\cf4 \strokec4 (0,allspectra),str\
\cf3 \strokec3 	\cf8 \strokec8 LoadWave\cf4 \strokec4 /Q/O/T/P=DataPath\cf3 \strokec3  \cf4 \strokec4 fileName\
\cf3 \strokec3 	\cf4 \strokec4 allwaves=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 ListMatch\cf4 \strokec4 (S_WaveNames,\cf7 \strokec7 "PhotoCurrent*"\cf4 \strokec4 ),\cf7 \strokec7 ";"\cf4 \strokec4 ,16)+\cf7 \strokec7 "DarkCurrent"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 S_Filename1=\cf6 \strokec6 ParseFilePath\cf4 \strokec4 (3,S_Filename,\cf7 \strokec7 ":"\cf4 \strokec4 ,0,0)\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 str=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,allwaves)\
\cf3 \strokec3 		\cf4 \strokec4 flg=\cf6 \strokec6 CmpStr\cf4 \strokec4 (str,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flg)\
\cf3 \strokec3 			\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent=$str\
\cf3 \strokec3 			\cf4 \strokec4 n1=\cf6 \strokec6 str2num\cf4 \strokec4 (str[12,\cf6 \strokec6 strlen\cf4 \strokec4 (str)-1]);\cf3 \strokec3  \cf4 \strokec4 n1=\cf6 \strokec6 numtype\cf4 \strokec4 (n1)?13:\cf3 \strokec3  \cf4 \strokec4 n1\
\cf3 \strokec3 			\cf4 \strokec4 IVparams[12*n1+1][V_supos]=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "IT"\cf4 \strokec4 ,\cf6 \strokec6 ReplaceString\cf4 \strokec4 (\cf7 \strokec7 "\\r"\cf4 \strokec4 ,\cf8 \strokec8 note\cf4 \strokec4 (PhotoCurrent),\cf7 \strokec7 ";"\cf4 \strokec4 )))\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (flg)\
\cf3 \strokec3 	\cf4 \strokec4 V_voltFlag=(\cf6 \strokec6 leftx\cf4 \strokec4 ($\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves))>1)\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 extended\cf3 \strokec3  \cf2 \strokec2 scan\cf3 \strokec3  \cf2 \strokec2 data\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 IVparams[0,;12][V_supos]=IVparams[p+1][V_supos]/V_RefCalibration\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Update\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 Ref.Cell\cf3 \strokec3  \cf2 \strokec2 currents\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_area=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "AR"\cf4 \strokec4 ,\cf8 \strokec8 note\cf4 \strokec4 ($\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves))));\cf3 \strokec3  \cf4 \strokec4 V_settlingTime=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "ST"\cf4 \strokec4 ,\cf8 \strokec8 note\cf4 \strokec4 ($\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves))))\
\cf3 \strokec3 	\cf4 \strokec4 V_complianceI=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "CM"\cf4 \strokec4 ,\cf8 \strokec8 note\cf4 \strokec4 ($\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves))))\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 TransientCGraph\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "TransientCGraph()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 RemoveFromGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 transient2_INT\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 mirror(left)=2\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 TransientData(\cf7 \strokec7 "Current"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strlen\cf4 \strokec4 (allwaves)==0)\
\cf3 \strokec3 		\cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf7 \strokec7 "No\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 data\cf3 \strokec3  \cf7 \strokec7 in\cf3 \strokec3  \cf7 \strokec7 File"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Abort\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 allwaves=\cf6 \strokec6 ReplaceString\cf4 \strokec4 (\cf7 \strokec7 ";"\cf4 \strokec4 ,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "IVGraph()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=IVGraph\cf3 \strokec3  \cf4 \strokec4 TransientCGraph\
\cf3 \strokec3 	\cf4 \strokec4 SummariseData()\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 GetAxis\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,\cf6 \strokec6 min\cf4 \strokec4 (V_complianceI*V_area,-V_max/2),V_max\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_voltFlag)\
\cf3 \strokec3 		\cf8 \strokec8 ControlBar\cf3 \strokec3  \cf4 \strokec4 20\
\cf3 \strokec3 		\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 yDisp,pos=\{480,0\},size=\{76,16\},\cf9 \strokec9 proc\cf4 \strokec4 =yScale,title=\cf7 \strokec7 "y-Axis"\cf4 \strokec4 ,mode=1,value=#\cf7 \strokec7 "\\"Default;log(Magnitude)\\""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_supos=0;\cf3 \strokec3   \cf4 \strokec4 V_loadFlag=1\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 ConfigPanel;\cf3 \strokec3  \cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,value=4;\cf3 \strokec3  \cf4 \strokec4 tabPanels(\cf7 \strokec7 "tab0"\cf4 \strokec4 ,4)\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 Specs\cf3 \strokec3  \cf2 \strokec2 page\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option31=\cf7 \strokec7 "IV+Shunt("\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 All\cf3 \strokec3  \cf7 \strokec7 Data"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 AppendIVData()\cf3 \strokec3 			     											     																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Load\cf3 \strokec3  \cf2 \strokec2 data\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 append\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 graph\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 cw,IVparams,Input0,Input1,Input2,Input4,Input5,Input6\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 Expt_parameters,InputText\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_complianceI,V_dataType,V_settlingTime,V_supos,V_PowerIn1,V_PowerIn2,V_PowerIn3,V_PowerIn4,V_PowerIn5\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allspectra,allwaves,S_Filename1,S_channel,option4,S_YdataName\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,n,nfiles;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 filelist,str,Filename\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_supos==0)\
\cf3 \strokec3 		\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(-1,16)\cf3 \strokec3  \cf4 \strokec4 Expt_parameters,IVparams\
\cf3 \strokec3 		\cf4 \strokec4 SelectDataSet();\cf3 \strokec3  \cf4 \strokec4 loadparams()\
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "RemoveFromGraph/W=IVGraph/Z\cf3 \strokec3  \cf7 \strokec7 %s,DarkCurrent"\cf4 \strokec4 ,S_YdataName;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 axisEnab(power)=\{0,0.4\},axisEnab(left)=\{0.4,0.8\},grid=2,mirror=2,freePos(power)=0,lblPos(power)=52,zero(power)=1\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle(power1)=0,lstyle(power4)=2,lstyle(power3)=3,lstyle(power2)=4\
\cf3 \strokec3 		\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 GetAxis\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,\cf6 \strokec6 min\cf4 \strokec4 (V_complianceI*V_area,-V_max/2),V_max\
\cf3 \strokec3 		\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 power\
\cf3 \strokec3 		\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 power\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Power\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 RemoveFromGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 transient0,transient1,transient2,transient3,transient4,transient5,transient6,ywav\
\cf3 \strokec3 		\cf4 \strokec4 filelist=FileSelection();\cf3 \strokec3  \cf4 \strokec4 n=1\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Do\cf3 \strokec3  \cf2 \strokec2 not\cf3 \strokec3  \cf2 \strokec2 need\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 repeat\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 frst\cf3 \strokec3  \cf2 \strokec2 file\cf3 \strokec3  \cf2 \strokec2 data\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 InputText[V_supos]=S_Filename1;\cf3 \strokec3  \cf4 \strokec4 Input0[V_supos]=IVparams[b+11][V_supos];\cf3 \strokec3  \cf4 \strokec4 Input1[V_supos]=IVparams[b+3][V_supos];\cf3 \strokec3  \cf4 \strokec4 Input2[V_supos]=IVparams[b+4][V_supos];\cf3 \strokec3  \cf4 \strokec4 Input4[V_supos]=IVparams[b+9][V_supos];\cf3 \strokec3  \cf4 \strokec4 Input5[V_supos]=IVparams[b+10][V_supos];\cf3 \strokec3  \cf4 \strokec4 Input6[V_supos]=cw[2]\
\cf3 \strokec3 		\cf4 \strokec4 filelist=FileSelection();\cf3 \strokec3  \cf4 \strokec4 n=1;\cf3 \strokec3  \cf4 \strokec4 V_supos=n\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strlen\cf4 \strokec4 (filelist)>0)\
\cf3 \strokec3 		\cf4 \strokec4 nfiles=\cf6 \strokec6 itemsInList\cf4 \strokec4 (filelist)\
\cf3 \strokec3 		\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(nfiles)\cf3 \strokec3  \cf4 \strokec4 InputText,Input0,Input1,Input2,Input4,Input5,Input6;\cf3 \strokec3  \cf8 \strokec8 Redimension\cf4 \strokec4 /N=(-1,nfiles)\cf3 \strokec3  \cf4 \strokec4 Expt_parameters,IVparams\cf3 \strokec3 					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Redimension\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 files\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "m"\cf4 \strokec4 ,Input0;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "V"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 Input1;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "A"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 Input2;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "%"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 Input4;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "%"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 Input5;\cf3 \strokec3  \cf8 \strokec8 SetScale\cf3 \strokec3  \cf4 \strokec4 d\cf3 \strokec3  \cf4 \strokec4 0,0,\cf7 \strokec7 "\uc0\u937 "\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 Input6\
\cf3 \strokec3 		\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Filename=\cf6 \strokec6 StringfromList\cf4 \strokec4 (n,filelist)\cf3 \strokec3 	\cf2 \strokec2 //;\cf3 \strokec3  \cf2 \strokec2 print\cf3 \strokec3  \cf2 \strokec2 n,V_supos,Filename\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 LoadWave\cf4 \strokec4 /Q/O/T/P=DataPath\cf3 \strokec3  \cf4 \strokec4 Filename\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 FindListItem\cf4 \strokec4 (S_YdataName,S_WaveNames)>-1)\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Ensure\cf3 \strokec3  \cf2 \strokec2 that\cf3 \strokec3  \cf2 \strokec2 S_YdataName\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 present\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 file\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 S_Filename1=\cf6 \strokec6 ParseFilePath\cf4 \strokec4 (3,S_Filename,\cf7 \strokec7 ":"\cf4 \strokec4 ,0,0)\
\cf3 \strokec3 				\cf4 \strokec4 SelectDataSet(a=V_dataType);\cf3 \strokec3  \cf4 \strokec4 loadparams();\cf3 \strokec3  \cf4 \strokec4 b=12*(\cf6 \strokec6 floor\cf4 \strokec4 ((V_dataType-1)/2))\
\cf3 \strokec3 				\cf4 \strokec4 InputText[V_supos]=Filename\
\cf3 \strokec3 				\cf4 \strokec4 Input0[V_supos]=IVparams[b+11][V_supos]\
\cf3 \strokec3 				\cf4 \strokec4 Input1[V_supos]=IVparams[b+3][V_supos]\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Voc\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 Input2[V_supos]=IVparams[b+4][V_supos]\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Isc\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 Input4[V_supos]=IVparams[b+9][V_supos]\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Efficiency\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 Input5[V_supos]=IVparams[b+10][V_supos]\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fill\cf3 \strokec3  \cf2 \strokec2 Factor\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Efficiency\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 Fill\cf3 \strokec3  \cf2 \strokec2 Factor\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 Input6[V_supos]=cw[2]\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Series\cf3 \strokec3  \cf2 \strokec2 Resisitance\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Efficiency\cf3 \strokec3  \cf2 \strokec2 and\cf3 \strokec3  \cf2 \strokec2 Fill\cf3 \strokec3  \cf2 \strokec2 Factor\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 V_supos+=1\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 n+=1\
\cf3 \strokec3 		\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<nfiles)\
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 TableOutputParams\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_flag)\
\cf3 \strokec3 			\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "TableOutputParams()"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=0/R=IVDataLists0\cf3 \strokec3  \cf4 \strokec4 TableOutputParams\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Filename=\cf6 \strokec6 StringfromList\cf4 \strokec4 (V_supos,allspectra)\
\cf3 \strokec3 		\cf8 \strokec8 LoadWave\cf4 \strokec4 /Q/O/T/P=DataPath\cf3 \strokec3  \cf4 \strokec4 Filename\
\cf3 \strokec3 		\cf4 \strokec4 S_Filename1=\cf6 \strokec6 ParseFilePath\cf4 \strokec4 (3,S_Filename,\cf7 \strokec7 ":"\cf4 \strokec4 ,0,0)\
\cf3 \strokec3 		\cf4 \strokec4 IVparams[1][V_supos]=V_PowerIn1;\cf3 \strokec3  \cf4 \strokec4 IVparams[13][V_supos]=V_PowerIn2;\cf3 \strokec3  \cf4 \strokec4 IVparams[25][V_supos]=V_PowerIn3;\cf3 \strokec3  \cf4 \strokec4 IVparams[37][V_supos]=V_PowerIn4;\cf3 \strokec3  \cf4 \strokec4 IVparams[49][V_supos]=V_PowerIn5\
\cf3 \strokec3 		\cf4 \strokec4 V_area=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "AR"\cf4 \strokec4 ,\cf8 \strokec8 note\cf4 \strokec4 ($\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 ))));\cf3 \strokec3  \cf4 \strokec4 V_settlingTime=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "ST"\cf4 \strokec4 ,\cf8 \strokec8 note\cf4 \strokec4 ($\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 ))))\
\cf3 \strokec3 		\cf4 \strokec4 V_complianceI=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "CM"\cf4 \strokec4 ,\cf8 \strokec8 note\cf4 \strokec4 ($\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 ))))\
\cf3 \strokec3 		\cf4 \strokec4 SelectDataSet(a=V_dataType);\cf3 \strokec3  \cf4 \strokec4 loadparams()\
\cf3 \strokec3 		\cf4 \strokec4 V_supos+=1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 LoadPPTData()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 ScanRates,transient0,transient2,ywav\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos,V_loadFlag\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allspectra,allwaves,option3,option31,option5,S_windowName\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 bias,n,n1,flag;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 fileName=\cf6 \strokec6 StringfromList\cf4 \strokec4 (0,allspectra),s0=\cf7 \strokec7 "Scan\cf3 \strokec3  \cf7 \strokec7 Rates"\cf4 \strokec4 ,str,w1,w2\
\cf3 \strokec3 	\cf4 \strokec4 V_supos=0;\cf3 \strokec3   \cf4 \strokec4 V_loadFlag=1\
\cf3 \strokec3 	\cf8 \strokec8 LoadWave\cf4 \strokec4 /Q/O/T/P=DataPath\cf3 \strokec3  \cf4 \strokec4 fileName\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag>4)\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 If\cf3 \strokec3  \cf2 \strokec2 number\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 waves\cf3 \strokec3  \cf2 \strokec2 >\cf3 \strokec3  \cf2 \strokec2 4,\cf3 \strokec3  \cf2 \strokec2 then\cf3 \strokec3  \cf2 \strokec2 Peak\cf3 \strokec3  \cf2 \strokec2 Power\cf3 \strokec3  \cf2 \strokec2 Stability\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 			\cf4 \strokec4 w1=\cf7 \strokec7 "PhotoCurrentH"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (2*n);\cf3 \strokec3  \cf4 \strokec4 w2=\cf7 \strokec7 "PhotoCurrentH"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (2*n+1);\cf3 \strokec3  \cf4 \strokec4 allwaves=w1+\cf7 \strokec7 ","\cf4 \strokec4 +w2;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "IVGraph()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "AcquireStyle1()"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ShowInfo\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 DoWindow\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 IVGraph,\cf7 \strokec7 "Hysteresis"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=textL/J/F=0/A=MC/X=58/Y=0\cf3 \strokec3  \cf4 \strokec4 Legendtext(allwaves,7)\
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle=0,rgb(PhotoCurrentH0)=(0,65535,0),rgb(PhotoCurrentH1)=(65535,0,0)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s\\r\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %.3f\cf3 \strokec3  \cf7 \strokec7 V\cf3 \strokec3  \cf7 \strokec7 s\\S-1\\M\\r\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %.3f\cf3 \strokec3  \cf7 \strokec7 V\cf3 \strokec3  \cf7 \strokec7 s\\S-1\\M"\cf4 \strokec4 ,s0,w1,ScanRates[n],w2,ScanRates[n]\
\cf3 \strokec3 			\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=textL/J/F=0/A=MT/X=58/Y=0\cf3 \strokec3  \cf4 \strokec4 s0\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel\
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 GraphStability\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 			\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "GraphStability()"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=0/R=ConfigPanel\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (S_WaveNames,\cf7 \strokec7 "transient0"\cf4 \strokec4 ,0)>-1)\
\cf3 \strokec3 			\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 TrasientVGraph\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 				\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "TransientVGraph()"\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 rgb(transient0)=(65535,0,0),margin(left)=54,margin(right)=80,mirror(left)=1;\cf3 \strokec3  \cf4 \strokec4 S_windowName=\cf7 \strokec7 "TransientVGraph"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel\
\cf3 \strokec3 			\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$\cf7 \strokec7 "transient0"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 w;\cf3 \strokec3  \cf4 \strokec4 ywav=V_avg\cf3 \strokec3 	\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 bias=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "BI"\cf4 \strokec4 ,\cf8 \strokec8 note\cf4 \strokec4 (transient0)))\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "\\Z10Bias\cf3 \strokec3  \cf7 \strokec7 Current:\cf3 \strokec3  \cf7 \strokec7 %.2W0PA\\rVoltage\cf3 \strokec3  \cf7 \strokec7 average:\cf3 \strokec3  \cf7 \strokec7 %.2W0PA\\rRMS\cf3 \strokec3  \cf7 \strokec7 Noise:\cf3 \strokec3  \cf7 \strokec7 %g"\cf4 \strokec4 ,bias,V_avg,100*V_sdev/V_avg;\cf3 \strokec3  \cf8 \strokec8 TextBox\cf4 \strokec4 /C/N=text0/F=0/A=LT/X=88/Y=4\cf3 \strokec3  \cf4 \strokec4 s0\
\cf3 \strokec3 		\cf9 \strokec9 elseif\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strsearch\cf4 \strokec4 (S_WaveNames,\cf7 \strokec7 "transient2"\cf4 \strokec4 ,0)>-1)\
\cf3 \strokec3 			\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 TrasientCGraph\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 				\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "TransientCGraph()"\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 RemoveFromGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 transient0,transient1,transient3,transient4,transient5,transient6\
\cf3 \strokec3 				\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 rgb(transient2)=(65535,0,0),margin(left)=54,margin(right)=80,mirror(left)=1;\cf3 \strokec3  \cf4 \strokec4 S_windowName=\cf7 \strokec7 "TransientCGraph"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel\
\cf3 \strokec3 			\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$\cf7 \strokec7 "transient2"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 w;\cf3 \strokec3  \cf4 \strokec4 ywav=V_avg;\cf3 \strokec3  \cf4 \strokec4 bias=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "BI"\cf4 \strokec4 ,\cf8 \strokec8 note\cf4 \strokec4 (transient2)))\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "\\Z10Bias\cf3 \strokec3  \cf7 \strokec7 Voltage\cf3 \strokec3  \cf7 \strokec7 %.2W0PA\\rCurrent\cf3 \strokec3  \cf7 \strokec7 average:\cf3 \strokec3  \cf7 \strokec7 %.2W0PA\\rRMS\cf3 \strokec3  \cf7 \strokec7 Noise:\cf3 \strokec3  \cf7 \strokec7 %g"\cf4 \strokec4 ,bias,V_avg,100*V_sdev/V_avg;\cf3 \strokec3  \cf8 \strokec8 TextBox\cf4 \strokec4 /C/N=text0/F=0/A=LT/X=88/Y=4\cf3 \strokec3  \cf4 \strokec4 s0\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 GraphPPT\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 				\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "GraphPPT()"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=ConfigPanel\
\cf3 \strokec3 			\cf8 \strokec8 DoWIndow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 GraphIV\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 				\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "GraphIV()"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=1/R=GraphPPT\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 ConfigPanel;\cf3 \strokec3  \cf8 \strokec8 TabControl\cf3 \strokec3  \cf4 \strokec4 tab0,value=4;\cf3 \strokec3  \cf4 \strokec4 tabPanels(\cf7 \strokec7 "tab0"\cf4 \strokec4 ,4)\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 Specs\cf3 \strokec3  \cf2 \strokec2 page\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option31=\cf7 \strokec7 "(IV+Shunt"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 PPT"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 Fileselection()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Filename\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str=S_Filename[0,\cf6 \strokec6 strsearch\cf4 \strokec4 (S_Filename,\cf7 \strokec7 "_"\cf4 \strokec4 ,0)-1],filelist=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 Prompt\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Enter\cf3 \strokec3  \cf7 \strokec7 your\cf3 \strokec3  \cf7 \strokec7 Root\cf3 \strokec3  \cf7 \strokec7 name\cf3 \strokec3  \cf7 \strokec7 (ie\cf3 \strokec3  \cf7 \strokec7 'Francine'\cf3 \strokec3  \cf7 \strokec7 or\cf3 \strokec3  \cf7 \strokec7 'PL1206/sb2'.\cf3 \strokec3  \cf7 \strokec7 Blank\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 a\cf3 \strokec3  \cf7 \strokec7 Single\cf3 \strokec3  \cf7 \strokec7 selection)?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "Single\cf3 \strokec3  \cf7 \strokec7 or\cf3 \strokec3  \cf7 \strokec7 Automatic\cf3 \strokec3  \cf7 \strokec7 file\cf3 \strokec3  \cf7 \strokec7 Selection"\cf4 \strokec4 ,str\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strlen\cf4 \strokec4 (str)>0)\
\cf3 \strokec3 		\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 allfilelist=\cf6 \strokec6 RemoveFromList\cf4 \strokec4 (S_Filename,\cf6 \strokec6 IndexedFile\cf4 \strokec4 (DataPath,-1,\cf7 \strokec7 "TEXT"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf4 \strokec4 filelist=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 ListMatch\cf4 \strokec4 (allfilelist,str+\cf7 \strokec7 "*"\cf4 \strokec4 ),\cf7 \strokec7 ";"\cf4 \strokec4 ,16)\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 named\cf3 \strokec3  \cf2 \strokec2 Igor\cf3 \strokec3  \cf2 \strokec2 files\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 filelist\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SelectDataSet([a])\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Darkcurrent\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_dataType\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,S_Ydataname\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 ParamIsDefault\cf4 \strokec4 (a))\
\cf3 \strokec3 		\cf4 \strokec4 a=V_dataType\
\cf3 \strokec3 		\cf9 \strokec9 Prompt\cf3 \strokec3  \cf4 \strokec4 a,\cf7 \strokec7 "Which\cf3 \strokec3  \cf7 \strokec7 dataset\cf3 \strokec3  \cf7 \strokec7 do\cf3 \strokec3  \cf7 \strokec7 you\cf3 \strokec3  \cf7 \strokec7 want\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 compare?"\cf4 \strokec4 ,popup,WaveChoice(allwaves,1)\
\cf3 \strokec3 		\cf9 \strokec9 DoPrompt\cf3 \strokec3  \cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 Sets"\cf4 \strokec4 ,a\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag)\
\cf3 \strokec3 			\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_dataType=a\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Waves\cf3 \strokec3  \cf2 \strokec2 start\cf3 \strokec3  \cf2 \strokec2 at\cf3 \strokec3  \cf2 \strokec2 #0\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 floor\cf4 \strokec4 ((V_dataType-1)/2)\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 mod\cf4 \strokec4 (V_dataType,2))\
\cf3 \strokec3 		\cf4 \strokec4 S_Ydataname=\cf7 \strokec7 "PhotoCurrent"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a)\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 S_Ydataname=\cf7 \strokec7 "TruePCurr"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a)\
\cf3 \strokec3 		\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w0=$S_YdataName,w1=$(\cf7 \strokec7 "PhotoCurrent"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a))\
\cf3 \strokec3 		\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 DarkCurrent,w\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 To\cf3 \strokec3  \cf2 \strokec2 scale\cf3 \strokec3  \cf2 \strokec2 wave\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=(0,0.1)\cf3 \strokec3  \cf4 \strokec4 Darkcurrent;\cf3 \strokec3  \cf4 \strokec4 w0=w1-DarkCurrent+V_avg\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Loadparams()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 Expt_parameters\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVparams,DarkCurrent,PhotoCurrent,Power,Transient0\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_complianceI,V_ipce550,V_ipce700,V_supos\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 d_t,S_dye,S_electrolyte,S_Filename1,S_layer,S_specification,S_type,S_CE,S_WE,S_YdataName\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 p1=\cf6 \strokec6 strsearch\cf4 \strokec4 (S_Filename1,\cf7 \strokec7 "_"\cf4 \strokec4 ,0)\
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 n=S_Filename1[p1+1,\cf6 \strokec6 strlen\cf4 \strokec4 (S_Filename1)]\
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 w=\cf7 \strokec7 "PhotoCurrent"\cf4 \strokec4 +n,w1=\cf7 \strokec7 "DarkCurrent"\cf4 \strokec4 +n,w2=\cf7 \strokec7 "Power"\cf4 \strokec4 +n,w3=\cf7 \strokec7 "Transient"\cf4 \strokec4 +n\
\cf3 \strokec3 	\cf8 \strokec8 SetDimLabel\cf3 \strokec3  \cf4 \strokec4 1,V_supos,$S_Filename1,Expt_parameters\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[0][V_supos]=S_type\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[1][V_supos]=S_dye\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[2][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (V_area)\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[3][V_supos]=S_specification\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[4][V_supos]=S_electrolyte\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[5][V_supos]=S_layer\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[6][V_supos]=S_WE\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[7][V_supos]=S_CE\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[8][V_supos]=S_Filename1\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[9][V_supos]=d_t\
\cf3 \strokec3 	\cf4 \strokec4 SummariseData()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Calculate\cf3 \strokec3  \cf2 \strokec2 Measured\cf3 \strokec3  \cf2 \strokec2 parameters\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a=12*(\cf6 \strokec6 str2num\cf4 \strokec4 (S_YdataName[12])==2)+24*(\cf6 \strokec6 str2num\cf4 \strokec4 (S_YdataName[12])==3)+36*(\cf6 \strokec6 str2num\cf4 \strokec4 (S_YdataName[12])==4)+48*(\cf6 \strokec6 str2num\cf4 \strokec4 (S_YdataName[12,12])==5)\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[10][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (IVparams[a+1][V_supos]*1e3)\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 PowerIn,\cf3 \strokec3  \cf2 \strokec2 scaled\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 mW\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[11][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (IVparams[a+3][V_supos])\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Uoc\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[12][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (IVparams[a+4][V_supos]*1e3)\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Isc,\cf3 \strokec3  \cf2 \strokec2 scaled\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 mA\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[13][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (IVparams[a+5][V_supos]*1e3)\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Jsc,\cf3 \strokec3  \cf2 \strokec2 scaled\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 mA\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[14][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (IVparams[a+6][V_supos])\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Upmax\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[15][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (IVparams[a+8][V_supos]*1e3)\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Jpmax\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[16][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (IVparams[a+9][V_supos]*1e3)\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 PowerOut\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[17][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (IVparams[a+10][V_supos])\cf3 \strokec3 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Ff\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[18][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (100*IVparams[a+9][V_supos]/IVparams[a+1][V_supos])\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[19][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (V_ipce550/V_area)\
\cf3 \strokec3 	\cf4 \strokec4 Expt_parameters[20][V_supos]=\cf6 \strokec6 num2str\cf4 \strokec4 (V_ipce700/V_area)\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent=$S_YdataName\
\cf3 \strokec3 	\cf4 \strokec4 PhotoCurrent/=V_area;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,$w;\cf3 \strokec3  \cf8 \strokec8 AppendtoGraph\cf3 \strokec3  \cf4 \strokec4 $w\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Append\cf3 \strokec3  \cf2 \strokec2 currents\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 DarkCurrent/=V_area;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 DarkCurrent,$w1;\cf3 \strokec3  \cf8 \strokec8 AppendtoGraph\cf3 \strokec3  \cf4 \strokec4 $w1\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Append\cf3 \strokec3  \cf2 \strokec2 Dark\cf3 \strokec3  \cf2 \strokec2 currents\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 $(\cf7 \strokec7 "Power"\cf4 \strokec4 +S_YdataName[12,13]),$w2;\cf3 \strokec3  \cf8 \strokec8 AppendtoGraph\cf4 \strokec4 /L=power\cf3 \strokec3  \cf4 \strokec4 $w2\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Append\cf3 \strokec3  \cf2 \strokec2 Power\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Transient0/=V_area;\cf3 \strokec3  \cf8 \strokec8 Duplicate\cf4 \strokec4 /O\cf3 \strokec3  \cf4 \strokec4 Transient0,$w3;\cf3 \strokec3  \cf8 \strokec8 AppendtoGraph\cf4 \strokec4 /W=TransientCGraph\cf3 \strokec3  \cf4 \strokec4 $w3\cf3 \strokec3 														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Append\cf3 \strokec3  \cf2 \strokec2 Transient\cf3 \strokec3  \cf2 \strokec2 currents\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 GetAxis\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,\cf6 \strokec6 min\cf4 \strokec4 (V_complianceI*V_area,-V_max/2),V_max\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lstyle($(\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (w)))=V_supos,lstyle($(\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (w1)))=V_supos,lstyle($(\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (w2)))=V_supos\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /W=TransientCGraph\cf3 \strokec3  \cf4 \strokec4 lstyle($(\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (w3)))=V_supos\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 rgb($(\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (w1)))=(0,65535,0),rgb($(\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (w2)))=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /W=IVGraph/A/R\cf3 \strokec3  \cf4 \strokec4 power;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 GetAxis\cf4 \strokec4 /W=IVGraph/Q\cf3 \strokec3  \cf4 \strokec4 power;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /W=IVGraph\cf3 \strokec3  \cf4 \strokec4 power,\cf6 \strokec6 min\cf4 \strokec4 (V_complianceI*V_area,-V_max/2),V_max\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /W=TransientCGraph/A\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Proc\cf3 \strokec3  \cf4 \strokec4 Export(a,b)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 b=\cf7 \strokec7 "Marie"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 Prompt\cf3 \strokec3  \cf4 \strokec4 b,\cf7 \strokec7 "Enter\cf3 \strokec3  \cf7 \strokec7 your\cf3 \strokec3  \cf7 \strokec7 Root\cf3 \strokec3  \cf7 \strokec7 name\cf3 \strokec3  \cf7 \strokec7 (ie\cf3 \strokec3  \cf7 \strokec7 'Marie')?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf4 \strokec4 name=b\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 fileIndex,GotFile,n;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 allfilelist=\cf6 \strokec6 IndexedFile\cf4 \strokec4 (DataPath,-1,\cf7 \strokec7 "TEXT"\cf4 \strokec4 ),filelist,s\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (a==1)\
\cf3 \strokec3 		\cf4 \strokec4 filelist=\cf6 \strokec6 ListMatch\cf4 \strokec4 (allfilelist,name+\cf7 \strokec7 "_*"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 named\cf3 \strokec3  \cf2 \strokec2 Igor\cf3 \strokec3  \cf2 \strokec2 files\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 filelist=\cf6 \strokec6 ListMatch\cf4 \strokec4 (allfilelist,\cf7 \strokec7 "!"\cf4 \strokec4 +name+\cf7 \strokec7 "_*"\cf4 \strokec4 )\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 everything\cf3 \strokec3  \cf2 \strokec2 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 s=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,filelist,\cf7 \strokec7 ";"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Pullout\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 'not\cf3 \strokec3  \cf2 \strokec2 named'\cf3 \strokec3  \cf2 \strokec2 files\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 GotFile=\cf6 \strokec6 StrSearch\cf4 \strokec4 (s,name,0)\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (GotFile==-1)\
\cf3 \strokec3 				\cf4 \strokec4 filelist=\cf6 \strokec6 RemoveFromList\cf4 \strokec4 (s,filelist,\cf7 \strokec7 ";"\cf4 \strokec4 )\
\cf3 \strokec3 			\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 n+=1\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 GotFile=\cf6 \strokec6 cmpStr\cf4 \strokec4 (s,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (GotFile)\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 S_Filename=\cf6 \strokec6 StringFromList\cf4 \strokec4 (fileindex,filelist,\cf7 \strokec7 ";"\cf4 \strokec4 )\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 Filename\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 GotFile=\cf6 \strokec6 cmpstr\cf4 \strokec4 (S_Filename,\cf7 \strokec7 ""\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 it\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (GotFile)\
\cf3 \strokec3 			\cf4 \strokec4 LoadIVData()\
\cf3 \strokec3 			\cf8 \strokec8 Legend\cf4 \strokec4 /K/N=text0\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Kill\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 legend\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 SummariseData()\
\cf3 \strokec3 			\cf8 \strokec8 SavePICT\cf4 \strokec4 /O/P=ExportPath\cf3 \strokec3  \cf4 \strokec4 as\cf7 \strokec7 "temp.PICT"\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 LoadIPCEData()\
\cf3 \strokec3 			\cf4 \strokec4 SaveExportData()\
\cf3 \strokec3 			\cf8 \strokec8 SavePICT\cf4 \strokec4 /O/P=ExportPath\cf3 \strokec3  \cf4 \strokec4 as\cf7 \strokec7 "temp_spec.PICT"\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 SendScript(\cf7 \strokec7 "I-U\cf3 \strokec3  \cf7 \strokec7 IMPORTATION"\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 fileIndex+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (GotFile)\
\cf3 \strokec3 	\cf4 \strokec4 ClearGraphs(\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "win:3"\cf4 \strokec4 ))\cf3 \strokec3 	\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 V_supos=-1\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 To\cf3 \strokec3  \cf2 \strokec2 avoid\cf3 \strokec3  \cf2 \strokec2 lastfile\cf3 \strokec3  \cf2 \strokec2 overwrite\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 next\cf3 \strokec3  \cf2 \strokec2 acquisition\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option5=\cf7 \strokec7 "Layout...("\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option6=\cf7 \strokec7 "Print\cf3 \strokec3  \cf7 \strokec7 &\cf3 \strokec3  \cf7 \strokec7 Save("\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option8=\cf7 \strokec7 "Append\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Data("\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option9=\cf7 \strokec7 "Save...("\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SaveExportData()\cf3 \strokec3        				    						 																			\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Store\cf3 \strokec3  \cf2 \strokec2 selected\cf3 \strokec3  \cf2 \strokec2 data\cf3 \strokec3  \cf2 \strokec2 wave\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 Igor\cf3 \strokec3  \cf2 \strokec2 ascii\cf3 \strokec3  \cf2 \strokec2 format\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVparams,cw\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_current_Total,V_IPCE550,V_IPCE700,V_supos\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 d_t,S_dye,S_electrolyte,S_Filename1,S_layer,S_specification,S_type,S_userName\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 file,n,p1=\cf6 \strokec6 strsearch\cf4 \strokec4 (d_t,\cf7 \strokec7 ",\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,0),p2=\cf6 \strokec6 strsearch\cf4 \strokec4 (d_t,\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,5),p3=\cf6 \strokec6 strsearch\cf4 \strokec4 (d_t,\cf7 \strokec7 ",\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,8)\
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 day=d_t[p2+1,p3-1],month=d_t[p1+2,p2-1],year=d_t[p3+2,p3+5],list=\cf7 \strokec7 "Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 str2num\cf4 \strokec4 (day)<10)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Pad\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 0\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 day=\cf7 \strokec7 "0"\cf4 \strokec4 +day\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 n=\cf6 \strokec6 WhichListItem\cf4 \strokec4 (month,list)+1;\cf3 \strokec3  \cf4 \strokec4 month=\cf6 \strokec6 num2str\cf4 \strokec4 (n)\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Find\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 month\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (n<10)\
\cf3 \strokec3 		\cf4 \strokec4 month=\cf7 \strokec7 "0"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (n)\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Open\cf4 \strokec4 /P=ExportPath\cf3 \strokec3  \cf4 \strokec4 file\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "temp.converti"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\t"\cf4 \strokec4 ,S_Filename\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\t"\cf4 \strokec4 ,month+\cf7 \strokec7 "/"\cf4 \strokec4 +day+\cf7 \strokec7 "/"\cf4 \strokec4 +year\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\t"\cf4 \strokec4 ,S_type\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\t"\cf4 \strokec4 ,S_Filename1[\cf6 \strokec6 strsearch\cf4 \strokec4 (S_Filename1,\cf7 \strokec7 "#"\cf4 \strokec4 ,8)+1,\cf6 \strokec6 strlen\cf4 \strokec4 (S_Filename1)]\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\t"\cf4 \strokec4 ,S_dye\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\t"\cf4 \strokec4 ,S_electrolyte\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\t"\cf4 \strokec4 ,S_layer\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\t"\cf4 \strokec4 ,S_specification\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.3f\\t"\cf4 \strokec4 ,V_area\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%s\\t"\cf4 \strokec4 ,S_userName\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,100*IVparams[9]/IVparams[1];\cf3 \strokec3  \cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,100*IVparams[57]/IVparams[49]\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,IVparams[5]*-1e3;\cf3 \strokec3  \cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,IVparams[53]*-1e3\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Jsc\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,IVparams[51]*1e3;\cf3 \strokec3  \cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,IVparams[3]*1e3\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Uoc\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,IVparams[58];\cf3 \strokec3  \cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,IVparams[10]\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Ff\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.1f\\t"\cf4 \strokec4 ,V_IPCE700/V_area;\cf3 \strokec3  \cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.1f\\t"\cf4 \strokec4 ,V_IPCE550/V_area\
\cf3 \strokec3 	\cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,V_current_Total*1e3;\cf3 \strokec3  \cf8 \strokec8 fprintf\cf3 \strokec3  \cf4 \strokec4 file,\cf7 \strokec7 "%.2f\\t"\cf4 \strokec4 ,cw[2]\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Close\cf3 \strokec3  \cf4 \strokec4 file\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 LoadIPCEData()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Filename1,option5,option8\
\cf3 \strokec3 	\cf8 \strokec8 LoadWave\cf4 \strokec4 /O/T/P=IPCEDataPath\cf3 \strokec3  \cf4 \strokec4 S_Filename1\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IPCEPlot\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "IPCEPlot()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option5=\cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 IPCE"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option8=\cf7 \strokec7 "Append\cf3 \strokec3  \cf7 \strokec7 IPCE\cf3 \strokec3  \cf7 \strokec7 Data"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 IVDataLists()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Panel\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PathInfo\cf3 \strokec3  \cf4 \strokec4 DataPath\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVDataLists\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 		\cf8 \strokec8 NewPanel\cf4 \strokec4 /K=2/W=(16,40,456,888)\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "IV\cf3 \strokec3  \cf7 \strokec7 File\cf3 \strokec3  \cf7 \strokec7 List"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 AutoPositionWindow\cf4 \strokec4 /E/M=0/R=ConfigPanel\
\cf3 \strokec3 		\cf8 \strokec8 ModifyPanel\cf3 \strokec3  \cf4 \strokec4 cbRGB=(54611,54611,54611)\
\cf3 \strokec3 		\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 SetPath,pos=\{8,2\},size=\{46,20\},\cf9 \strokec9 proc\cf4 \strokec4 =GetPath,fsize=10,title=\cf7 \strokec7 "Set\cf3 \strokec3  \cf7 \strokec7 Path"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 Path,pos=\{64,2\},size=\{320,20\},frame=5,\cf9 \strokec9 variable\cf4 \strokec4 =S_Path\
\cf3 \strokec3 		\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 fileType,pos=\{336,2\},size=\{76,20\},\cf9 \strokec9 proc\cf4 \strokec4 =fileType,title=\cf7 \strokec7 "File\cf3 \strokec3  \cf7 \strokec7 Type:"\cf4 \strokec4 ,mode=1,value=#\cf7 \strokec7 "\\".sIV;.tIV;.pPT\\""\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 ListBox\cf3 \strokec3  \cf4 \strokec4 lb0,pos=\{8,24\},size=\{424,800\},\cf9 \strokec9 proc\cf4 \strokec4 =IVSetFile,frame=2,listWave=IVDirectory,selWave=sjack,colorWave=myColors,mode=4,editStyle=1,row=V_modeFile,widths=\{24,16,8,16\}\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 GetFileList()\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 FileType(ctrlName,varNum,varStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,varStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 varNum\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_ExptType\
\cf3 \strokec3 	\cf4 \strokec4 S_ExptType=varStr\
\cf3 \strokec3 	\cf4 \strokec4 GetFileList()\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 GetPath(ctrlName)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 ButtonControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 ctrlName\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_ExptType\
\cf3 \strokec3 	\cf8 \strokec8 NewPath\cf4 \strokec4 /O/M=\cf7 \strokec7 "Input\cf3 \strokec3  \cf7 \strokec7 Data\cf3 \strokec3  \cf7 \strokec7 folder\cf3 \strokec3  \cf7 \strokec7 for\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_ExptType+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 files"\cf3 \strokec3  \cf4 \strokec4 DataPath\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag!=0)\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 User\cf3 \strokec3  \cf2 \strokec2 hit\cf3 \strokec3  \cf2 \strokec2 cancel\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 PathInfo\cf3 \strokec3  \cf4 \strokec4 DataPath\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Flag==0)\
\cf3 \strokec3 		\cf8 \strokec8 Abort\cf3 \strokec3  \cf7 \strokec7 "Selected\cf3 \strokec3  \cf7 \strokec7 Path\cf3 \strokec3  \cf7 \strokec7 does\cf3 \strokec3  \cf7 \strokec7 not\cf3 \strokec3  \cf7 \strokec7 exist"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 GetFileList()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 IVDirectory\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 seqData,sjack\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_exptType\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 file,n,nfiles;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 fileName,fileList=\cf6 \strokec6 IndexedFile\cf4 \strokec4 (DataPath,-1,S_ExptType),wname=\cf7 \strokec7 "bwave0"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 nfiles=\cf6 \strokec6 ItemsinList\cf4 \strokec4 (fileList,\cf7 \strokec7 ";"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (nfiles==0)\
\cf3 \strokec3 		\cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf7 \strokec7 "No\cf3 \strokec3  \cf7 \strokec7 Data\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 this\cf3 \strokec3  \cf7 \strokec7 file\cf3 \strokec3  \cf7 \strokec7 Type:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_exptType\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Make\cf4 \strokec4 /O/N=8/W\cf3 \strokec3  \cf4 \strokec4 $wname\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=$wname\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(nfiles,-1)\cf3 \strokec3  \cf4 \strokec4 IVDirectory;\cf3 \strokec3  \cf8 \strokec8 Redimension\cf4 \strokec4 /N=(nfiles,-1,3)\cf3 \strokec3  \cf4 \strokec4 sjack\
\cf3 \strokec3 	\cf4 \strokec4 IVDirectory=\cf6 \strokec6 StringfromList\cf4 \strokec4 (p,fileList,\cf7 \strokec7 ";"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 fileName=\cf6 \strokec6 StringfromList\cf4 \strokec4 (n,fileList);\cf3 \strokec3  \cf4 \strokec4 IVDirectory[n][0]=fileName\
\cf3 \strokec3 		\cf8 \strokec8 Open\cf4 \strokec4 /P=DataPath/R\cf3 \strokec3  \cf4 \strokec4 file\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf4 \strokec4 fileName\
\cf3 \strokec3 		\cf8 \strokec8 FStatus\cf3 \strokec3  \cf4 \strokec4 file;\cf3 \strokec3  \cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_logEOF)\cf3 \strokec3  \cf4 \strokec4 w;\cf3 \strokec3  \cf8 \strokec8 FBinRead\cf4 \strokec4 /F=1\cf3 \strokec3  \cf4 \strokec4 file,w\
\cf3 \strokec3 		\cf4 \strokec4 seqData=\{88,32,83,95,99,101\};\cf3 \strokec3  \cf8 \strokec8 FindSequence\cf4 \strokec4 /S=(V_logEOF-512)/I=seqData\cf3 \strokec3  \cf4 \strokec4 w\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Search\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Cellname\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 IVDirectory[n][1]=\cf6 \strokec6 SelectString\cf4 \strokec4 ((V_Value>-1),\cf7 \strokec7 ""\cf4 \strokec4 ,w2text(w,V_Value+13));\
\cf3 \strokec3 		\cf4 \strokec4 seqData=\{88,32,83,95,100,121\};\cf3 \strokec3  \cf8 \strokec8 FindSequence\cf4 \strokec4 /S=(V_Value)/I=seqData\cf3 \strokec3  \cf4 \strokec4 w\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Search\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Dye\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 IVDirectory[n][2]=\cf6 \strokec6 SelectString\cf4 \strokec4 ((V_Value>-1),\cf7 \strokec7 ""\cf4 \strokec4 ,w2text(w,V_Value+8))\
\cf3 \strokec3 		\cf4 \strokec4 seqData=\{88,32,83,95,101,108\};\cf3 \strokec3  \cf8 \strokec8 FindSequence\cf4 \strokec4 /S=(V_Value)/I=seqData\cf3 \strokec3  \cf4 \strokec4 w\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Search\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Electrolyte\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 IVDirectory[n][3]=\cf6 \strokec6 SelectString\cf4 \strokec4 ((V_Value>-1),\cf7 \strokec7 ""\cf4 \strokec4 ,w2text(w,V_Value+16))\
\cf3 \strokec3 		\cf8 \strokec8 Close\cf3 \strokec3  \cf4 \strokec4 file\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<nfiles)\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 i,ncols=\cf6 \strokec6 DimSize\cf4 \strokec4 (IVDirectory,1)\
\cf3 \strokec3 	\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<ncols;\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 		\cf8 \strokec8 SetDimLabel\cf3 \strokec3  \cf4 \strokec4 1,i,$\cf6 \strokec6 StringFromList\cf4 \strokec4 (i,\cf7 \strokec7 "Filename;\cf3 \strokec3   \cf7 \strokec7 Cellname;\cf3 \strokec3   \cf7 \strokec7 Dye;\cf3 \strokec3   \cf7 \strokec7 Electrolyte"\cf4 \strokec4 ),IVDirectory\
\cf3 \strokec3 	\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetDimLabel\cf3 \strokec3  \cf4 \strokec4 2,1,foreColors,sjack;\cf3 \strokec3  \cf8 \strokec8 SetDimLabel\cf3 \strokec3  \cf4 \strokec4 2,2,backColors,sjack\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Colour\cf3 \strokec3  \cf2 \strokec2 determined\cf3 \strokec3  \cf2 \strokec2 by\cf3 \strokec3  \cf2 \strokec2 DimLabel\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 sjack[][][1]=3;\cf3 \strokec3  \cf4 \strokec4 sjack[][][2]=1\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 colours\cf3 \strokec3  \cf2 \strokec2 from\cf3 \strokec3  \cf2 \strokec2 ColourWave\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 KillWaves\cf3 \strokec3  \cf4 \strokec4 w\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 IVSetFile(ctrlName,row,col,event)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName;\cf3 \strokec3  	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 row,col,event\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 w=IVDirectory\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 sjack\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_modeFile,V_seltFile,V_max\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 gXDataName=root:Packages:WMmpFitting:gXDataName,gYDataName=root:Packages:WMmpFitting:gYDataName\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 gFitDataName=root:Packages:WMmpFitting:gFitDataName,gResidsName=root:Packages:WMmpFitting:gResidsName\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allspectra,S_ExptType,S_Filename1\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a,i,n,nfiles,flg;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf4 \strokec4 S_Filename1=\cf7 \strokec7 ""\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 allspectra=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (event)\
\cf3 \strokec3 	\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\cf3 \strokec3 																																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Mouseup\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_modeFile=row\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_seltFile)\
\cf3 \strokec3 			\cf9 \strokec9 for\cf3 \strokec3  \cf4 \strokec4 (i=0;\cf3 \strokec3  \cf4 \strokec4 i<\cf6 \strokec6 DimSize\cf4 \strokec4 (w,0);\cf3 \strokec3  \cf4 \strokec4 i+=1)\
\cf3 \strokec3 				\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (sjack[i][0][0]>0)\
\cf3 \strokec3 					\cf4 \strokec4 allspectra+=w[i][0]+\cf7 \strokec7 ";"\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 list\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 selected\cf3 \strokec3  \cf2 \strokec2 spectra\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endfor\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 allspectra=allspectra[0,\cf6 \strokec6 strlen\cf4 \strokec4 (allspectra)-2]\cf3 \strokec3 																							\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 strip\cf3 \strokec3  \cf2 \strokec2 off\cf3 \strokec3  \cf2 \strokec2 the\cf3 \strokec3  \cf2 \strokec2 ';'\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 S_Filename1=\cf6 \strokec6 SelectString\cf4 \strokec4 (\cf6 \strokec6 strlen\cf4 \strokec4 (w[row][0][0])>0,\cf7 \strokec7 ""\cf4 \strokec4 ,w[row][i]+\cf7 \strokec7 ","\cf4 \strokec4 )\
\cf3 \strokec3 			\cf4 \strokec4 S_Filename1=S_Filename1[0,\cf6 \strokec6 strlen\cf4 \strokec4 (S_Filename1)-2];\cf3 \strokec3  \cf4 \strokec4 allspectra=S_Filename1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 nfiles=\cf6 \strokec6 ItemsinList\cf4 \strokec4 (allspectra)\
\cf3 \strokec3 		\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 strswitch\cf3 \strokec3  \cf4 \strokec4 (S_ExptType)\
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 ".sIV"\cf4 \strokec4 :\
\cf3 \strokec3 				\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (n==0)\
\cf3 \strokec3 					\cf4 \strokec4 LoadIVData()\
\cf3 \strokec3 				\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 					\cf4 \strokec4 AppendIVData()\
\cf3 \strokec3 				\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf7 \strokec7 ".pPT"\cf4 \strokec4 :\
\cf3 \strokec3 				\cf4 \strokec4 LoadPPTData()\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 n+=1\
\cf3 \strokec3 		\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<nfiles)\
\cf3 \strokec3 		\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 4:\cf3 \strokec3 																																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Cell\cf3 \strokec3  \cf2 \strokec2 Selection\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_seltFile=0\
\cf3 \strokec3 		\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 5:\cf3 \strokec3 																																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Shift\cf3 \strokec3  \cf2 \strokec2 +\cf3 \strokec3  \cf2 \strokec2 Mouse\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 V_seltFile=1\
\cf3 \strokec3 		\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Proc\cf3 \strokec3  \cf4 \strokec4 DataPaths()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PathInfo\cf3 \strokec3  \cf4 \strokec4 home\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 s=\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,S_Path,\cf7 \strokec7 ":"\cf4 \strokec4 )+\cf7 \strokec7 ":Users"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 NewPath\cf4 \strokec4 /O/Q\cf3 \strokec3  \cf4 \strokec4 DataPath,s+\cf7 \strokec7 ":Shared:Cell's\cf3 \strokec3  \cf7 \strokec7 folder:"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 NewPath\cf4 \strokec4 /O/Q\cf3 \strokec3  \cf4 \strokec4 PDFpath,s+\cf7 \strokec7 ":Shared:IV\cf3 \strokec3  \cf7 \strokec7 PDF\cf3 \strokec3  \cf7 \strokec7 files:"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 NewPath/O/Q\cf3 \strokec3  \cf2 \strokec2 ExportPath,s+":FileMaker\cf3 \strokec3  \cf2 \strokec2 Pro:"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 NewPath\cf4 \strokec4 /O/Q\cf3 \strokec3  \cf4 \strokec4 MoleculePath\cf3 \strokec3  \cf4 \strokec4 S_Path+\cf7 \strokec7 "Molecules:"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Packages"\cf4 \strokec4 ,\cf6 \strokec6 SpecialDirPath\cf4 \strokec4 (\cf7 \strokec7 "Packages"\cf4 \strokec4 ,0,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Documents"\cf4 \strokec4 ,\cf6 \strokec6 SpecialDirPath\cf4 \strokec4 (\cf7 \strokec7 "Documents"\cf4 \strokec4 ,0,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Preferences"\cf4 \strokec4 ,\cf6 \strokec6 SpecialDirPath\cf4 \strokec4 (\cf7 \strokec7 "Preferences"\cf4 \strokec4 ,0,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Temporary"\cf4 \strokec4 ,\cf6 \strokec6 SpecialDirPath\cf4 \strokec4 (\cf7 \strokec7 "Temporary"\cf4 \strokec4 ,0,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Igor\cf3 \strokec3  \cf7 \strokec7 Application"\cf4 \strokec4 ,\cf6 \strokec6 SpecialDirPath\cf4 \strokec4 (\cf7 \strokec7 "Igor\cf3 \strokec3  \cf7 \strokec7 Application"\cf4 \strokec4 ,0,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Igor\cf3 \strokec3  \cf7 \strokec7 Preferences"\cf4 \strokec4 ,\cf6 \strokec6 SpecialDirPath\cf4 \strokec4 (\cf7 \strokec7 "Igor\cf3 \strokec3  \cf7 \strokec7 Preferences"\cf4 \strokec4 ,0,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Igor\cf3 \strokec3  \cf7 \strokec7 Pro\cf3 \strokec3  \cf7 \strokec7 User\cf3 \strokec3  \cf7 \strokec7 Files"\cf4 \strokec4 ,\cf6 \strokec6 SpecialDirPath\cf4 \strokec4 (\cf7 \strokec7 "Igor\cf3 \strokec3  \cf7 \strokec7 Pro\cf3 \strokec3  \cf7 \strokec7 User\cf3 \strokec3  \cf7 \strokec7 Files"\cf4 \strokec4 ,0,0,0)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 s=\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,S_Path,\cf7 \strokec7 ":"\cf4 \strokec4 )+\cf7 \strokec7 ":"\cf4 \strokec4 +\cf6 \strokec6 StringFromList\cf4 \strokec4 (1,S_Path,\cf7 \strokec7 ":"\cf4 \strokec4 )+\cf7 \strokec7 ":"\cf4 \strokec4 +\cf6 \strokec6 StringFromList\cf4 \strokec4 (2,S_Path,\cf7 \strokec7 ":"\cf4 \strokec4 )+\cf7 \strokec7 ":"\cf4 \strokec4 +\cf6 \strokec6 StringFromList\cf4 \strokec4 (3,S_Path,\cf7 \strokec7 ":"\cf4 \strokec4 )\
\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SaveSpexInits()\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Store\cf3 \strokec3  \cf2 \strokec2 System\cf3 \strokec3  \cf2 \strokec2 calibrations\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 refdiodes,offset,offsetOrange\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Filename1\
\cf3 \strokec3 	\cf4 \strokec4 S_Filename1=\cf7 \strokec7 "SunTest"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Save\cf4 \strokec4 /T/O/P=DataPath\cf3 \strokec3  \cf4 \strokec4 refdiodes,offset,offsetOrange\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf4 \strokec4 S_Filename1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 LoadSpexInits()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Filename1\
\cf3 \strokec3 	\cf4 \strokec4 S_Filename1=\cf7 \strokec7 "SunTest"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 LoadWave\cf4 \strokec4 /Q/O/T/P=DataPath\cf3 \strokec3  \cf4 \strokec4 S_Filename1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 w2text(w,p0)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 wave\cf3 \strokec3  \cf4 \strokec4 w;\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 p0\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (w[p0+n]==13)\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 str+=\cf6 \strokec6 num2char\cf4 \strokec4 (w[p0+n])\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 str[1,\cf6 \strokec6 strlen\cf4 \strokec4 (str)-2]\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 ///////////////////////////////////////////////////\cf3 \strokec3  \cf2 \strokec2 DATA\cf3 \strokec3  \cf2 \strokec2 I/O\cf3 \strokec3  \cf2 \strokec2 ////////////////////////////////////////////////////\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetUpSystem()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 PSUSettings\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_BufferGain,V_endVolt,V_supos,V_defaultVoc,V_navg,V_pulsedMode,V_refNum,V_delay,V_run,V_scanDir,V_dutyCycle,V_loadFlag,V_voltFlag\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_system,option1,option2\
\cf3 \strokec3 	\cf8 \strokec8 PathInfo\cf3 \strokec3  \cf4 \strokec4 home\
\cf3 \strokec3 	\cf4 \strokec4 S_system=\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,S_Path,\cf7 \strokec7 ":"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 CmpStr\cf4 \strokec4 (S_system,\cf7 \strokec7 "Solar\cf3 \strokec3  \cf7 \strokec7 Lab"\cf4 \strokec4 ))\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringbyKey\cf4 \strokec4 (\cf7 \strokec7 "IGORVERS"\cf4 \strokec4 ,\cf6 \strokec6 IgorInfo\cf4 \strokec4 (0)))>=5.05)\
\cf3 \strokec3 		\cf8 \strokec8 Abort\cf3 \strokec3  \cf7 \strokec7 "Igor\cf3 \strokec3  \cf7 \strokec7 Pro\cf3 \strokec3  \cf7 \strokec7 version\cf3 \strokec3  \cf7 \strokec7 6.0\cf3 \strokec3  \cf7 \strokec7 or\cf3 \strokec3  \cf7 \strokec7 better\cf3 \strokec3  \cf7 \strokec7 is\cf3 \strokec3  \cf7 \strokec7 required.\cf3 \strokec3  \cf7 \strokec7 You\cf3 \strokec3  \cf7 \strokec7 have\cf3 \strokec3  \cf7 \strokec7 Igor\cf3 \strokec3  \cf7 \strokec7 Pro\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 StringbyKey\cf4 \strokec4 (\cf7 \strokec7 "IGORVERS"\cf4 \strokec4 ,\cf6 \strokec6 IgorInfo\cf4 \strokec4 (0))\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TitleBox\cf3 \strokec3  \cf4 \strokec4 msg,win=configPanel,title=\cf7 \strokec7 "\\F'Chicago'\\Z12Initialising\cf3 \strokec3  \cf7 \strokec7 Keithley\cf3 \strokec3  \cf7 \strokec7 2400"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 ControlUpdate\cf4 \strokec4 /W=configPanel\cf3 \strokec3  \cf4 \strokec4 msg\
\cf3 \strokec3 	\cf4 \strokec4 SetupGPIBKeithley()\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 TitleBox\cf3 \strokec3  \cf2 \strokec2 msg,win=configPanel,title="\\F'Chicago'\\Z12Initialising\cf3 \strokec3  \cf2 \strokec2 Arduino";\cf3 \strokec3  \cf2 \strokec2 ControlUpdate/W=configPanel\cf3 \strokec3  \cf2 \strokec2 msg\cf4 \strokec4 \
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 SetupArduino()\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 Init()\
\cf3 \strokec3 	\cf4 \strokec4 ClearGraphs(\cf6 \strokec6 WinList\cf4 \strokec4 (\cf7 \strokec7 "*"\cf4 \strokec4 ,\cf7 \strokec7 ";"\cf4 \strokec4 ,\cf7 \strokec7 "win:3"\cf4 \strokec4 ))\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_endVolt=0;\cf3 \strokec3  \cf4 \strokec4 V_supos=-1;\cf3 \strokec3  \cf4 \strokec4 V_loadFlag=0;\cf3 \strokec3  \cf4 \strokec4 V_defaultVoc=1.1;\cf3 \strokec3  \cf4 \strokec4 V_navg=8;\cf3 \strokec3  \cf4 \strokec4 V_refNum=9;\cf3 \strokec3  \cf4 \strokec4 V_delay=0;\cf3 \strokec3  \cf4 \strokec4 V_pulsedMode=0;\cf3 \strokec3  \cf4 \strokec4 V_run=1;\cf3 \strokec3  \cf4 \strokec4 V_scanDir=1;\cf3 \strokec3  \cf4 \strokec4 V_scanDir=1;\cf3 \strokec3  \cf4 \strokec4 V_dutyCycle=50;\cf3 \strokec3  \cf4 \strokec4 V_voltFlag=0\
\cf3 \strokec3 	\cf8 \strokec8 Popupmenu\cf3 \strokec3  \cf4 \strokec4 user\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=1;\cf3 \strokec3  \cf4 \strokec4 User(\cf7 \strokec7 "user"\cf4 \strokec4 ,1,\cf7 \strokec7 "Visitor"\cf4 \strokec4 )\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 Default\cf3 \strokec3  \cf2 \strokec2 user\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Popupmenu\cf3 \strokec3  \cf4 \strokec4 filter0\cf3 \strokec3  \cf4 \strokec4 win=configpanel,mode=1;\cf3 \strokec3  \cf4 \strokec4 LampControl(\cf7 \strokec7 "Filter"\cf4 \strokec4 ,PSUSettings(10),4)\
\cf3 \strokec3 	\cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 cell0,win=configpanel,mode=2;\cf3 \strokec3  \cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 SelectCell("Cell",2,"Test\cf3 \strokec3  \cf2 \strokec2 Cell")\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 CellNumber(\cf7 \strokec7 "ncell"\cf4 \strokec4 ,1,\cf7 \strokec7 "1"\cf4 \strokec4 )\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 IVSpectrum()\
\cf3 \strokec3 	\cf4 \strokec4 option1=\cf7 \strokec7 "NIDAQ\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option2=\cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 Diagnostics"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 BuildMenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TranslationStage(ctrlName,varNum,varStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 3\cf3 \strokec3  \cf2 \strokec2 Positions;\cf3 \strokec3  \cf2 \strokec2 1,\cf3 \strokec3  \cf2 \strokec2 2\cf3 \strokec3  \cf2 \strokec2 &\cf3 \strokec3  \cf2 \strokec2 3\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,varStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 varNum\cf3 \strokec3 																										\cf2 \strokec2 //\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 NIDAQ_board1\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_d1,V_d2,V_Position\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 delta\cf3 \strokec3 																																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Optimise\cf3 \strokec3  \cf2 \strokec2 distances\cf3 \strokec3  \cf2 \strokec2 V_d1,V_d2\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 delta=V_d1*((V_Position>0)-(varNum>0))+V_d2*((varNum>1)-(V_Position>1))\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 print\cf3 \strokec3  \cf2 \strokec2 V_d1,V_d2,varNum,V_position,delta\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (delta==0)\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ArduinoDrive(160,delta)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 -ve\cf3 \strokec3  \cf2 \strokec2 Moves\cf3 \strokec3  \cf2 \strokec2 away\cf3 \strokec3  \cf2 \strokec2 from\cf3 \strokec3  \cf2 \strokec2 motor\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 V_Position=varNum;\cf3 \strokec3  \cf8 \strokec8 PopupMenu\cf3 \strokec3  \cf4 \strokec4 cell0,win=ConfigPanel,mode=varNum\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TestMotor(n)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 i,delta=200\
\cf3 \strokec3 	\cf9 \strokec9 for\cf4 \strokec4 (i=1;i<n+1;i+=1)\
\cf3 \strokec3 		\cf4 \strokec4 ArduinoDrive(160,delta)\
\cf3 \strokec3 	\cf9 \strokec9 endfor\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetupArduino()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 STRUCT\cf3 \strokec3  \cf4 \strokec4 ArduinoSeqSettings\cf3 \strokec3  \cf4 \strokec4 ards\
\cf3 \strokec3 	\cf4 \strokec4 ARDSetSeqSettings(ards)\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_bootver,S_mainver,S_response\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 i,n,num;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 port,S_value\
\cf3 \strokec3 	\cf8 \strokec8 VDTGetPortList2\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 port=\cf6 \strokec6 StringfromList\cf4 \strokec4 (0,\cf6 \strokec6 ListMatch\cf4 \strokec4 (S_VDT,\cf7 \strokec7 "usbmodem*"\cf4 \strokec4 ))\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 strlen\cf4 \strokec4 (port)>0)\
\cf3 \strokec3 								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 print\cf3 \strokec3  \cf2 \strokec2 "Found\cf3 \strokec3  \cf2 \strokec2 Port#0",port\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 print\cf3 \strokec3  \cf4 \strokec4 S_VDT\
\cf3 \strokec3 		\cf8 \strokec8 abort\cf3 \strokec3  \cf7 \strokec7 "No\cf3 \strokec3  \cf7 \strokec7 Arduino\cf3 \strokec3  \cf7 \strokec7 USB\cf3 \strokec3  \cf7 \strokec7 board\cf3 \strokec3  \cf7 \strokec7 found"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 ards.gWhichComStr1=port\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "USB2\cf3 \strokec3  \cf7 \strokec7 Arduino:"\cf4 \strokec4 ,ards.gWhichComStr1\
\cf3 \strokec3 	\cf8 \strokec8 VDT2\cf4 \strokec4 /P=$ards.gWhichComStr1\cf3 \strokec3  \cf4 \strokec4 baud=115200,stopbits=1,databits=8,parity=0,in=0,out=0\cf3 \strokec3 															\cf2 \strokec2 //baud=115200\cf3 \strokec3  \cf2 \strokec2 JT20140815\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 VDTOperationsPort2\cf3 \strokec3  \cf4 \strokec4 $ards.gWhichComStr1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ArduinoReadAnalog(pin)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 pin\
\cf3 \strokec3 	\cf9 \strokec9 STRUCT\cf3 \strokec3  \cf4 \strokec4 ArduinoSeqSettings\cf3 \strokec3  \cf4 \strokec4 ards\
\cf3 \strokec3 	\cf4 \strokec4 ARDSetSeqSettings(ards)\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 Attempts,cmd=7,success\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ArduinoStr=\cf3 \strokec3  \cf7 \strokec7 "Waiting\cf3 \strokec3  \cf7 \strokec7 ...\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,outStr=\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 outStr,\cf7 \strokec7 "%d,%d;"\cf4 \strokec4 ,cmd,pin\
\cf3 \strokec3 	\cf8 \strokec8 VDTOperationsPort2\cf3 \strokec3  \cf4 \strokec4 $ards.gWhichComStr1\
\cf3 \strokec3 	\cf9 \strokec9 do\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 VDT2\cf3 \strokec3  \cf4 \strokec4 killIO\
\cf3 \strokec3 		\cf8 \strokec8 VDTWrite2\cf4 \strokec4 /O=0.1\cf3 \strokec3  \cf4 \strokec4 outStr\
\cf3 \strokec3 		\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf4 \strokec4 ArduinoStr\
\cf3 \strokec3 		\cf4 \strokec4 ards.gVDT2Message=ArduinoStr\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 stringmatch\cf4 \strokec4 (ArduinoStr,\cf7 \strokec7 "*1,Analog\cf3 \strokec3  \cf7 \strokec7 Read\cf3 \strokec3  \cf7 \strokec7 cmd\cf3 \strokec3  \cf7 \strokec7 received*"\cf4 \strokec4 )==1)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Analog\cf3 \strokec3  \cf7 \strokec7 read\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,attempts\
\cf3 \strokec3 			\cf4 \strokec4 attempts=20\
\cf3 \strokec3 			\cf4 \strokec4 success=1\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 attempts+=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (attempts<20)\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (success!=1)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Failed\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 send\cf3 \strokec3  \cf7 \strokec7 Analog\cf3 \strokec3  \cf7 \strokec7 Read\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,Attempts\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 -1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response;\cf3 \strokec3  \cf8 \strokec8 print\cf3 \strokec3  \cf4 \strokec4 S_Response[1,\cf6 \strokec6 strlen\cf4 \strokec4 (S_response)-1]\
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ArduinoReadWaveAnalog(pin)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 pin\
\cf3 \strokec3 	\cf9 \strokec9 STRUCT\cf3 \strokec3  \cf4 \strokec4 ArduinoSeqSettings\cf3 \strokec3  \cf4 \strokec4 ards\
\cf3 \strokec3 	\cf4 \strokec4 ARDSetSeqSettings(ards)\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Bufferwave,wave2,wave3\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,attempts,i,npnts=512,cmd=16,success\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ArduinoStr=\cf7 \strokec7 "Waiting\cf3 \strokec3  \cf7 \strokec7 ...\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,outStr=\cf7 \strokec7 ""\cf4 \strokec4 ,value\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /I/U/N=(npnts)\cf3 \strokec3  \cf4 \strokec4 Bufferwave,wave2,wave3\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 outStr,\cf7 \strokec7 "%d,%d,%d;"\cf4 \strokec4 ,cmd,pin,npnts\
\cf3 \strokec3 	\cf8 \strokec8 VDTOperationsPort2\cf3 \strokec3  \cf4 \strokec4 $ards.gWhichComStr1\
\cf3 \strokec3 	\cf9 \strokec9 do\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 VDT2\cf3 \strokec3  \cf4 \strokec4 killIO\
\cf3 \strokec3 		\cf8 \strokec8 VDTWrite2\cf4 \strokec4 /O=0.1\cf3 \strokec3  \cf4 \strokec4 outStr\
\cf3 \strokec3 		\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf4 \strokec4 ArduinoStr\
\cf3 \strokec3 		\cf4 \strokec4 ards.gVDT2Message=ArduinoStr\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 stringmatch\cf4 \strokec4 (ArduinoStr,\cf7 \strokec7 "*16,Analog\cf3 \strokec3  \cf7 \strokec7 cmd\cf3 \strokec3  \cf7 \strokec7 received*"\cf4 \strokec4 )==1)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Analog\cf3 \strokec3  \cf7 \strokec7 Wave\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,attempts\
\cf3 \strokec3 			\cf4 \strokec4 attempts=20\
\cf3 \strokec3 			\cf4 \strokec4 success=1\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 attempts+=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (attempts<20)\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (success!=1)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Analog\cf3 \strokec3  \cf7 \strokec7 cmd\cf3 \strokec3  \cf7 \strokec7 failed\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,Attempts\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 -1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response\
\cf3 \strokec3 	\cf8 \strokec8 VDTReadWave2\cf4 \strokec4 /N=(npnts)/T=\cf7 \strokec7 ","\cf3 \strokec3  \cf4 \strokec4 wave2,wave3\
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Function\cf3 \strokec3  \cf2 \strokec2 finished\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Interpolate2\cf4 \strokec4 /T=1/N=(npnts)/Y=Bufferwave\cf3 \strokec3  \cf4 \strokec4 wave2,wave3\
\cf3 \strokec3 	\cf4 \strokec4 a=(wave2[npnts-1]-wave2[0])/(npnts-1)*1e-6\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 0,a,\cf7 \strokec7 "s"\cf4 \strokec4 ,Bufferwave\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ArduinoDigital(pin,value)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 pin,value\
\cf3 \strokec3 	\cf9 \strokec9 STRUCT\cf3 \strokec3  \cf4 \strokec4 ArduinoSeqSettings\cf3 \strokec3  \cf4 \strokec4 ards\
\cf3 \strokec3 	\cf4 \strokec4 ARDSetSeqSettings(ards)\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 Attempts,cmd=6,success=0\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ArduinoStr=\cf3 \strokec3  \cf7 \strokec7 "Waiting\cf3 \strokec3  \cf7 \strokec7 ...\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,outStr=\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 outStr,\cf7 \strokec7 "%d,%d,%d;"\cf4 \strokec4 ,cmd,pin,value\
\cf3 \strokec3 	\cf8 \strokec8 VDTOperationsPort2\cf3 \strokec3  \cf4 \strokec4 $ards.gWhichComStr1\
\cf3 \strokec3 	\cf9 \strokec9 do\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 VDT2\cf3 \strokec3  \cf4 \strokec4 killIO\
\cf3 \strokec3 		\cf8 \strokec8 VDTWrite2\cf4 \strokec4 /O=0.1\cf3 \strokec3  \cf4 \strokec4 outStr\
\cf3 \strokec3 		\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf4 \strokec4 ArduinoStr\
\cf3 \strokec3 		\cf4 \strokec4 ards.gVDT2Message=ArduinoStr\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 stringmatch\cf4 \strokec4 (ArduinoStr,\cf7 \strokec7 "*1,Digital\cf3 \strokec3  \cf7 \strokec7 cmd\cf3 \strokec3  \cf7 \strokec7 received*"\cf4 \strokec4 )==1)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Digital\cf3 \strokec3  \cf7 \strokec7 out\cf3 \strokec3  \cf7 \strokec7 sent\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,attempts\
\cf3 \strokec3 			\cf4 \strokec4 attempts=20\
\cf3 \strokec3 			\cf4 \strokec4 success=1\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 attempts+=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (attempts<20)\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (success!=1)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Failed\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 send\cf3 \strokec3  \cf7 \strokec7 Digital\cf3 \strokec3  \cf7 \strokec7 out\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,Attempts\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 -1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response,S_Response\
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response\cf3 \strokec3 																								\cf2 \strokec2 //;\cf3 \strokec3  \cf2 \strokec2 print\cf3 \strokec3  \cf2 \strokec2 S_Response[1,strlen(S_response)-1]\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Function\cf3 \strokec3  \cf2 \strokec2 finished\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ArduinoOutAnalog(pin,value)\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Only\cf3 \strokec3  \cf2 \strokec2 DAC0\cf3 \strokec3  \cf2 \strokec2 &\cf3 \strokec3  \cf2 \strokec2 DAC1,\cf3 \strokec3  \cf2 \strokec2 Value:\cf3 \strokec3  \cf2 \strokec2 0->4095,\cf3 \strokec3  \cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 pin,value\
\cf3 \strokec3 	\cf9 \strokec9 STRUCT\cf3 \strokec3  \cf4 \strokec4 ArduinoSeqSettings\cf3 \strokec3  \cf4 \strokec4 ards\
\cf3 \strokec3 	\cf4 \strokec4 ARDSetSeqSettings(ards)\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 Attempts,cmd=5,success=0\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ArduinoStr=\cf3 \strokec3  \cf7 \strokec7 "Waiting\cf3 \strokec3  \cf7 \strokec7 ...\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,outStr=\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 outStr,\cf7 \strokec7 "%d,%d,%d;"\cf4 \strokec4 ,cmd,pin,value\
\cf3 \strokec3 	\cf8 \strokec8 VDTOperationsPort2\cf3 \strokec3  \cf4 \strokec4 $ards.gWhichComStr1\
\cf3 \strokec3 	\cf9 \strokec9 do\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 VDT2\cf3 \strokec3  \cf4 \strokec4 killIO\
\cf3 \strokec3 		\cf8 \strokec8 VDTWrite2\cf4 \strokec4 /O=0.1\cf3 \strokec3  \cf4 \strokec4 outStr\
\cf3 \strokec3 		\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf4 \strokec4 ArduinoStr\
\cf3 \strokec3 		\cf4 \strokec4 ards.gVDT2Message=ArduinoStr\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 stringmatch\cf4 \strokec4 (ArduinoStr,\cf7 \strokec7 "*1,Analog\cf3 \strokec3  \cf7 \strokec7 cmd\cf3 \strokec3  \cf7 \strokec7 received*"\cf4 \strokec4 )==1)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Analog\cf3 \strokec3  \cf7 \strokec7 out\cf3 \strokec3  \cf7 \strokec7 sent\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,attempts\
\cf3 \strokec3 			\cf4 \strokec4 attempts=20\
\cf3 \strokec3 			\cf4 \strokec4 success=1\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 attempts+=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (attempts<20)\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (success!=1)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Failed\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 send\cf3 \strokec3  \cf7 \strokec7 Analog\cf3 \strokec3  \cf7 \strokec7 out\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,Attempts\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 -1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response,S_Response\
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response\cf3 \strokec3  																								\cf2 \strokec2 //;\cf3 \strokec3  \cf2 \strokec2 print\cf3 \strokec3  \cf2 \strokec2 S_response\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ArduinoDrive(speed,steps)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Optimum\cf3 \strokec3  \cf2 \strokec2 Speed:160\cf3 \strokec3  \cf2 \strokec2 @\cf3 \strokec3  \cf2 \strokec2 8V\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 speed,steps\
\cf3 \strokec3 	\cf9 \strokec9 STRUCT\cf3 \strokec3  \cf4 \strokec4 ArduinoSeqSettings\cf3 \strokec3  \cf4 \strokec4 ards\
\cf3 \strokec3 	\cf4 \strokec4 ARDSetSeqSettings(ards)\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 Attempts,cmd=15,success=0\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ArduinoStr=\cf3 \strokec3  \cf7 \strokec7 "Waiting\cf3 \strokec3  \cf7 \strokec7 ...\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,outStr=\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 outStr,\cf7 \strokec7 "%d,%d,%d;"\cf4 \strokec4 ,cmd,steps,speed\
\cf3 \strokec3 	\cf8 \strokec8 VDTOperationsPort2\cf3 \strokec3  \cf4 \strokec4 $ards.gWhichComStr1\
\cf3 \strokec3 	\cf9 \strokec9 do\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 VDT2\cf3 \strokec3  \cf4 \strokec4 killIO\
\cf3 \strokec3 		\cf8 \strokec8 VDTWrite2\cf4 \strokec4 /O=0.1\cf3 \strokec3  \cf4 \strokec4 outStr\
\cf3 \strokec3 		\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf4 \strokec4 ArduinoStr\
\cf3 \strokec3 		\cf4 \strokec4 ards.gVDT2Message=ArduinoStr\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 stringmatch\cf4 \strokec4 (ArduinoStr,\cf7 \strokec7 "*15,Motor\cf3 \strokec3  \cf7 \strokec7 Started*"\cf4 \strokec4 )==1)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Motor\cf3 \strokec3  \cf7 \strokec7 signal\cf3 \strokec3  \cf7 \strokec7 sent\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,attempts\
\cf3 \strokec3 			\cf4 \strokec4 attempts=20\
\cf3 \strokec3 			\cf4 \strokec4 success=1\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 attempts+=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (attempts<20)\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (success!=1)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Failed\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 send\cf3 \strokec3  \cf7 \strokec7 Motor\cf3 \strokec3  \cf7 \strokec7 signal\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,Attempts\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 -1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response,S_Response\
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response\
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 5+1*60*\cf6 \strokec6 abs\cf4 \strokec4 (steps)/48/speed\
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Function\cf3 \strokec3  \cf2 \strokec2 finished\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ArduinoDrive1(speed,steps)\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Optimum\cf3 \strokec3  \cf2 \strokec2 Speed:160\cf3 \strokec3  \cf2 \strokec2 @\cf3 \strokec3  \cf2 \strokec2 8V\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 speed,steps\
\cf3 \strokec3 	\cf9 \strokec9 STRUCT\cf3 \strokec3  \cf4 \strokec4 ArduinoSeqSettings\cf3 \strokec3  \cf4 \strokec4 ards\
\cf3 \strokec3 	\cf4 \strokec4 ARDSetSeqSettings(ards)\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 Attempts,cmd=18,success=0\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ArduinoStr=\cf3 \strokec3  \cf7 \strokec7 "Waiting\cf3 \strokec3  \cf7 \strokec7 ...\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,outStr=\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 outStr,\cf7 \strokec7 "%d,%d,%d;"\cf4 \strokec4 ,cmd,steps,speed\
\cf3 \strokec3 	\cf8 \strokec8 VDTOperationsPort2\cf3 \strokec3  \cf4 \strokec4 $ards.gWhichComStr1\
\cf3 \strokec3 	\cf9 \strokec9 do\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 VDT2\cf3 \strokec3  \cf4 \strokec4 killIO\
\cf3 \strokec3 		\cf8 \strokec8 VDTWrite2\cf4 \strokec4 /O=0.1\cf3 \strokec3  \cf4 \strokec4 outStr\
\cf3 \strokec3 		\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf4 \strokec4 ArduinoStr\
\cf3 \strokec3 		\cf4 \strokec4 ards.gVDT2Message=ArduinoStr\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 stringmatch\cf4 \strokec4 (ArduinoStr,\cf7 \strokec7 "*18,Motor\cf3 \strokec3  \cf7 \strokec7 Started*"\cf4 \strokec4 )==1)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Motor\cf3 \strokec3  \cf7 \strokec7 signal\cf3 \strokec3  \cf7 \strokec7 sent\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,attempts\
\cf3 \strokec3 			\cf4 \strokec4 attempts=20\
\cf3 \strokec3 			\cf4 \strokec4 success=1\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 attempts+=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (attempts<20)\cf3 \strokec3 		\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (success!=1)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 ards.gMessageStr,\cf7 \strokec7 "Failed\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 send\cf3 \strokec3  \cf7 \strokec7 Motor\cf3 \strokec3  \cf7 \strokec7 signal\cf3 \strokec3  \cf7 \strokec7 after\cf3 \strokec3  \cf7 \strokec7 %g\cf3 \strokec3  \cf7 \strokec7 attempts"\cf4 \strokec4 ,Attempts\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 -1\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response,S_Response\
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response;\cf3 \strokec3  \cf8 \strokec8 print\cf3 \strokec3  \cf4 \strokec4 S_Response\
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 5+1*60*\cf6 \strokec6 abs\cf4 \strokec4 (steps)/48/speed\
\cf3 \strokec3 	\cf8 \strokec8 VDTRead2\cf4 \strokec4 /N=255/O=0.1/Q/T=\cf7 \strokec7 "\\r"\cf3 \strokec3  \cf4 \strokec4 S_Response;\cf3 \strokec3  \cf8 \strokec8 print\cf3 \strokec3  \cf4 \strokec4 S_Response\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Function\cf3 \strokec3  \cf2 \strokec2 finished\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 end\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Init()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "File"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Save\cf3 \strokec3  \cf7 \strokec7 Experiment"\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "File"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Save\cf3 \strokec3  \cf7 \strokec7 Experiment\cf3 \strokec3  \cf7 \strokec7 As"\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "File"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Save\cf3 \strokec3  \cf7 \strokec7 Experiment\cf3 \strokec3  \cf7 \strokec7 Copy"\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "File"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Revert\cf3 \strokec3  \cf7 \strokec7 Experiment"\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Edit"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Data"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,disableAllItems\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Analysis"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Windows"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Procedure\cf3 \strokec3  \cf7 \strokec7 Windows"\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Windows"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Panel\cf3 \strokec3  \cf7 \strokec7 Macros"\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Misc"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Table"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Procedure"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,disableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Panel"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,disableItem\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Antidote()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "File"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "File"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Save\cf3 \strokec3  \cf7 \strokec7 Experiment"\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "File"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Save\cf3 \strokec3  \cf7 \strokec7 Experiment\cf3 \strokec3  \cf7 \strokec7 As"\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "File"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Save\cf3 \strokec3  \cf7 \strokec7 Experiment\cf3 \strokec3  \cf7 \strokec7 Copy"\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "File"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Revert\cf3 \strokec3  \cf7 \strokec7 Experiment"\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Edit"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Data"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,enableAllItems\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Analysis"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Windows"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Procedure\cf3 \strokec3  \cf7 \strokec7 Windows"\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Windows"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Layout\cf3 \strokec3  \cf7 \strokec7 Macros"\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Windows"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 "Panel\cf3 \strokec3  \cf7 \strokec7 Macros"\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Misc"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Table"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Procedure"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,enableItem\
\cf3 \strokec3 	\cf8 \strokec8 SetIgorMenuMode\cf3 \strokec3  \cf7 \strokec7 "Panel"\cf4 \strokec4 ,\cf3 \strokec3  \cf7 \strokec7 ""\cf4 \strokec4 ,enableItem\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SetupGPIBKeithley()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 gpib_bus,sourcemeter,boardindex\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 V_Flag\
\cf3 \strokec3 	\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibfind=\{\cf7 \strokec7 "gpib0"\cf4 \strokec4 \};\cf3 \strokec3  \cf4 \strokec4 gpib_bus=V_flag;\cf3 \strokec3  \cf4 \strokec4 boardindex=7&V_Flag\
\cf3 \strokec3 	\cf8 \strokec8 GPIB2\cf3 \strokec3  \cf4 \strokec4 board=gpib_bus\
\cf3 \strokec3 	\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibsic=\{gpib_bus\}\
\cf3 \strokec3 	\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibln=\{gpib_bus,24,0\}\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Address\cf3 \strokec3  \cf2 \strokec2 24\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag==0)\
\cf3 \strokec3 		\cf8 \strokec8 abort\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 No\cf3 \strokec3  \cf7 \strokec7 Keithley\cf3 \strokec3  \cf7 \strokec7 SourceMeter\cf3 \strokec3  \cf7 \strokec7 at\cf3 \strokec3  \cf7 \strokec7 this\cf3 \strokec3  \cf7 \strokec7 address.\cf3 \strokec3  \cf7 \strokec7 Check\cf3 \strokec3  \cf7 \strokec7 power\cf3 \strokec3  \cf7 \strokec7 and\cf3 \strokec3  \cf7 \strokec7 cables"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibdev=\{boardindex,24,0,12,1,0\};\cf3 \strokec3  \cf4 \strokec4 sourceMeter=V_Flag\
\cf3 \strokec3 	\cf8 \strokec8 GPIB2\cf3 \strokec3  \cf4 \strokec4 device=SourceMeter\
\cf3 \strokec3 	\cf8 \strokec8 GPIB2\cf3 \strokec3  \cf4 \strokec4 InterfaceClear\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 "*RST;*CLS"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "USB1\cf3 \strokec3  \cf7 \strokec7 GPIB:"\cf4 \strokec4 ,sourceMeter;\cf3 \strokec3  \cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibtmo=\{sourcemeter,12\}\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 12:-\cf3 \strokec3  \cf2 \strokec2 3s\cf3 \strokec3  \cf2 \strokec2 timeout\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 "*ESE\cf3 \strokec3  \cf7 \strokec7 255;*SRE\cf3 \strokec3  \cf7 \strokec7 48"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 SRQ\cf3 \strokec3  \cf2 \strokec2 &\cf3 \strokec3  \cf2 \strokec2 MAV\cf3 \strokec3  \cf2 \strokec2 registers\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC:CONC\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Turn\cf3 \strokec3  \cf2 \strokec2 off\cf3 \strokec3  \cf2 \strokec2 concurrent\cf3 \strokec3  \cf2 \strokec2 functions\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 'CURR:DC'"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 sense\cf3 \strokec3  \cf2 \strokec2 function\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 0.0001"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 100uA\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 Command(":SOUR:FUNC:MODE\cf3 \strokec3  \cf2 \strokec2 VOLT")\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 by\cf3 \strokec3  \cf2 \strokec2 default\cf3 \strokec3  \cf2 \strokec2 on\cf3 \strokec3  \cf2 \strokec2 Power\cf3 \strokec3  \cf2 \strokec2 On\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:MODE\cf3 \strokec3  \cf7 \strokec7 FIX"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fixed\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:ELEM\cf3 \strokec3  \cf7 \strokec7 VOLT,CURR"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Data\cf3 \strokec3  \cf2 \strokec2 output\cf3 \strokec3  \cf2 \strokec2 format\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:BORD\cf3 \strokec3  \cf7 \strokec7 SWAP"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Intel\cf3 \strokec3  \cf2 \strokec2 Byte\cf3 \strokec3  \cf2 \strokec2 Order\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:DATA\cf3 \strokec3  \cf7 \strokec7 REAL,32"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Binary\cf3 \strokec3  \cf2 \strokec2 output\cf3 \strokec3  \cf2 \strokec2 format:\cf3 \strokec3  \cf2 \strokec2 IEEE\cf3 \strokec3  \cf2 \strokec2 32\cf3 \strokec3  \cf2 \strokec2 bit\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:CLE:AUTO\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Auto\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON/OFF\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 0.04"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 40\cf3 \strokec3  \cf2 \strokec2 ms\cf3 \strokec3  \cf2 \strokec2 source\cf3 \strokec3  \cf2 \strokec2 delay\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR2:TTL:LEV\cf3 \strokec3  \cf7 \strokec7 0"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 Auxillary\cf3 \strokec3  \cf2 \strokec2 TTL\cf3 \strokec3  \cf2 \strokec2 output\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SYST:BEEP:STAT\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Turn\cf3 \strokec3  \cf2 \strokec2 OFF\cf3 \strokec3  \cf2 \strokec2 beeper\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Command(cmd)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf4 \strokec4 SRQSourceMeter(1)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 SRQSourceMeter(flg)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 flg\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 sourcemeter\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,err,status,mask,V_Flag\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\};\cf3 \strokec3  \cf4 \strokec4 status=V_Flag\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((status%&32)==32)\
\cf3 \strokec3 		\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 "*ESR?"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 GPIBRead2\cf3 \strokec3  \cf4 \strokec4 err\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 GPIBRead2/Q/T="\\n"\cf3 \strokec3  \cf2 \strokec2 err\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((err%&1)==1)\
\cf3 \strokec3 				\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "End\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Data\cf3 \strokec3  \cf7 \strokec7 Acquisition"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((err%&4)==4)\
\cf3 \strokec3 				\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Query\cf3 \strokec3  \cf7 \strokec7 Error"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((err%&8)==8)\
\cf3 \strokec3 				\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Device\cf3 \strokec3  \cf7 \strokec7 Error"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((err%&16)==16)\
\cf3 \strokec3 				\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Execution\cf3 \strokec3  \cf7 \strokec7 Error"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((err%&32)==32)\
\cf3 \strokec3 				\cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Command\cf3 \strokec3  \cf7 \strokec7 Error"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((err%&128)==128)\
\cf3 \strokec3 				\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 "*IDN?"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 GPIBRead2\cf3 \strokec3  \cf4 \strokec4 S_response;\cf3 \strokec3  \cf8 \strokec8 print\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (err!=0)\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((status%&16)==16)\
\cf3 \strokec3 			\cf8 \strokec8 GPIBRead2\cf3 \strokec3  \cf4 \strokec4 S_response;\cf3 \strokec3  \cf8 \strokec8 print\cf3 \strokec3  \cf6 \strokec6 strlen\cf4 \strokec4 (S_response),S_response\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((status%&4)==4)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Read\cf3 \strokec3  \cf2 \strokec2 the\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":SYST:ERR?"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 GPIBRead2\cf4 \strokec4 /Q/T=\cf7 \strokec7 "\\n"\cf3 \strokec3  \cf4 \strokec4 S_response;\cf3 \strokec3  \cf8 \strokec8 print\cf3 \strokec3  \cf7 \strokec7 "Error\cf3 \strokec3  \cf7 \strokec7 number:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,S_response\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 ((flg!=1)|(status>8))\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ReadResponse(maxChars)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 maxChars\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /Q/S=(maxChars)/T=\cf7 \strokec7 "\'95"\cf3 \strokec3  \cf4 \strokec4 S_response\
\cf3 \strokec3 	\cf8 \strokec8 print\cf3 \strokec3  \cf6 \strokec6 strlen\cf4 \strokec4 (S_response),S_response\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ReadData(flg)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 0:-\cf3 \strokec3  \cf2 \strokec2 Voltage\cf3 \strokec3  \cf2 \strokec2 value,\cf3 \strokec3  \cf2 \strokec2 1:-\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf2 \strokec2 value\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 flg\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 sourcemeter\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a,b,v0,v1,n\
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":READ?"\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 consider\cf3 \strokec3  \cf2 \strokec2 GPIBWrite2\cf3 \strokec3  \cf2 \strokec2 ":READ?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\}\
\cf3 \strokec3 		\cf8 \strokec8 sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 0.1\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag>63)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 ((status%&64)==64)\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 v0,v1;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 (flg)?v1\cf3 \strokec3  \cf4 \strokec4 :v0\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ReadDataT()\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf2 \strokec2 &\cf3 \strokec3  \cf2 \strokec2 Time\cf3 \strokec3  \cf2 \strokec2 values\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Datawave\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 sourcemeter\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a,b,v0,v1,n\
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":READ?"\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 consider\cf3 \strokec3  \cf2 \strokec2 GPIBWrite2\cf3 \strokec3  \cf2 \strokec2 ":READ?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\}\
\cf3 \strokec3 		\cf8 \strokec8 sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 0.1\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag>63)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 ((status%&64)==64)\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 v0,v1;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\
\cf3 \strokec3 	\cf4 \strokec4 DataWave=\{v0,v1\}\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 ReadDataWave(cellarea,sense,source,bias)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 cellarea,bias;\cf3 \strokec3  \cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 sense,source\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Datawave,transient0,transient4,transient5\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_numCell,V_numpnts,sourcemeter\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b,n;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(2*V_numpnts)\cf3 \strokec3  \cf4 \strokec4 Datawave;\cf3 \strokec3  \cf8 \strokec8 Redimension\cf4 \strokec4 /N=(V_numpnts)\cf3 \strokec3  \cf4 \strokec4 transient0,transient4,transient5;\cf3 \strokec3  \cf4 \strokec4 transient0=0\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":STAT:MEAS:ENAB\cf3 \strokec3  \cf7 \strokec7 512"\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 SRQ\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 "*SRE\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":FORM:ELEM\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +sense+\cf7 \strokec7 ",TIME"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 format\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:FUNC\cf3 \strokec3  \cf7 \strokec7 '"\cf4 \strokec4 +sense+\cf7 \strokec7 ":DC'"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Define\cf3 \strokec3  \cf2 \strokec2 sense\cf3 \strokec3  \cf2 \strokec2 function\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:FUNC:MODE\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +source)\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:"\cf4 \strokec4 +source+\cf7 \strokec7 ":MODE\cf3 \strokec3  \cf7 \strokec7 FIX;:SOUR:DEL\cf3 \strokec3  \cf7 \strokec7 0.01"\cf4 \strokec4 )\cf3 \strokec3 																						\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Fixed\cf3 \strokec3  \cf2 \strokec2 operation\cf3 \strokec3  \cf2 \strokec2 mode\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 a=\cf6 \strokec6 min\cf4 \strokec4 (1,\cf6 \strokec6 ceil\cf4 \strokec4 (32*cellarea)/1e3)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Check\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 max\cf3 \strokec3  \cf2 \strokec2 Compliance\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!\cf6 \strokec6 CmpStr\cf4 \strokec4 (sense,\cf7 \strokec7 "CURR"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:VOLT:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (bias))\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:CURR:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a))\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 current\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 		\cf2 \strokec2 Command(":SENS:CURR:RANGE:UPP\cf3 \strokec3  \cf2 \strokec2 10e-3")\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SOUR:CURR:LEV:IMM:AMPL\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (bias))\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:VOLT:PROT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numCell*1))\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Set\cf3 \strokec3  \cf2 \strokec2 voltage\cf3 \strokec3  \cf2 \strokec2 compliance\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:VOLT:RANGE:UPP\cf3 \strokec3  \cf7 \strokec7 1"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":SENS:"\cf4 \strokec4 +sense+\cf7 \strokec7 ":NPLC\cf3 \strokec3  \cf7 \strokec7 0.28"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:CLE"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:POIN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numpnts)+\cf7 \strokec7 ";:TRIG:COUN\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_numpnts))\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":TRAC:FEED:CONT\cf3 \strokec3  \cf7 \strokec7 NEXT"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":DISP:ENAB\cf3 \strokec3  \cf7 \strokec7 OFF"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":OUTP:STAT\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Switch\cf3 \strokec3  \cf2 \strokec2 Output\cf3 \strokec3  \cf2 \strokec2 ON\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Sleep\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 5\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":INIT"\cf4 \strokec4 )\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Start\cf3 \strokec3  \cf2 \strokec2 measurements\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 NI4882\cf3 \strokec3  \cf4 \strokec4 ibrsp=\{sourcemeter\}\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_flag>32)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 ((status%&32)==32)\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (1)\
\cf3 \strokec3 	\cf8 \strokec8 GPIBWrite2\cf3 \strokec3  \cf7 \strokec7 ":TRAC:DATA?"\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 consider\cf3 \strokec3  \cf2 \strokec2 GPIBWrite2\cf3 \strokec3  \cf2 \strokec2 ":READ?"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a,b;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinaryWave2\cf4 \strokec4 /TYPE=2\cf3 \strokec3  \cf4 \strokec4 Datawave;\cf3 \strokec3  \cf8 \strokec8 GPIBReadBinary2\cf4 \strokec4 /TYPE=8\cf3 \strokec3  \cf4 \strokec4 a\cf3 \strokec3 													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 IEEE\cf3 \strokec3  \cf2 \strokec2 Single\cf3 \strokec3  \cf2 \strokec2 precision\cf3 \strokec3  \cf2 \strokec2 Floating\cf3 \strokec3  \cf2 \strokec2 point\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 FlushKeithley()\
\cf3 \strokec3 	\cf4 \strokec4 Command(\cf7 \strokec7 ":DISP:ENAB\cf3 \strokec3  \cf7 \strokec7 ON"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf4 \strokec4 transient4=Datawave[2*p];\cf3 \strokec3  \cf4 \strokec4 transient5=Datawave[2*p+1]\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 p1=transient5[0],p2=transient5[V_numpnts-1]\
\cf3 \strokec3 	\cf8 \strokec8 Interpolate2\cf4 \strokec4 /T=1/N=(V_numpnts)/Y=transient0\cf3 \strokec3  \cf4 \strokec4 transient5,transient4\
\cf3 \strokec3 	\cf8 \strokec8 SetScale\cf4 \strokec4 /I\cf3 \strokec3  \cf4 \strokec4 x\cf3 \strokec3  \cf4 \strokec4 p1,p2,\cf7 \strokec7 "s"\cf3 \strokec3  \cf4 \strokec4 transient0;\cf3 \strokec3  \cf8 \strokec8 WaveStats\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 transient0\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str\cf7 \strokec7 "IT:%g;LP:%s"\cf3 \strokec3  \cf4 \strokec4 0.5,\cf7 \strokec7 "Xelamp"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Note\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 transient0,str\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 V_avg\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //////////////////////////////////////////////////////\cf3 \strokec3  \cf2 \strokec2 GRAPHS\cf3 \strokec3  \cf2 \strokec2 ///////////////////////////////////////////////////////\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 IVGraph()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Display/K=1/W=(4,276,720,512)\cf3 \strokec3  \cf7 \strokec7 %s\cf3 \strokec3  \cf7 \strokec7 as\cf3 \strokec3  \cf7 \strokec7 \\"I-V\cf3 \strokec3  \cf7 \strokec7 characteristic\\""\cf4 \strokec4 ,allwaves\
\cf3 \strokec3 	\cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 zero(left)=1,mirror(left)=2,lblMargin(right)=56,mirror(bottom)=2\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle(PhotoCurrent0)=0,lstyle(PhotoCurrent1)=2,lstyle(PhotoCurrent2)=3,lstyle(PhotoCurrent3)=4,lstyle(PhotoCurrent4)=5,lstyle(PhotoCurrent5)=6,lstyle(PhotoCurrent6)=7\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle(darkcurrent)=0,rgb(darkcurrent)=(0,65535,0)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Current\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Potential\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /N=textL/J/F=0/A=MC/X=60/Y=0\cf3 \strokec3  \cf4 \strokec4 Legendtext(allwaves,1)\
\cf3 \strokec3 	\cf8 \strokec8 SetWindow\cf3 \strokec3  \cf4 \strokec4 kwTopWin,hook=UpdateDisplay\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 UpdateDisplay(infoStr)\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Use\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 control\cf3 \strokec3  \cf2 \strokec2 parameters,\cf3 \strokec3  \cf2 \strokec2 dependencies\cf3 \strokec3  \cf2 \strokec2 etc.\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 infoStr\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 StrSearch\cf4 \strokec4 (infoStr,\cf7 \strokec7 "EVENT:activate;"\cf4 \strokec4 ,0)\cf3 \strokec3  \cf4 \strokec4 >\cf3 \strokec3  \cf4 \strokec4 0\cf3 \strokec3  \cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 StrSearch\cf4 \strokec4 (infoStr,\cf7 \strokec7 "EVENT:kill;"\cf4 \strokec4 ,0)\cf3 \strokec3  \cf4 \strokec4 >\cf3 \strokec3  \cf4 \strokec4 0\cf3 \strokec3  \cf4 \strokec4 )\
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 TransientCGraph;\cf3 \strokec3  \cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 GraphHysteresis;\cf3 \strokec3  \cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 GraphStability\
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 CellStability()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Currents\cf3 \strokec3  \cf2 \strokec2 now\cf3 \strokec3  \cf2 \strokec2 all\cf3 \strokec3  \cf2 \strokec2 +ve\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,i;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 s,s1=\cf7 \strokec7 "\\Z12\\f01\\s"\cf4 \strokec4 ,w\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s,\cf7 \strokec7 "Display/W=(4,276,720,616)\cf3 \strokec3  \cf7 \strokec7 %s\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 Input0\cf3 \strokec3  \cf7 \strokec7 as\cf3 \strokec3  \cf7 \strokec7 \\"Cell\cf3 \strokec3  \cf7 \strokec7 Stability\cf3 \strokec3  \cf7 \strokec7 with\cf3 \strokec3  \cf7 \strokec7 time\\""\cf4 \strokec4 ,\cf6 \strokec6 ReplaceString\cf4 \strokec4 (\cf7 \strokec7 ";"\cf4 \strokec4 ,allspectra,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 s\
\cf3 \strokec3 	\cf4 \strokec4 GraphOverlayStyle()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 gbRGB=(61166,61166,61166)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=1\cf3 \strokec3  \cf4 \strokec4 bottom;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Time\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 BarGraph()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 flg,n,npt;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 cmd,s0,s1=\cf7 \strokec7 "\\Z12\\s"\cf4 \strokec4 ,title,w\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 w=\cf6 \strokec6 StringfromList\cf4 \strokec4 (n,allspectra);\cf3 \strokec3  \cf4 \strokec4 npt=\cf6 \strokec6 str2num\cf4 \strokec4 (w[5])-1\
\cf3 \strokec3 		\cf4 \strokec4 flg=\cf6 \strokec6 CmpStr\cf4 \strokec4 (w,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flg)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s%s,"\cf4 \strokec4 ,s0,w\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s1,\cf7 \strokec7 "%s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r\\s"\cf4 \strokec4 ,s1,w,\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "TITLE"\cf4 \strokec4 ,\cf6 \strokec6 TableInfo\cf4 \strokec4 (\cf7 \strokec7 "Table1"\cf4 \strokec4 ,npt+2))\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 title,\cf7 \strokec7 "%s%s,\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,title,\cf6 \strokec6 StringByKey\cf4 \strokec4 (\cf7 \strokec7 "TITLE"\cf4 \strokec4 ,\cf6 \strokec6 TableInfo\cf4 \strokec4 (\cf7 \strokec7 "Table1"\cf4 \strokec4 ,npt+2))\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<\cf6 \strokec6 ItemsinList\cf4 \strokec4 (allspectra))\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 cmd,\cf7 \strokec7 "Display/K=1/W=(4,276,720,616)\cf3 \strokec3  \cf7 \strokec7 %s\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 InputText\cf3 \strokec3  \cf7 \strokec7 as\cf3 \strokec3  \cf7 \strokec7 \\"BarGraph\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 %s\\""\cf4 \strokec4 ,s0[0,\cf6 \strokec6 strlen\cf4 \strokec4 (s0)-2],InputText[0];\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 cmd\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 gbRGB=(61166,61166,61166)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 rgb(Input1)=(56000,0,8000),rgb(Input2)=(48000,0,16000),rgb(Input3)=(40000,0,24000),rgb(Input4)=(32000,0,32000),rgb(Input5)=(24000,0,40000),rgb(Input6)=(16000,0,48000),rgb(Input7)=(8000,0,56000)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 hbFill=2,mirror=2,grid(left)=2,gridstyle(left)=1,fSize(left)=12,tkLblRot(bottom)=90\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=1/N=1\cf3 \strokec3  \cf4 \strokec4 left\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01"\cf4 \strokec4 +S_yaxislabel;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01"\cf4 \strokec4 +S_xaxislabel\
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /N=text0/J/B=1/F=0/A=LC/X=1/Y=-42\cf3 \strokec3  \cf4 \strokec4 s1[0,\cf6 \strokec6 strlen\cf4 \strokec4 (s1)-4]\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 Legendtext(allwaves,m)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 also\cf3 \strokec3  \cf2 \strokec2 Updates\cf3 \strokec3  \cf2 \strokec2 Ref\cf3 \strokec3  \cf2 \strokec2 diode\cf3 \strokec3  \cf2 \strokec2 values\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 allwaves;\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 m\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVparams\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n,m1,flag;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str,s0,s1,s2,list=\cf7 \strokec7 "\\Z09;\\Z09;\\Z09;\\Z10Voltage\cf3 \strokec3  \cf7 \strokec7 decay:\\r;\\Z10Capacitance:\\r;\\Z10Transistor:\\r;\\Z10Scan\cf3 \strokec3  \cf7 \strokec7 Rates:\\r\\s(PhotoCurrentHR_0)\cf3 \strokec3  \cf7 \strokec7 Backward\\s(PhotoCurrentHF_0)\cf3 \strokec3  \cf7 \strokec7 Forward\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 s0=\cf6 \strokec6 StringfromList\cf4 \strokec4 (m-1,list);\cf3 \strokec3  \cf4 \strokec4 s1=\cf6 \strokec6 SelectString\cf4 \strokec4 (m==4,\cf7 \strokec7 ""\cf4 \strokec4 ,\cf7 \strokec7 "Transport\cf3 \strokec3  \cf7 \strokec7 lifetime\cf3 \strokec3  \cf7 \strokec7 II:\\r"\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 s2=\cf6 \strokec6 SelectString\cf4 \strokec4 (m==4,\cf7 \strokec7 ""\cf4 \strokec4 ,\cf7 \strokec7 "Transport\cf3 \strokec3  \cf7 \strokec7 lifetime:\\r"\cf4 \strokec4 )\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 str=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 )\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Array\cf3 \strokec3  \cf2 \strokec2 counter\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 flag=\cf6 \strokec6 CmpStr\cf4 \strokec4 (str,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flag)\
\cf3 \strokec3 			\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (m)\
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\
\cf3 \strokec3 				\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 cmpstr\cf4 \strokec4 (\cf7 \strokec7 "DarkCurrent"\cf4 \strokec4 ,str)==0)\
\cf3 \strokec3 					\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 DarkCurrent\cf3 \strokec3  \cf7 \strokec7 \\r"\cf4 \strokec4 ,s0,str\
\cf3 \strokec3 				\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 					\cf4 \strokec4 m1=12*\cf6 \strokec6 str2num\cf4 \strokec4 (str[\cf6 \strokec6 strlen\cf4 \strokec4 (str)-1,\cf6 \strokec6 strlen\cf4 \strokec4 (str)])+1\
\cf3 \strokec3 					\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 Current\cf3 \strokec3  \cf7 \strokec7 @%.3f\cf3 \strokec3  \cf7 \strokec7 Sun\\r"\cf4 \strokec4 ,s0,str,10*IVparams[m1][V_supos+1]\
\cf3 \strokec3 				\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\
\cf3 \strokec3 				\cf4 \strokec4 m1=12*\cf6 \strokec6 str2num\cf4 \strokec4 (str[\cf6 \strokec6 strlen\cf4 \strokec4 (str)-1,\cf6 \strokec6 strlen\cf4 \strokec4 (str)])+1\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r"\cf4 \strokec4 ,s0,str,str[0]+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +str[1,\cf6 \strokec6 strlen\cf4 \strokec4 (str)]\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 3:\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Deffs\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r"\cf4 \strokec4 ,s0,str,str[0]+\cf7 \strokec7 "\\B"\cf4 \strokec4 +str[1,3]+\cf7 \strokec7 "\\M\\Z09"\cf4 \strokec4 +str[4,\cf6 \strokec6 strlen\cf4 \strokec4 (str)]\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 4:\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Voltage\cf3 \strokec3  \cf2 \strokec2 &\cf3 \strokec3  \cf2 \strokec2 Current\cf3 \strokec3  \cf2 \strokec2 Decays\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 mod\cf4 \strokec4 (n,3))\
\cf3 \strokec3 				\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 0:\
\cf3 \strokec3 					\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r"\cf4 \strokec4 ,s0,\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (str),str[6,\cf6 \strokec6 strlen\cf4 \strokec4 (str)]\
\cf3 \strokec3 					\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\
\cf3 \strokec3 					\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s1,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r"\cf4 \strokec4 ,s1,\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (str),str[6,\cf6 \strokec6 strlen\cf4 \strokec4 (str)]\
\cf3 \strokec3 					\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\
\cf3 \strokec3 					\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s2,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r"\cf4 \strokec4 ,s2,\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (str),str[6,\cf6 \strokec6 strlen\cf4 \strokec4 (str)]\
\cf3 \strokec3 					\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 5:\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Capacitance\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r"\cf4 \strokec4 ,s0,\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (str),str[6,\cf6 \strokec6 strlen\cf4 \strokec4 (str)]\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 6:\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Transistor\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 m1=12*\cf6 \strokec6 str2num\cf4 \strokec4 (str[\cf6 \strokec6 strlen\cf4 \strokec4 (str)-1,\cf6 \strokec6 strlen\cf4 \strokec4 (str)])\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%s\\s(%s)\cf3 \strokec3  \cf7 \strokec7 Current\cf3 \strokec3  \cf7 \strokec7 @%.1f\cf3 \strokec3  \cf7 \strokec7 Gate\\r"\cf4 \strokec4 ,s0,str,IVparams[m1][V_supos+1]\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 7:\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Hysterisis\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 m1=12*\cf6 \strokec6 str2num\cf4 \strokec4 (str[\cf6 \strokec6 strlen\cf4 \strokec4 (str)-1,\cf6 \strokec6 strlen\cf4 \strokec4 (str)])+1\cf3 \strokec3 				\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "\\s(%s)\cf3 \strokec3  \cf7 \strokec7 Backward\cf3 \strokec3  \cf7 \strokec7 Sweep\\r\\s(%s)\cf3 \strokec3  \cf7 \strokec7 Forward\cf3 \strokec3  \cf7 \strokec7 Sweep"\cf4 \strokec4 ,\cf7 \strokec7 "PhotoCurrent0"\cf4 \strokec4 ,\cf7 \strokec7 "PhotoCurrent1"\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endswitch\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (flag)\
\cf3 \strokec3 	\cf4 \strokec4 s0=s0+s1+s2\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 s0[0,\cf6 \strokec6 strlen\cf4 \strokec4 (s0)-2]\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Remove\cf3 \strokec3  \cf2 \strokec2 CR\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 TranslateDate(s)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Translate\cf3 \strokec3  \cf2 \strokec2 date\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 list=\cf7 \strokec7 "Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec;"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 p1=\cf6 \strokec6 strsearch\cf4 \strokec4 (s,\cf7 \strokec7 "/"\cf4 \strokec4 ,0)+1,p2=\cf6 \strokec6 strsearch\cf4 \strokec4 (s,\cf7 \strokec7 ",\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,0),p3=\cf6 \strokec6 strsearch\cf4 \strokec4 (s,\cf7 \strokec7 ",\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,p2+1)\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (p1==-1)\
\cf3 \strokec3 		\cf8 \strokec8 beep\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 month=s[p2+2,p2+4],year=s[p3+2,p1-2];\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 day=\cf6 \strokec6 str2num\cf4 \strokec4 (s[p2+5,p3-1])\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf6 \strokec6 date2secs\cf4 \strokec4 (\cf6 \strokec6 str2num\cf4 \strokec4 (year),\cf6 \strokec6 WhichListItem\cf4 \strokec4 (month,list)+1,day)\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 secs\cf3 \strokec3  \cf2 \strokec2 from\cf3 \strokec3  \cf2 \strokec2 1/1/1904\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf4 \strokec4 /S\cf3 \strokec3  \cf4 \strokec4 WaveChoice(allwaves,type)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 allwaves;\cf3 \strokec3  \cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 type\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 IVParams\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n,m1,flg;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str,s0=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 str=\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf4 \strokec4 m1=12*\cf6 \strokec6 str2num\cf4 \strokec4 (str[\cf6 \strokec6 strlen\cf4 \strokec4 (str)-1,\cf6 \strokec6 strlen\cf4 \strokec4 (str)])+1\cf3 \strokec3 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Array\cf3 \strokec3  \cf2 \strokec2 counter\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 flg=\cf6 \strokec6 CmpStr\cf4 \strokec4 (str,\cf7 \strokec7 ""\cf4 \strokec4 )\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (flg)\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 numtype\cf4 \strokec4 (m1))\
\cf3 \strokec3 				\cf4 \strokec4 s0=\cf7 \strokec7 "DarkCurrent;"\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%sCellCurrent\cf3 \strokec3  \cf7 \strokec7 @%.3f\cf3 \strokec3  \cf7 \strokec7 Sun;"\cf4 \strokec4 ,s0,10*IVParams[m1][V_supos]\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Add\cf3 \strokec3  \cf2 \strokec2 attenuation\cf3 \strokec3  \cf2 \strokec2 value\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (type)\
\cf3 \strokec3 					\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "%sPhotoCurrent\cf3 \strokec3  \cf7 \strokec7 @%.3f\cf3 \strokec3  \cf7 \strokec7 Sun;"\cf4 \strokec4 ,s0,10*IVParams[m1][V_supos]\
\cf3 \strokec3 				\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (flg)\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 s0\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 TransientCGraph()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(4,280,720,516)\cf3 \strokec3  \cf4 \strokec4 transient0,transient1,transient2,transient3,transient4,transient5,transient6\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "PhotoCurrent\cf3 \strokec3  \cf7 \strokec7 Dynamics"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendtoGraph\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 ywav\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 zero(left)=1,mirror(left)=2,tick(top)=3,grid(top)=0,noLabel(top)=2\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle=3,lstyle(transient0)=0,lsize(transient0)=1,rgb=(0,0,65535),rgb(transient0)=(65535,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle(ywav)=2,rgb(ywav)=(0,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=0/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Current\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Time\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 TransientVGraph()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(4,280,720,516)\cf3 \strokec3  \cf4 \strokec4 transient0\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "PhotoVoltage\cf3 \strokec3  \cf7 \strokec7 Dynamics"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendtoGraph\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 ywav\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 zero(left)=1,mirror(left)=2,tick(top)=3,grid(top)=0,noLabel(top)=2\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle=0,lsize=1,rgb=(65535,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle(ywav)=2,rgb(ywav)=(0,0,0)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=0\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Voltage\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Time\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 IPCEGraph()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /W=(4,284,720,520)\cf3 \strokec3  \cf4 \strokec4 ipce_t\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Transient\cf3 \strokec3  \cf7 \strokec7 IPCE"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Append\cf4 \strokec4 /R\cf3 \strokec3  \cf4 \strokec4 Photodiode\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 grid(right)=0,zero(left)=1,lblMargin(right)=56,rgb(Photodiode)=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=0/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 right;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01PhotoCurrent\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01PhotoDiode\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Time\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /N=text0/J/F=0/A=MC/X=64/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\s(PhotoDiode)\cf3 \strokec3  \cf7 \strokec7 PhotoDiode\\r\\s(ipce_t)\cf3 \strokec3  \cf7 \strokec7 IPCE"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetWindow\cf3 \strokec3  \cf4 \strokec4 kwTopWin,hook=UpdateDisplay1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 UpdateDisplay1(infoStr)\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Use\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 control\cf3 \strokec3  \cf2 \strokec2 parameters,\cf3 \strokec3  \cf2 \strokec2 dependencies\cf3 \strokec3  \cf2 \strokec2 etc.\cf4 \strokec4 \
\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 infoStr\
\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 StrSearch\cf4 \strokec4 (infoStr,\cf7 \strokec7 "EVENT:kill;"\cf4 \strokec4 ,0)\cf3 \strokec3  \cf4 \strokec4 >\cf3 \strokec3  \cf4 \strokec4 0\cf3 \strokec3  \cf4 \strokec4 )\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /K\cf3 \strokec3  \cf4 \strokec4 IPCEPlot\
\cf3 \strokec3 	\cf9 \strokec9 return\cf3 \strokec3  \cf4 \strokec4 0\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 endif\cf4 \strokec4 \
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 PhotoResponse()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(4,40,608,300)\cf3 \strokec3  \cf4 \strokec4 intensity\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Photo\cf3 \strokec3  \cf7 \strokec7 Response"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Append\cf4 \strokec4 /R=right\cf3 \strokec3  \cf4 \strokec4 photocurrent\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 grid(right)=0,rgb(photocurrent)=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=1\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=1\cf3 \strokec3  \cf4 \strokec4 right\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Thermopile\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Cellcurrent\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Wavelength\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /J/N=text0/F=0/A=MC/X=64/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\s(intensity)\cf3 \strokec3  \cf7 \strokec7 Thermopile\\r\\s(photocurrent)\cf3 \strokec3  \cf7 \strokec7 CellCurrent"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 IPCEPlot()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(4,300,608,482)\cf3 \strokec3  \cf4 \strokec4 ipce\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "IPCE"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 mirror=2\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,0,90\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01IPCE\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Wavelength\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Potentiostat()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /W=(4,276,668,512)\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,PhotoCurrent1\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Potentiostat"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lsize[0]=2,rgb(PhotoCurrent1)=(0,65535,0)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Current\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Potential\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /N=text0/J/F=0/A=MC/X=62/Y=-36\cf3 \strokec3  \cf7 \strokec7 "\\s(PhotoCurrent)\cf3 \strokec3  \cf7 \strokec7 Forward\cf3 \strokec3  \cf7 \strokec7 Sweep\\r\\s(PhotoCurrent1)\cf3 \strokec3  \cf7 \strokec7 Backward\cf3 \strokec3  \cf7 \strokec7 Sweep"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 GraphTStability()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /W=(12,276,616,616)\cf3 \strokec3  \cf4 \strokec4 Input1,Input3\
\cf3 \strokec3 	\cf8 \strokec8 Append\cf4 \strokec4 /R\cf3 \strokec3  \cf4 \strokec4 Input0,Input2;\cf3 \strokec3  \cf8 \strokec8 Append\cf4 \strokec4 /L=ref\cf3 \strokec3  \cf4 \strokec4 Input4\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 axisEnab(left)=\{0,0.78\},axisEnab(right)=\{0,0.78\},axisEnab(ref)=\{0.8,1\}\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 grid(right)=0,zero(left)=1,lblMargin(right)=56,mirror(bottom)=2\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 freePos(ref)=0,zero(ref)=1,lblPos(ref)=54,mirror(ref)=1\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 rgb(Input1)=(0,0,65535),rgb(Input3)=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 lstyle(Input2)=2,lstyle(Input3)=3\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=1/N=1/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=1/N=1\cf3 \strokec3  \cf4 \strokec4 right;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/E=1\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Current\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Voltage\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Time\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 ref\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Thermopile\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /N=text0/J/F=0/A=LC/X=1/Y=-42\cf3 \strokec3  \cf7 \strokec7 "\\s(Input1)\cf3 \strokec3  \cf7 \strokec7 Isc\\r\\s(Input3)\cf3 \strokec3  \cf7 \strokec7 Ipmax\\r\\s(Input0)\cf3 \strokec3  \cf7 \strokec7 Uoc\\r\\s(Input2)\cf3 \strokec3  \cf7 \strokec7 Upmax"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 GraphPPT()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(4,276,720,512)\cf3 \strokec3  \cf4 \strokec4 Input8;\cf3 \strokec3  \cf8 \strokec8 AppendToGraph\cf4 \strokec4 /R\cf3 \strokec3  \cf4 \strokec4 Input3\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 rgb(Input8)=(65535,0,0),rgb(Input3)=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(left)=56,margin(right)=56,margin(bottom)=32,margin(top)=8\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lsize=1.5,mirror(bottom)=1,grid(left)=2,grid(bottom)=2,gbRGB=(61166,61166,61166)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=2\cf3 \strokec3  \cf4 \strokec4 right\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'Efficiency\cf3 \strokec3  \cf7 \strokec7 \\Z10(\\U)"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'Fill\cf3 \strokec3  \cf7 \strokec7 Factor\cf3 \strokec3  \cf7 \strokec7 (\\U)"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'Time\cf3 \strokec3  \cf7 \strokec7 (\\U)"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=text0/J/F=0\cf3 \strokec3  \cf7 \strokec7 "\\s(Input8)\cf3 \strokec3  \cf7 \strokec7 Efficiency\\r\\s(Input3)\cf3 \strokec3  \cf7 \strokec7 Fill\cf3 \strokec3  \cf7 \strokec7 Factor"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 SetWindow\cf3 \strokec3  \cf4 \strokec4 kwTopWin,hook=UpdateDisplay\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 GraphIV()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Simple\cf3 \strokec3  \cf2 \strokec2 IV\cf3 \strokec3  \cf2 \strokec2 Graph\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 PPT\cf3 \strokec3  \cf2 \strokec2 routines\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(4,284,720,520)\cf3 \strokec3  \cf4 \strokec4 Input6;\cf3 \strokec3  \cf8 \strokec8 AppendToGraph\cf4 \strokec4 /R\cf3 \strokec3  \cf4 \strokec4 Input7\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 rgb(Input6)=(65535,0,0),rgb(Input7)=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(left)=56,margin(right)=56,margin(bottom)=32,margin(top)=8\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lsize=1.5,mirror(bottom)=1,grid(left)=2,grid(bottom)=2,gbRGB=(61166,61166,61166)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 right\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'Voltage\\Bpp\\M(\\U)"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'Current\\Bpp\\M(\\U)"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'Time\cf3 \strokec3  \cf7 \strokec7 (\\U)"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=text0/J/F=0\cf3 \strokec3  \cf7 \strokec7 "\\s(Input6)\cf3 \strokec3  \cf7 \strokec7 Voltage\\r\\s(Input7)\cf3 \strokec3  \cf7 \strokec7 Current"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 GraphStability()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(4,280,668,848)\cf3 \strokec3  \cf4 \strokec4 Input5,Input8\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Perovskite\cf3 \strokec3  \cf7 \strokec7 Diagnostics"\cf3 \strokec3 																		\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Power\cf3 \strokec3  \cf2 \strokec2 Out\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendToGraph\cf4 \strokec4 /L=imax\cf3 \strokec3  \cf4 \strokec4 Input4,Input7\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Ipmax\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendToGraph\cf4 \strokec4 /L=vmax\cf3 \strokec3  \cf4 \strokec4 Input3,Input6\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Vpmax\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendToGraph\cf4 \strokec4 /L=voc\cf3 \strokec3  \cf4 \strokec4 Input9,Input10\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Voc\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendToGraph\cf4 \strokec4 /L=jsc\cf3 \strokec3  \cf4 \strokec4 Input1,Input2\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Jsc\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendToGraph\cf4 \strokec4 /L=pin\cf3 \strokec3  \cf4 \strokec4 Input0\cf3 \strokec3 																												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Power\cf3 \strokec3  \cf2 \strokec2 In\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 rgb(Input1)=(0,0,65535),rgb(Input2)=(0,0,65535),rgb(Input3)=(65535,32764,16385),rgb(Input4)=(0,65535,0),rgb(Input6)=(65535,32764,16385),rgb(Input7)=(0,65535,0),rgb(Input9)=(65535,32764,16385),rgb(Input10)=(65535,32764,16385)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lstyle(Input2)=2,lstyle(Input6)=2,lstyle(Input7)=2,lstyle(Input8)=2,lstyle(Input10)=2\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 axisEnab(left)=\{0,0.18\},axisEnab(imax)=\{0.18,0.36\},axisEnab(vmax)=\{0.36,0.54\},axisEnab(voc)=\{0.54,0.72\},axisEnab(jsc)=\{0.72,0.9\},axisEnab(pin)=\{0.9,1\}\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 lsize=1.5,freePos=0,grid=2,mirror=2,lblPos=84\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 jsc;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 imax\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "Eff\cf3 \strokec3  \cf7 \strokec7 \\Z10(\\U)"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 vmax\cf3 \strokec3  \cf7 \strokec7 "V\\Bmax\\M\\Z10\cf3 \strokec3  \cf7 \strokec7 (\\U)"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 imax\cf3 \strokec3  \cf7 \strokec7 "J\\Bmax\\M\cf3 \strokec3  \cf7 \strokec7 \\Z10(\\U)"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 pin\cf3 \strokec3  \cf7 \strokec7 "P\\Bin\\M\cf3 \strokec3  \cf7 \strokec7 \\Z10(\\U)"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 jsc\cf3 \strokec3  \cf7 \strokec7 "J\\Bsc\\M\cf3 \strokec3  \cf7 \strokec7 \\Z10(\\U)"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 voc\cf3 \strokec3  \cf7 \strokec7 "V\\Boc\\M\cf3 \strokec3  \cf7 \strokec7 \\Z10(\\U)"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'Time\cf3 \strokec3  \cf7 \strokec7 (\\U)"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=text0/J/F=0/X=0/Y=0\cf3 \strokec3  \cf7 \strokec7 "\\s(Input5)\cf3 \strokec3  \cf7 \strokec7 Efficiency(1)\\r\\s(Input8)\cf3 \strokec3  \cf7 \strokec7 Efficiency(2)\\r\\s(Input4)\cf3 \strokec3  \cf7 \strokec7 Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Current(1)\\r\\s(Input7)\cf3 \strokec3  \cf7 \strokec7 Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Current(2)\\r\\s(Input3)\cf3 \strokec3  \cf7 \strokec7 Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Voltage(1)\\r\\s(Input6)\cf3 \strokec3  \cf7 \strokec7 Peak\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 Voltage(2)\\r\\s(Input9)\cf3 \strokec3  \cf7 \strokec7 Voc(1)\\r\\s(Input10)\cf3 \strokec3  \cf7 \strokec7 Voc(2)\\r\\s(Input1)\cf3 \strokec3  \cf7 \strokec7 Jsc(1)\\r\\\\s(Input2)\cf3 \strokec3  \cf7 \strokec7 Jsc(2)\\r\\s(Input0)\cf3 \strokec3  \cf7 \strokec7 Input\cf3 \strokec3  \cf7 \strokec7 Power"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 GraphHysteresis()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(4,280,668,512)\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent0,PhotoCurrent1\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Hysteresis"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 mirror=2,rgb(PhotoCurrent0)=(65535,0,0),rgb(PhotoCurrent1)=(0,65535,0)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 left\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12Potential\cf3 \strokec3  \cf7 \strokec7 (\\U)"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12Current\cf3 \strokec3  \cf7 \strokec7 (\\U)"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /N=textL/J/F=0/A=MC/X=60/Y=-32\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Graph_Profile()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /W=(5,42,523,383)\cf3 \strokec3  \cf4 \strokec4 Current\cf3 \strokec3  \cf4 \strokec4 vs\cf3 \strokec3  \cf4 \strokec4 distance\
\cf3 \strokec3 	\cf8 \strokec8 Append\cf4 \strokec4 /R\cf3 \strokec3  \cf4 \strokec4 photoVoltage\cf3 \strokec3  \cf4 \strokec4 vs\cf3 \strokec3  \cf4 \strokec4 distance\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 rgb(photoVoltage)=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01CellCurrent\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Distance\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01PhotoVoltage\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /J/N=text0/F=0/A=MC/X=34.48/Y=-35.77\cf3 \strokec3  \cf7 \strokec7 "\\s(current)\cf3 \strokec3  \cf7 \strokec7 Current\\r\\s(photoVoltage)\cf3 \strokec3  \cf7 \strokec7 Voltage"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 PowerPlot()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Isc,\cf3 \strokec3  \cf2 \strokec2 Voc\cf3 \strokec3  \cf2 \strokec2 vs\cf3 \strokec3  \cf2 \strokec2 Radient\cf3 \strokec3  \cf2 \strokec2 Power\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(12,284,320,512)\cf3 \strokec3  \cf4 \strokec4 IscPower,Res_IscPower\cf3 \strokec3  \cf4 \strokec4 vs\cf3 \strokec3  \cf4 \strokec4 RadPower\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Radiant\cf3 \strokec3  \cf7 \strokec7 Power"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendToGraph\cf3 \strokec3  \cf4 \strokec4 fit_IscPower\
\cf3 \strokec3 	\cf8 \strokec8 Append\cf4 \strokec4 /R\cf3 \strokec3  \cf4 \strokec4 VocPower\cf3 \strokec3  \cf4 \strokec4 vs\cf3 \strokec3  \cf4 \strokec4 RadPower\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(bottom)=36,margin(right)=56,margin(top)=8,standoff=0\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 grid(right)=0,mirror(bottom)=2,mode=3\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 marker(IscPower)=19,marker(Res_IscPower)=14,mode(VocPower)=4,marker(VocPower)=18,mode(fit_IscPower)=0\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 rgb(VocPower)=(0,0,65535),rgb(Res_IscPower)=(39321,1,1)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R/E=1\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1\cf3 \strokec3  \cf4 \strokec4 right;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=0/E=1\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Isc\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Radiant\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Voc\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /N=text0/J/F=0/A=MC/X=16/Y=-32\cf3 \strokec3  \cf7 \strokec7 "\\s(IscPower)\cf3 \strokec3  \cf7 \strokec7 Isc\\r\\s(Res_IscPower)\cf3 \strokec3  \cf7 \strokec7 Norm.\cf3 \strokec3  \cf7 \strokec7 Isc\\r\\s(VocPower)\cf3 \strokec3  \cf7 \strokec7 Voc"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 LnPowerPlot()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Voc\cf3 \strokec3  \cf2 \strokec2 vs\cf3 \strokec3  \cf2 \strokec2 ln(Radient\cf3 \strokec3  \cf2 \strokec2 Power)\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(328,284,616,512)\cf3 \strokec3  \cf4 \strokec4 VocPower,fit_VocPower\cf3 \strokec3  \cf4 \strokec4 vs\cf3 \strokec3  \cf4 \strokec4 RadPower\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Log(Radiant\cf3 \strokec3  \cf7 \strokec7 Power)"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendToGraph\cf4 \strokec4 /L=Resid\cf3 \strokec3  \cf4 \strokec4 Res_VocPower\cf3 \strokec3  \cf4 \strokec4 vs\cf3 \strokec3  \cf4 \strokec4 RadPower\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(bottom)=36,margin(right)=16,margin(top)=8\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 mirror=2,\cf6 \strokec6 log\cf4 \strokec4 (bottom)=1,mirror(Resid)=2,grid(Resid)=1,zero(Resid)=1,standoff=0\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 mode=4,marker(VocPower)=18,mode(Res_VocPower)=3,marker(Res_VocPower)=18,rgb(VocPower)=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 freePos(Resid)=0,nticks(resid)=2\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 axisEnab(left)=\{0,0.8\},axisEnab(Resid)=\{0.8,1\}\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1/E=1\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Voc\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 Resid\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01[\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Radiant\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 FfPlot()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /K=1/W=(12,284,320,512)\cf3 \strokec3  \cf4 \strokec4 Ff\cf3 \strokec3  \cf4 \strokec4 vs\cf3 \strokec3  \cf4 \strokec4 RadPower\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Fill\cf3 \strokec3  \cf7 \strokec7 Factor"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(bottom)=36,margin(right)=16,margin(top)=8\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 mode=4,marker=17,mirror=2,\cf6 \strokec6 log\cf4 \strokec4 (bottom)=1\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf4 \strokec4 0,1;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1/E=1\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Ff\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Radiant\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 ChargeGraph()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /W=(368,280,656,516)\cf3 \strokec3  \cf4 \strokec4 charge\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Charge\cf3 \strokec3  \cf7 \strokec7 Accumalation"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 mirror=2,margin(right)=16\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Charge\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Potential\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 ChronoAmpGraph()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /W=(4,280,612,516)\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "Chrono\cf3 \strokec3  \cf7 \strokec7 Amperometry"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendToGraph\cf4 \strokec4 /R\cf3 \strokec3  \cf4 \strokec4 Voltage\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 grid(right)=0,mirror(bottom)=2,margin(right)=56,rgb(PhotoCurrent)=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf4 \strokec4 0,1.2\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Current\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01Potential\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Time\cf3 \strokec3  \cf7 \strokec7 [s]"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Graph0()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /W=(711,360,1174,575)\cf3 \strokec3  \cf4 \strokec4 RefCurrent\cf3 \strokec3  \cf4 \strokec4 vs\cf3 \strokec3  \cf4 \strokec4 XeLightIntensities\
\cf3 \strokec3 	\cf8 \strokec8 AppendToGraph\cf3 \strokec3  \cf4 \strokec4 fit_RefCurrent\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 rgb(fit_RefCurrent)=(4369,4369,4369)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 mode(RefCurrent)=3,marker(RefCurrent)=19,grid=2,mirror=2\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf4 \strokec4 0,100\
\cf3 \strokec3 	\cf8 \strokec8 Cursor\cf4 \strokec4 /P\cf3 \strokec3  \cf4 \strokec4 A\cf3 \strokec3  \cf4 \strokec4 fit_RefCurrent\cf3 \strokec3  \cf4 \strokec4 180\
\cf3 \strokec3 	\cf8 \strokec8 ShowInfo\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 TextBox\cf4 \strokec4 /C/N=CF_RefCurrent/X=25.93/Y=1.95\cf3 \strokec3  \cf7 \strokec7 "Coefficient\cf3 \strokec3  \cf7 \strokec7 values\cf3 \strokec3  \cf7 \strokec7 \'b1\cf3 \strokec3  \cf7 \strokec7 one\cf3 \strokec3  \cf7 \strokec7 standard\cf3 \strokec3  \cf7 \strokec7 deviation\\r\\ta\\t=0.104\cf3 \strokec3  \cf7 \strokec7 \'b1\cf3 \strokec3  \cf7 \strokec7 0.0213\\r\\tb\\t=0.46145\cf3 \strokec3  \cf7 \strokec7 \'b1\cf3 \strokec3  \cf7 \strokec7 0.000593"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Graph1()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Graph\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 For\cf3 \strokec3  \cf2 \strokec2 Diagnostic\cf3 \strokec3  \cf2 \strokec2 purposes\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Display\cf4 \strokec4 /W=(5,269,400,477)\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent,Thermopile,PhotoDiode,Potential\
\cf3 \strokec3 	\cf4 \strokec4 Graph_Style0()\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 rgb[2]=(0,65535,0),rgb[3]=(65535,0,52428)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 mirror(left)=2,margin(right)=16\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 bottom\
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /N=text0/J/F=0/A=MC/X=16/Y=-32\cf3 \strokec3  \cf7 \strokec7 "\\s(PhotoCurrent)\cf3 \strokec3  \cf7 \strokec7 CellCurrent\\r\\s(Thermopile)\cf3 \strokec3  \cf7 \strokec7 Thermopile\\r\\s(PhotoDiode)\cf3 \strokec3  \cf7 \strokec7 PhotoDiode\\r\\s(Potential)\cf3 \strokec3  \cf7 \strokec7 Potential"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Proc\cf3 \strokec3  \cf4 \strokec4 Graph_Style0()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 GraphStyle\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(left)=54,margin(right)=108,margin(bottom)=32,margin(top)=4\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 grid=2,lblPos=52,minor=1,lsize=0.5\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 font=\cf7 \strokec7 "Times"\cf4 \strokec4 ,fSize=12,sep=8\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 rgb=(65535,0,0),gbRGB=(61166,61166,61166)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Proc\cf3 \strokec3  \cf4 \strokec4 Graph_Style1()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 GraphStyle\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf4 \strokec4 S_layoutname=\cf7 \strokec7 "Layout5()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf6 \strokec6 log\cf4 \strokec4 (left)=1\
\cf3 \strokec3 	\cf8 \strokec8 SetAxis\cf4 \strokec4 /A\cf3 \strokec3  \cf4 \strokec4 left\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Proc\cf3 \strokec3  \cf4 \strokec4 AcquireStyle1()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 GraphStyle\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(right)=108,lblmargin(right)=60\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 wbRGB=(49151,49151,65535)\
\cf3 \strokec3 	\cf8 \strokec8 ControlInfo\cf4 \strokec4 /W=ConfigPanel\cf3 \strokec3  \cf4 \strokec4 tab0\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Now\cf3 \strokec3  \cf2 \strokec2 have\cf3 \strokec3  \cf2 \strokec2 data,\cf3 \strokec3  \cf2 \strokec2 so\cf3 \strokec3  \cf2 \strokec2 have\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 allow\cf3 \strokec3  \cf2 \strokec2 possibility\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 layout\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_Value==4)\
\cf3 \strokec3 		\cf8 \strokec8 Button\cf3 \strokec3  \cf4 \strokec4 sp_layout,win=ConfigPanel,disable=0\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 DisplayAddons()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 NewPanel\cf4 \strokec4 /EXT=0/HOST=IVGraph/N=Utilities/W=(-8,64,288,96)\cf3 \strokec3  \cf4 \strokec4 as\cf3 \strokec3  \cf7 \strokec7 "I-V\cf3 \strokec3  \cf7 \strokec7 Diagnostics"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyPanel\cf3 \strokec3  \cf4 \strokec4 cbRGB=(45535,45535,50535)\
\cf3 \strokec3 	\cf8 \strokec8 SetDrawEnv\cf3 \strokec3  \cf4 \strokec4 fsize=14,fstyle=1,textrgb=(65535,65532,16385);\cf3 \strokec3  \cf8 \strokec8 DrawText\cf3 \strokec3  \cf4 \strokec4 72,16,\cf7 \strokec7 "Evaluated\cf3 \strokec3  \cf7 \strokec7 Parameters"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 param0,pos=\{4,20\},size=\{280,16\},title=\cf7 \strokec7 "Short\cf3 \strokec3  \cf7 \strokec7 Circuit\cf3 \strokec3  \cf7 \strokec7 Current:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.2W0PA/cm2"\cf4 \strokec4 ,frame=3,labelBack=(45535,45535,50535),limits=\{-5e-4,5e-5,0\},barmisc=\{0,88\},value=#\cf7 \strokec7 "V_Jsc"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 param1,pos=\{4,36\},size=\{280,16\},title=\cf7 \strokec7 "Open\cf3 \strokec3  \cf7 \strokec7 Circuit\cf3 \strokec3  \cf7 \strokec7 Voltage:"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.2W0PV"\cf4 \strokec4 ,frame=3,labelBack=(45535,45535,50535),limits=\{-5e-5,1,0\},barmisc=\{0,88\},value=#\cf7 \strokec7 "V_Voc"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 param2,pos=\{24,52\},size=\{260,16\},title=\cf7 \strokec7 "Output\cf3 \strokec3  \cf7 \strokec7 Power\cf3 \strokec3      \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%.2W0PW"\cf4 \strokec4 ,frame=3,labelBack=(45535,45535,50535),limits=\{0,8e-3,0\},barmisc=\{0,88\},value=#\cf7 \strokec7 "V_pwr"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ValDisplay\cf3 \strokec3  \cf4 \strokec4 param3,pos=\{36,68\},size=\{248,16\},title=\cf7 \strokec7 "Fill\cf3 \strokec3  \cf7 \strokec7 Factor\cf3 \strokec3        \cf7 \strokec7 :"\cf4 \strokec4 ,font=\cf7 \strokec7 "Helvetica"\cf4 \strokec4 ,fSize=12,format=\cf7 \strokec7 "%2.2f\cf3 \strokec3   \cf7 \strokec7 %"\cf4 \strokec4 ,frame=1,labelBack=(45535,45535,50535),limits=\{0,100,0\},barmisc=\{0,88\},value=#\cf7 \strokec7 "V_ff"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 GraphStyle(ctrlName,popNum,popStr)\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 PopupMenuControl\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 ctrlName,popStr;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 popNum\
\cf3 \strokec3 	\cf9 \strokec9 switch\cf3 \strokec3  \cf4 \strokec4 (popNum)\
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 1:\
\cf3 \strokec3 			\cf4 \strokec4 GraphOverlayStyle()\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 case\cf3 \strokec3  \cf4 \strokec4 2:\
\cf3 \strokec3 			\cf4 \strokec4 GraphStaggeredStyle()\
\cf3 \strokec3 			\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endswitch\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 GraphStaggeredStyle()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 GraphStyle\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 Expt_parameters\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 Input0\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allspectra\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 cmd,slabel,slegend=\cf7 \strokec7 "\\Z10\\s"\cf4 \strokec4 ,wname,list=\cf7 \strokec7 "Isc;Voc;Power;Fill\cf3 \strokec3  \cf7 \strokec7 Factor"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n,nWaves=\cf6 \strokec6 ItemsInList\cf4 \strokec4 (allspectra)\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 offset=\cf6 \strokec6 floor\cf4 \strokec4 (100/nWaves)/100\
\cf3 \strokec3 	\cf8 \strokec8 GetAxis\cf4 \strokec4 /W=GraphTStability/Q\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,V_min,V_max\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ;\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Legend/K/N=text0\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 slabel=\cf7 \strokec7 "left"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (n)\
\cf3 \strokec3 		\cf4 \strokec4 wname=\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (\cf6 \strokec6 StringFromList\cf4 \strokec4 (n,allspectra))\
\cf3 \strokec3 		\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=\cf6 \strokec6 TraceNameToWaveRef\cf4 \strokec4 (\cf7 \strokec7 ""\cf4 \strokec4 ,wname)\
\cf3 \strokec3 		\cf8 \strokec8 RemovefromGraph\cf3 \strokec3  \cf4 \strokec4 $\cf6 \strokec6 NameofWave\cf4 \strokec4 (w)\
\cf3 \strokec3 		\cf8 \strokec8 AppendToGraph\cf4 \strokec4 /L=$slabel\cf3 \strokec3  \cf4 \strokec4 w\cf3 \strokec3  \cf4 \strokec4 vs\cf3 \strokec3  \cf4 \strokec4 Input0\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 grid($slabel)=2,rgb($wname)=(65535*((n==0)|(n==3)),0,65535*((n==1)|(n==2))),lstyle($wname)=n\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 freePos($slabel)=0,axisEnab($slabel)=\{n*offset,(n+1)*offset\},mirror($slabel)=1\
\cf3 \strokec3 		\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 $slabel\cf3 \strokec3  \cf7 \strokec7 "\\Z12\\f01"\cf4 \strokec4 +\cf6 \strokec6 StringFromList\cf4 \strokec4 (\cf6 \strokec6 str2num\cf4 \strokec4 (wname[5])-1,list)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 \\U"\cf3 \strokec3 																	\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 To\cf3 \strokec3  \cf2 \strokec2 remove\cf3 \strokec3  \cf2 \strokec2 default\cf3 \strokec3  \cf2 \strokec2 label\cf3 \strokec3  \cf2 \strokec2 junk\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1\cf3 \strokec3  \cf4 \strokec4 $slabel\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 slegend,\cf7 \strokec7 "%s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r\\s"\cf4 \strokec4 ,slegend,wname,\cf6 \strokec6 StringFromList\cf4 \strokec4 (\cf6 \strokec6 str2num\cf4 \strokec4 (wname[5])-1,list)\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<nWaves)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(left)=56,margin(right)=32\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 minor=1,font=\cf7 \strokec7 "Times"\cf4 \strokec4 ,fSize=12,lblPos=48,mirror=1,nticks=4,mode=4,marker=19\
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=text0\cf3 \strokec3  \cf4 \strokec4 slegend[0,\cf6 \strokec6 strlen\cf4 \strokec4 (slegend)-4]\cf3 \strokec3 																								\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Trim\cf3 \strokec3  \cf2 \strokec2 last\cf3 \strokec3  \cf2 \strokec2 CR/LF\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 GraphOverlayStyle()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 GraphStyle\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allspectra\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str,slegend=\cf7 \strokec7 "\\Z10\\s"\cf4 \strokec4 ,wname\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,i\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 wname=\cf6 \strokec6 PossiblyQuoteName\cf4 \strokec4 (\cf6 \strokec6 StringfromList\cf4 \strokec4 (i,allspectra));\cf3 \strokec3  \cf4 \strokec4 a=2^(\cf6 \strokec6 str2num\cf4 \strokec4 (wname[5])-1)\
\cf3 \strokec3 		\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 w=\cf6 \strokec6 TraceNameToWaveRef\cf4 \strokec4 (\cf7 \strokec7 ""\cf4 \strokec4 ,wname)\
\cf3 \strokec3 		\cf8 \strokec8 RemovefromGraph\cf3 \strokec3  \cf4 \strokec4 $\cf6 \strokec6 NameofWave\cf4 \strokec4 (w)\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (a==1)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Append/L=left\cf3 \strokec3  \cf7 \strokec7 %s\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 Input0"\cf4 \strokec4 ,wname;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 slegend,\cf7 \strokec7 "%s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r\\s"\cf4 \strokec4 ,slegend,wname,\cf7 \strokec7 "Isc"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 grid(left)=2,rgb(Input1)=(0,0,65535),marker=19\
\cf3 \strokec3 			\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Current\cf3 \strokec3  \cf7 \strokec7 Density\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (a==2)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Append/R=right\cf3 \strokec3  \cf7 \strokec7 %s\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 Input0"\cf4 \strokec4 ,wname;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 slegend,\cf7 \strokec7 "%s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r\\s"\cf4 \strokec4 ,slegend,wname,\cf7 \strokec7 "Uoc"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 grid(right)=0,margin(right)=56,rgb(Input2)=(65535,0,0),lstyle(Input2)=2,marker(Input2)=18\
\cf3 \strokec3 			\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1\cf3 \strokec3  \cf4 \strokec4 right;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Potential\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (a==4)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Append/R=right1\cf3 \strokec3  \cf7 \strokec7 %s\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 Input0"\cf4 \strokec4 ,wname;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 slegend,\cf7 \strokec7 "%s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r\\s"\cf4 \strokec4 ,slegend,wname,\cf7 \strokec7 "Fill\cf3 \strokec3  \cf7 \strokec7 Factor"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 axisEnab(left)=\{0,0.75\},axisEnab(right)=\{0,0.75\},axisEnab(right1)=\{0.75,1\},freePos(right1)=0\
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 grid(right1)=0,rgb(Input4)=(0,0,65535),lstyle(Input4)=4,marker(Input4)=17\
\cf3 \strokec3 			\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1\cf3 \strokec3  \cf4 \strokec4 right1;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right1\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Fill\cf3 \strokec3  \cf7 \strokec7 Factor\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (a==8)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Append/L=left1\cf3 \strokec3  \cf7 \strokec7 %s\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 Input0"\cf4 \strokec4 ,wname;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 slegend,\cf7 \strokec7 "%s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r\\s"\cf4 \strokec4 ,slegend,wname,\cf7 \strokec7 "Power"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 axisEnab(left)=\{0,0.75\},axisEnab(right)=\{0,0.75\},axisEnab(left1)=\{0.75,1\},freePos(left1)=0\
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 zero(left1)=1,grid(left1)=2,rgb(Input3)=(0,0,65535),lstyle(Input3)=3,marker(Input3)=16\
\cf3 \strokec3 			\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left1\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Power\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (a==16)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Append/L=left1\cf3 \strokec3  \cf7 \strokec7 %s\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 Input0"\cf4 \strokec4 ,wname;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 slegend,\cf7 \strokec7 "%s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r\\s"\cf4 \strokec4 ,slegend,wname,\cf7 \strokec7 "Efficiency"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 axisEnab(left)=\{0,0.75\},axisEnab(right)=\{0,0.75\},axisEnab(left1)=\{0.75,1\},freePos(left1)=0\
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 zero(left1)=1,grid(left1)=2,rgb(Input5)=(65535,0,0),lstyle(Input5)=5,marker(Input5)=16\
\cf3 \strokec3 			\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left1\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Efficiency\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (a==32)\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Append/R=right1\cf3 \strokec3  \cf7 \strokec7 %s\cf3 \strokec3  \cf7 \strokec7 vs\cf3 \strokec3  \cf7 \strokec7 Input0"\cf4 \strokec4 ,wname;\cf3 \strokec3  \cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 slegend,\cf7 \strokec7 "%s(%s)\cf3 \strokec3  \cf7 \strokec7 %s\\r\\s"\cf4 \strokec4 ,slegend,wname,\cf7 \strokec7 "Intensity"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 axisEnab(left)=\{0,0.75\},axisEnab(right)=\{0,0.75\},axisEnab(left1)=\{0.75,1\},axisEnab(right1)=\{0.75,1\},freePos(right1)=0\
\cf3 \strokec3 			\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 zero(left1)=1,rgb(Input6)=(65535,0,0),lstyle(Input6)=5,marker(Input6)=16\
\cf3 \strokec3 			\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/N=1\cf3 \strokec3  \cf4 \strokec4 right1;\cf3 \strokec3  \cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 right1\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z12\\f01Intensity\cf3 \strokec3  \cf7 \strokec7 [\\U]"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 i+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (i<\cf6 \strokec6 ItemsinList\cf4 \strokec4 (allspectra))\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 mirror(bottom)=2,grid(bottom)=2,fSize=12,lblPos=48,mode=4\
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=text0/X=0/Y=48\cf3 \strokec3  \cf4 \strokec4 slegend[0,\cf6 \strokec6 strlen\cf4 \strokec4 (slegend)-4]\cf3 \strokec3 																					\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Trim\cf3 \strokec3  \cf2 \strokec2 last\cf3 \strokec3  \cf2 \strokec2 CR/LF\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Proc\cf3 \strokec3  \cf4 \strokec4 GraphPubl_Style0()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 GraphStyle\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(bottom)=56,margin(bottom)=16,margin(bottom)=48,margin(top)=16\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 grid=2,lblPos=52\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 font=\cf7 \strokec7 "Times"\cf4 \strokec4 ,fSize=14\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 minor=1,lsize=1.5,sep=8\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf4 \strokec4 /Z\cf3 \strokec3  \cf4 \strokec4 rgb=(65535,0,0),gbRGB=(61166,61166,61166)\
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 left\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z14\\f01Current\cf3 \strokec3  \cf7 \strokec7 Density\cf3 \strokec3  \cf7 \strokec7 [\\U/cm\\\\S2\\\\M]"\cf4 \strokec4 ;\cf8 \strokec8 DelayUpdate\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Label\cf3 \strokec3  \cf4 \strokec4 bottom\cf3 \strokec3  \cf7 \strokec7 "\\F'Times'\\Z14\\f01Potential\cf3 \strokec3  \cf7 \strokec7 [\\\\U]"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 CellParams()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 Electrolytes\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_complianceI,V_delay,V_incrVolt,V_length,V_Porosity,V_modeElectrolyte,V_settlingtime,V_scanDir\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 d_t,S_dye,S_electrolyte,S_Filename,S_lamp,S_layer,S_temp,S_type,S_specification,S_warning,S_WE,S_CE\
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f00Measurement\cf3 \strokec3  \cf7 \strokec7 Date\\t\\t\\[0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +d_t\
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 Active\cf3 \strokec3  \cf7 \strokec7 Area\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_area)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 cm\\S\\Z082\\Z10"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Light\cf3 \strokec3  \cf7 \strokec7 Source\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_lamp\
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Working\cf3 \strokec3  \cf7 \strokec7 Temperature\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_temp+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 K"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Data\cf3 \strokec3  \cf7 \strokec7 File\cf3 \strokec3  \cf7 \strokec7 Name\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Filename\
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Current\cf3 \strokec3  \cf7 \strokec7 Compliance\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_complianceI*1e3)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mA"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Settling\cf3 \strokec3  \cf7 \strokec7 Time,\cf3 \strokec3  \cf7 \strokec7 \uc0\u8706 V,\cf3 \strokec3  \cf7 \strokec7 Meas.\cf3 \strokec3  \cf7 \strokec7 Delay\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 SelectString\cf4 \strokec4 (V_settlingtime,\cf7 \strokec7 "AUTO,\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (-V_scanDir*V_incrVolt*1e3)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mV"\cf4 \strokec4 ,\cf7 \strokec7 ""\cf4 \strokec4 ,\cf6 \strokec6 num2str\cf4 \strokec4 (V_settlingTime)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 s,\cf3 \strokec3   \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (-V_scanDir*V_incrVolt*1e3)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mV,\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_delay)+\cf7 \strokec7 "s"\cf4 \strokec4 )\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Expt_Params(a,b)\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,b\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 StringArray\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 cw,IVParams,M_Covar\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_area,V_beta,V_FitNumIters,V_IPCE550,V_numCell,V_supos,hysteresisFlag\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,S_username\
\cf3 \strokec3 	\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 flg,n,nwaves=\cf6 \strokec6 ItemsInList\cf4 \strokec4 (allwaves,\cf7 \strokec7 ","\cf4 \strokec4 ),m,m1;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str,s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13\
\cf3 \strokec3 	\cf8 \strokec8 Redimension\cf4 \strokec4 /N=(nwaves)\cf3 \strokec3  \cf4 \strokec4 StringArray\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (nwaves>0)\
\cf3 \strokec3 		\cf4 \strokec4 StringArray=\cf6 \strokec6 StringFromList\cf4 \strokec4 (p,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 );\cf3 \strokec3  \cf8 \strokec8 Sort\cf4 \strokec4 /R\cf3 \strokec3  \cf4 \strokec4 StringArray\cf3 \strokec3  \cf4 \strokec4 StringArray\
\cf3 \strokec3 		\cf4 \strokec4 flg=!\cf6 \strokec6 cmpStr\cf4 \strokec4 ((StringArray[0])[12],\cf7 \strokec7 "H"\cf4 \strokec4 )\cf3 \strokec3 																									\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 flg\cf3 \strokec3  \cf2 \strokec2 for\cf3 \strokec3  \cf2 \strokec2 Hysteresis\cf3 \strokec3  \cf2 \strokec2 data\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 CellParams()\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (nwaves==0)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 If\cf3 \strokec3  \cf2 \strokec2 zero\cf3 \strokec3  \cf2 \strokec2 waves,\cf3 \strokec3  \cf2 \strokec2 therefore\cf3 \strokec3  \cf2 \strokec2 DarkCurrent\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 m1=7\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 m1=\cf6 \strokec6 str2num\cf4 \strokec4 ((StringArray[n])[\cf6 \strokec6 strlen\cf4 \strokec4 (StringArray[n])-1])\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 m1\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 appended\cf3 \strokec3  \cf2 \strokec2 waves\cf3 \strokec3  \cf2 \strokec2 counter\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (n==0)\
\cf3 \strokec3 			\cf4 \strokec4 str=\cf7 \strokec7 "\\t\\f01\cf3 \strokec3    \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "\\Z10\\F'Palatino'\\f00Thermopile\\Bref\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s1,\cf7 \strokec7 "Current\\Bref\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s2,\cf7 \strokec7 "Power\\Bin\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s3,\cf7 \strokec7 "Norm.\cf3 \strokec3  \cf7 \strokec7 Std.\cf3 \strokec3  \cf7 \strokec7 Dev.\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s4,\cf7 \strokec7 "Module\cf3 \strokec3  \cf7 \strokec7 U\\Boc\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s5,\cf7 \strokec7 "Cell\cf3 \strokec3  \cf7 \strokec7 U\\Boc\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s6,\cf7 \strokec7 "I\\Bsc\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s7,\cf7 \strokec7 "J\\Bsc\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s8,\cf7 \strokec7 "U\\Bpmax\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s9,\cf7 \strokec7 "I\\Bpmax\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s10,\cf7 \strokec7 "Power\\Bout\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s11,\cf7 \strokec7 "Total\cf3 \strokec3  \cf7 \strokec7 Power\\Bout\\M"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s12,\cf7 \strokec7 "Fill\cf3 \strokec3  \cf7 \strokec7 Factor"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s13,\cf7 \strokec7 "Efficiency\cf3 \strokec3  \cf7 \strokec7 \\F'Symbol'h\\F'Palatino'"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (hysteresisFlag)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Hysteresis\cf3 \strokec3  \cf2 \strokec2 data\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 str=str+\cf7 \strokec7 "\\t\\["\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (m)+\cf7 \strokec7 "\cf3 \strokec3    \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (\cf6 \strokec6 round\cf4 \strokec4 (1e4*IVparams[12*m1+1][V_supos])/10)+\cf7 \strokec7 "%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,s0+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PSun\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+11][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s1,s1+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PA\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s2,s2+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PW/cm\\S\\Z082\\M\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+1][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s3,s3+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2f\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+2][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s4,s4+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PV\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+3][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s5,s5+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PV\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+3][V_supos]/V_numCell\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s6,s6+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PA\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+4][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s7,s7+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PA/cm\\S\\Z082\\M\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+5][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s8,s8+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2W1PV\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+6][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s9,s9+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.1W1PA/cm\\S\\Z082\\M\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+8][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s10,s10+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2W1PW/cm\\S\\Z082\\M\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+9][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s11,s11+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2W1PW\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+9][V_supos]*V_area\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s12,s12+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3f\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+10][V_supos]\
\cf3 \strokec3 			\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s13,\cf7 \strokec7 "%s\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2f%s\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,s13,m,100*IVparams[12*m1+9][V_supos]/IVparams[12*m1+1][V_supos],\cf7 \strokec7 "%"\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 m+=1\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 m\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 tab\cf3 \strokec3  \cf2 \strokec2 counter\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((nwaves<5)%|((m1!=2*\cf6 \strokec6 abs\cf4 \strokec4 (\cf6 \strokec6 CmpStr\cf4 \strokec4 (S_username,\cf7 \strokec7 "Marie"\cf4 \strokec4 )))%&(m1!=1*\cf6 \strokec6 abs\cf4 \strokec4 (\cf6 \strokec6 CmpStr\cf4 \strokec4 (S_username,\cf7 \strokec7 "Paul"\cf4 \strokec4 )))%&(m1!=3)))\
\cf3 \strokec3 				\cf4 \strokec4 str=str+\cf7 \strokec7 "\\t\\["\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (m)+\cf7 \strokec7 "\cf3 \strokec3    \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (\cf6 \strokec6 round\cf4 \strokec4 (1e4*IVparams[12*m1+1][V_supos])/10)+\cf7 \strokec7 "%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,s0+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PSun\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+11][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s1,s1+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PA\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s2,s2+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PW/cm\\S\\Z082\\M\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+1][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s3,s3+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2f\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+2][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s4,s4+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PV\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+3][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s5,s5+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PV\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+3][V_supos]/V_numCell\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s6,s6+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PA\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+4][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s7,s7+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3W1PA/cm\\S\\Z082\\M\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+5][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s8,s8+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2W1PV\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+6][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s9,s9+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.1W1PA/cm\\S\\Z082\\M\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+8][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s10,s10+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2W1PW/cm\\S\\Z082\\M\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+9][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s11,s11+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2W1PW\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+9][V_supos]*V_area\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s12,s12+\cf7 \strokec7 "\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.3f\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,m,IVparams[12*m1+10][V_supos]\
\cf3 \strokec3 				\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s13,\cf7 \strokec7 "%s\\X%d\cf3 \strokec3  \cf7 \strokec7 %2.2f%s\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 ,s13,m,100*IVparams[12*m1+9][V_supos]/IVparams[12+1][V_supos],\cf7 \strokec7 "%"\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 m+=1\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 m\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 tab\cf3 \strokec3  \cf2 \strokec2 counter\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<nwaves)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text2/B=1/F=0/A=LC/X=(a)/Y=(b-10)\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf4 \strokec4 s0+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s1+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s2+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s3+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s4+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s5+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s6+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s7+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s8+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s9+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s10+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s11+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s12+\cf7 \strokec7 "\\r"\cf4 \strokec4 +s13\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "Ideality\cf3 \strokec3  \cf7 \strokec7 Factor\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 1\cf3 \strokec3  \cf7 \strokec7 Sun\\X0:\cf3 \strokec3  \cf7 \strokec7 %2.3g\\r"\cf4 \strokec4 ,cw[3]\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s1,\cf7 \strokec7 "Series\cf3 \strokec3  \cf7 \strokec7 Resistance\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 1\cf3 \strokec3  \cf7 \strokec7 Sun\\X0:\cf3 \strokec3  \cf7 \strokec7 %2.2W1P\uc0\u937 \cf3 \strokec3  \cf7 \strokec7 \'b1\cf3 \strokec3  \cf7 \strokec7 %.2g\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 ,-cw[2],-100*\cf6 \strokec6 sqrt\cf4 \strokec4 (M_Covar[2][2])/cw[2]\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s2,\cf7 \strokec7 ",\\t(%2.2W1P\uc0\u937 /cm\\S\\Z082\\M)"\cf4 \strokec4 ,-cw[2]/V_area\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_FitNumIters>255)\
\cf3 \strokec3 		\cf4 \strokec4 s2+=\cf7 \strokec7 ",\cf3 \strokec3  \cf7 \strokec7 Max.\cf3 \strokec3  \cf7 \strokec7 Iterations\cf3 \strokec3  \cf7 \strokec7 limit"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text3/F=0/A=LC/X=(a)/Y=(b-36)\cf7 \strokec7 "IPCE\cf3 \strokec3  \cf7 \strokec7 @\cf3 \strokec3  \cf7 \strokec7 550\cf3 \strokec3  \cf7 \strokec7 nm\\t\\t\\[0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_IPCE550)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //\cf3 \strokec3 	\cf2 \strokec2 AppendText\cf3 \strokec3  \cf2 \strokec2 "IPCE\cf3 \strokec3  \cf2 \strokec2 @\cf3 \strokec3  \cf2 \strokec2 700\cf3 \strokec3  \cf2 \strokec2 nm\cf3 \strokec3   \cf2 \strokec2 :\\X0"+num2str(V_IPCE700/V_area)\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Slope\cf3 \strokec3  \cf7 \strokec7 \uc0\u8706 V\\Boc\\M/\u8706 log(I\\Bo\\M)\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_beta*1e3*2.30259)+\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mV"\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 n=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 )[12])\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((V_numCell==1)%&(IVParams[4][V_supos]<-0.001))\
\cf3 \strokec3 		\cf8 \strokec8 AppendText\cf3 \strokec3  \cf4 \strokec4 s0+s1+s2+s3\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 IV_Results()\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 cw,M_Covar,residual\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_chisq,V_FitNumIters,V_ms\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Value\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str,Start=\cf6 \strokec6 num2str\cf4 \strokec4 (\cf6 \strokec6 hcsr\cf4 \strokec4 (A)),Finish=\cf6 \strokec6 num2str\cf4 \strokec4 (\cf6 \strokec6 hcsr\cf4 \strokec4 (B))\
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/R=(\cf6 \strokec6 xcsr\cf4 \strokec4 (B),\cf6 \strokec6 xcsr\cf4 \strokec4 (A))\cf3 \strokec3  \cf4 \strokec4 residual\
\cf3 \strokec3 	\cf9 \strokec9 string\cf3 \strokec3  \cf4 \strokec4 s0,s1,s2,s3,s4\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s0,\cf7 \strokec7 "\\Z10\\f00PhotoCurrent\\t\cf3 \strokec3   \cf7 \strokec7 \\[0\cf3 \strokec3  \cf7 \strokec7 :\cf3 \strokec3  \cf7 \strokec7 %2.2W1PA\cf3 \strokec3  \cf7 \strokec7 \'b1\cf3 \strokec3  \cf7 \strokec7 %.2g\cf3 \strokec3  \cf7 \strokec7 %\\r"\cf4 \strokec4 ,-cw[0],-100*\cf6 \strokec6 sqrt\cf4 \strokec4 (M_Covar[0][0])/cw[0]\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s1,\cf7 \strokec7 "I\\Bsat\\M\\X0\cf3 \strokec3  \cf7 \strokec7 :\cf3 \strokec3  \cf7 \strokec7 %2.2W1PA\cf3 \strokec3  \cf7 \strokec7 \'b1\cf3 \strokec3  \cf7 \strokec7 %.2g\cf3 \strokec3  \cf7 \strokec7 %\\r"\cf4 \strokec4 ,-cw[1],-100*\cf6 \strokec6 sqrt\cf4 \strokec4 (M_Covar[1][1])/cw[1]\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s2,\cf7 \strokec7 "Ideality\cf3 \strokec3  \cf7 \strokec7 Factor\\X0\cf3 \strokec3  \cf7 \strokec7 :\cf3 \strokec3  \cf7 \strokec7 %2.3g\cf3 \strokec3  \cf7 \strokec7 \'b1\cf3 \strokec3  \cf7 \strokec7 %.2g\cf3 \strokec3  \cf7 \strokec7 %\\r"\cf4 \strokec4 ,cw[3],100*\cf6 \strokec6 sqrt\cf4 \strokec4 (M_Covar[3][3])/cw[3]\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s3,\cf7 \strokec7 "Series\cf3 \strokec3  \cf7 \strokec7 Resistance\\X0\cf3 \strokec3  \cf7 \strokec7 :\cf3 \strokec3  \cf7 \strokec7 %2.2W1P\uc0\u937 \cf3 \strokec3  \cf7 \strokec7 \'b1\cf3 \strokec3  \cf7 \strokec7 %.2g\cf3 \strokec3  \cf7 \strokec7 %\\r"\cf4 \strokec4 ,-cw[2],-100*\cf6 \strokec6 sqrt\cf4 \strokec4 (M_Covar[2][2])/cw[2]\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text6/F=0/A=LT/X=52/Y=80\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f05Fitted\cf3 \strokec3  \cf7 \strokec7 Model\cf3 \strokec3  \cf7 \strokec7 Parameters\cf3 \strokec3  \cf7 \strokec7 to\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Value+\cf7 \strokec7 ":"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf4 \strokec4 s0+s1+s2+s3\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 numpnts\cf4 \strokec4 (cw)==5)\
\cf3 \strokec3 		\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 s4,\cf7 \strokec7 "Parallel\cf3 \strokec3  \cf7 \strokec7 Resistance\\X0\cf3 \strokec3  \cf7 \strokec7 :\cf3 \strokec3  \cf7 \strokec7 %2.2W1P\uc0\u937 \cf3 \strokec3  \cf7 \strokec7 \'b1\cf3 \strokec3  \cf7 \strokec7 %.3g\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 ,cw[4],100*\cf6 \strokec6 sqrt\cf4 \strokec4 (M_Covar[4][4])/cw[4]\
\cf3 \strokec3 		\cf8 \strokec8 AppendText\cf3 \strokec3  \cf4 \strokec4 s4\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text7/F=0/A=LT/X=80/Y=21\cf3 \strokec3  \cf7 \strokec7 "Fit:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +Start+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 -\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +Finish+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 eV"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\Z10Chisqr\cf3 \strokec3  \cf7 \strokec7 =\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_chisq)+\cf7 \strokec7 "\\rRmsqr\cf3 \strokec3  \cf7 \strokec7 =\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_rms)+\cf7 \strokec7 "\\r#\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 iterations\cf3 \strokec3  \cf7 \strokec7 =\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_FitNumIters)\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //////////////////////////////////////////////////////\cf3 \strokec3  \cf2 \strokec2 TABLES\cf3 \strokec3  \cf2 \strokec2 ///////////////////////////////////////////////////////\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Table0()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Table\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Edit\cf4 \strokec4 /W=(5,42,375,403)\cf3 \strokec3  \cf4 \strokec4 Voltage,Thermopile,PhotoDiode,Potential,PhotoCurrent\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 size=9,width=64,sigDigits=4\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 alignment(Point)=1,width(Point)=32\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Table1()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Table\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Edit\cf4 \strokec4 /W=(260,42,784,255)\cf3 \strokec3  \cf4 \strokec4 InputText,Input0,Input1,Input2,Input3,Input4,Input5,Input6,Input7\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 size=9,width=64,sigDigits=4\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 alignment(Point)=1,width(Point)=32,width(InputText)=80\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 title(InputText)=\cf7 \strokec7 "Text\cf3 \strokec3  \cf7 \strokec7 Parameter"\cf4 \strokec4 ,title(Input0)=\cf7 \strokec7 "Time"\cf4 \strokec4 ,title(Input1)=\cf7 \strokec7 "Isc"\cf4 \strokec4 ,title(Input2)=\cf7 \strokec7 "Uoc"\cf4 \strokec4 ,title(Input3)=\cf7 \strokec7 "Fillfactor"\cf4 \strokec4 ,title(Input4)=\cf7 \strokec7 "Power"\cf4 \strokec4 ,title(Input5)=\cf7 \strokec7 "Efficiency"\cf4 \strokec4 ,title(Input7)=\cf7 \strokec7 "Capacitance"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 TableSystem()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Table\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Edit\cf4 \strokec4 /W=(4,42,384,224)\cf3 \strokec3  \cf4 \strokec4 RefDiodes,Offset,OffsetOrange,OffsetGreen\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 size=9,width=64,sigDigits=4\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 alignment(Point)=1,width(Point)=32\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 TableFitParams()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Table\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Edit\cf4 \strokec4 /W=(400,160,592,296)\cf3 \strokec3  \cf4 \strokec4 cw\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 size=9,width=64,sigDigits=4\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 alignment(Point)=1,width(Point)=32\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 ListElectrolytes()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Table\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Edit\cf4 \strokec4 /W=(28,57,544,622)\cf3 \strokec3  \cf4 \strokec4 Electrolytes\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 size=9,width(Point)=24,alignment(Electrolytes)=1,width(Electrolytes)=64\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 rgb[1]=(65535,0,0),width[6]=80,width[7]=80\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 title[1]=\cf7 \strokec7 "Electrolyte"\cf4 \strokec4 ,title[2]=\cf7 \strokec7 "Conc"\cf4 \strokec4 ,title[3]=\cf7 \strokec7 "Molten\cf3 \strokec3  \cf7 \strokec7 Salt"\cf4 \strokec4 ,title[4]=\cf7 \strokec7 "[I2]"\cf4 \strokec4 ,title[5]=\cf7 \strokec7 "[Base]"\cf4 \strokec4 ,title[6]=\cf7 \strokec7 "Additives"\cf4 \strokec4 ,title[7]=\cf7 \strokec7 "Solvent"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 ReferenceDiodes()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf4 \strokec4 Table\
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Edit\cf4 \strokec4 /W=(4,40,628,368)\cf3 \strokec3  \cf4 \strokec4 Diodes,RefDiodes\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 size=9,width=64,sigDigits=5,width(Diodes)=120\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 alignment(Point)=1,width(Point)=32\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 rgb(Diodes)=(65535,0,0),rgb(RefDiodes)=(0,0,65535)\
\cf3 \strokec3 	\cf8 \strokec8 ModifyTable\cf3 \strokec3  \cf4 \strokec4 title[1]=\cf7 \strokec7 "Diode\cf3 \strokec3  \cf7 \strokec7 Name"\cf4 \strokec4 ,title[2]=\cf7 \strokec7 "0.1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,title[3]=\cf7 \strokec7 "1%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,title[4]=\cf7 \strokec7 "10%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,title[5]=\cf7 \strokec7 "30%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,title[6]=\cf7 \strokec7 "53%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,title[7]=\cf7 \strokec7 "64%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 ,title[8]=\cf7 \strokec7 "100%\cf3 \strokec3  \cf7 \strokec7 Sun"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \strokec2 //////////////////////////////////////////////////////\cf3 \strokec3  \cf2 \strokec2 LAYOUTS\cf3 \strokec3  \cf2 \strokec2 ///////////////////////////////////////////////////////\cf4 \strokec4 \
\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Layout_All_Data()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf3 \strokec3 																											\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 General\cf3 \strokec3  \cf2 \strokec2 IV.\cf3 \strokec3  \cf2 \strokec2 Use\cf3 \strokec3  \cf2 \strokec2 'Window'\cf3 \strokec3  \cf2 \strokec2 structure\cf3 \strokec3  \cf2 \strokec2 so\cf3 \strokec3  \cf2 \strokec2 that\cf3 \strokec3  \cf2 \strokec2 it\cf3 \strokec3  \cf2 \strokec2 appearsunder\cf3 \strokec3  \cf2 \strokec2 'Layout\cf3 \strokec3  \cf2 \strokec2 Macros'\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 cw,IVParams,PhotoCurrent0,PhotoCurrent1\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_beta,V_complianceI,V_numCell,V_FitQuitReason,V_run,V_supos\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 allwaves,allwaves,S_Filename,S_number,S_layoutname,option3,option5,option6,option9\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(right)=48,margin(bottom)=40,wbRGB=(65535,65535,65535)\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_supos>0)\
\cf3 \strokec3 		\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=text0/J/F=0/A=LC/X=1/Y=4\
\cf3 \strokec3 		\cf8 \strokec8 GetAxis\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 power;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 power,2e-5,V_max\
\cf3 \strokec3 		\cf4 \strokec4 Layout2()\
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 a,n\
\cf3 \strokec3 		\cf8 \strokec8 Legend\cf4 \strokec4 /K/N=textL\
\cf3 \strokec3 		\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((\cf6 \strokec6 cmpstr\cf4 \strokec4 (\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 ),\cf7 \strokec7 "DarkCurrent"\cf4 \strokec4 )==0)&(\cf6 \strokec6 ItemsinList\cf4 \strokec4 (allwaves,\cf7 \strokec7 ","\cf4 \strokec4 )==1))\
\cf3 \strokec3 				\cf4 \strokec4 cw[2]=\cf6 \strokec6 NaN\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 cw[3]=\cf6 \strokec6 NaN\cf3 \strokec3 																										\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 If\cf3 \strokec3  \cf2 \strokec2 no\cf3 \strokec3  \cf2 \strokec2 fit\cf3 \strokec3  \cf2 \strokec2 set\cf3 \strokec3  \cf2 \strokec2 to\cf3 \strokec3  \cf2 \strokec2 NaN\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 allwaves=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "PhotoCurrent*"\cf4 \strokec4 ,\cf7 \strokec7 ","\cf4 \strokec4 ,\cf7 \strokec7 "win:IVGraph"\cf4 \strokec4 ),\cf7 \strokec7 ","\cf4 \strokec4 ,16)\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Refresh\cf3 \strokec3  \cf2 \strokec2 allwaves\cf3 \strokec3  \cf2 \strokec2 again\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 allwaves=\cf6 \strokec6 SortList\cf4 \strokec4 (\cf6 \strokec6 WaveList\cf4 \strokec4 (\cf7 \strokec7 "PhotoCurrent*"\cf4 \strokec4 ,\cf7 \strokec7 ","\cf4 \strokec4 ,\cf7 \strokec7 "win:IVGraph"\cf4 \strokec4 ),\cf7 \strokec7 ","\cf4 \strokec4 ,16)\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 Parameters\cf3 \strokec3  \cf2 \strokec2 from\cf3 \strokec3  \cf2 \strokec2 waves\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 top\cf3 \strokec3  \cf2 \strokec2 graph\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 SummariseData()\
\cf3 \strokec3 				\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 CmpStr\cf4 \strokec4 (S_layoutname,\cf7 \strokec7 "Layout3()"\cf4 \strokec4 )!=0)\
\cf3 \strokec3 					\cf4 \strokec4 n=\cf6 \strokec6 str2num\cf4 \strokec4 (\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 )[\cf6 \strokec6 strlen\cf4 \strokec4 (\cf6 \strokec6 StringFromList\cf4 \strokec4 (0,allwaves,\cf7 \strokec7 ","\cf4 \strokec4 ))-1])\cf3 \strokec3 												\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Get\cf3 \strokec3  \cf2 \strokec2 first\cf3 \strokec3  \cf2 \strokec2 wave\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 ((V_numCell==1)&(IVParams[12*n+10]>0.55)&(IVParams[12*n+4]<-0.001))\cf3 \strokec3 													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Calculate\cf3 \strokec3  \cf2 \strokec2 Series\cf3 \strokec3  \cf2 \strokec2 Resistance\cf3 \strokec3  \cf2 \strokec2 only\cf3 \strokec3  \cf2 \strokec2 if\cf3 \strokec3  \cf2 \strokec2 Isc\cf3 \strokec3  \cf2 \strokec2 >\cf3 \strokec3  \cf2 \strokec2 1mA\cf4 \strokec4 \
\cf3 \strokec3 						\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 \
\cf3 \strokec3 						\cf4 \strokec4 DataFit(\cf7 \strokec7 "IV"\cf4 \strokec4 ,a=0)\
\cf3 \strokec3 					\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 						\cf8 \strokec8 FindLevel\cf4 \strokec4 /Q/B=3\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent0,V_complianceI/2;\cf3 \strokec3  \cf4 \strokec4 a=V_LevelX\cf3 \strokec3 																\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Estimate\cf3 \strokec3  \cf2 \strokec2 Series\cf3 \strokec3  \cf2 \strokec2 Resistance\cf3 \strokec3  \cf2 \strokec2 @Voc\cf4 \strokec4 \
\cf3 \strokec3 						\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (!V_Flag)\
\cf3 \strokec3 							\cf8 \strokec8 FindLevel\cf4 \strokec4 /Q/B=3\cf3 \strokec3  \cf4 \strokec4 PhotoCurrent1,-V_complianceI/2\
\cf3 \strokec3 							\cf4 \strokec4 cw[2]=-(V_LevelX-a)/V_complianceI\
\cf3 \strokec3 						\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 					\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 					\cf4 \strokec4 V_beta=VocvsIo()\
\cf3 \strokec3 				\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_supos>0)\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 Filename()\
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 CmpStr\cf4 \strokec4 (S_number,S_Filename)!=0)\
\cf3 \strokec3 				\cf4 \strokec4 S_Filename=S_number\
\cf3 \strokec3 				\cf9 \strokec9 break\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 				\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf3 \strokec3  \cf7 \strokec7 "This\cf3 \strokec3  \cf7 \strokec7 file\cf3 \strokec3  \cf7 \strokec7 name\cf3 \strokec3  \cf7 \strokec7 '"\cf4 \strokec4 +S_Filename+\cf7 \strokec7 "'\cf3 \strokec3  \cf7 \strokec7 is\cf3 \strokec3  \cf7 \strokec7 already\cf3 \strokec3  \cf7 \strokec7 in\cf3 \strokec3  \cf7 \strokec7 use.\cf3 \strokec3  \cf7 \strokec7 Please\cf3 \strokec3  \cf7 \strokec7 update\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 N\'b0"\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 V_run+=1\
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 while\cf4 \strokec4 (1)\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 CmpStr\cf4 \strokec4 (S_layoutname,\cf7 \strokec7 "Layout3()"\cf4 \strokec4 )!=0)\
\cf3 \strokec3 			\cf8 \strokec8 SetAxis\cf4 \strokec4 /A/R\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 DoUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 GetAxis\cf4 \strokec4 /Q\cf3 \strokec3  \cf4 \strokec4 left;\cf3 \strokec3  \cf8 \strokec8 SetAxis\cf3 \strokec3  \cf4 \strokec4 left,\cf6 \strokec6 min\cf4 \strokec4 (V_complianceI,-V_max/2),V_max\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 Execute\cf3 \strokec3  \cf7 \strokec7 "RemoveTags(1)"\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 TransientCGraph\
\cf3 \strokec3 		\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(right)=48,margin(bottom)=40,wbRGB=(65535,65535,65535)\
\cf3 \strokec3 		\cf8 \strokec8 Legend\cf4 \strokec4 /C/N=text0/J/F=0/A=MC/X=32/Y=-40\
\cf3 \strokec3 		\cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 S_layoutname\
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyLayout\cf3 \strokec3  \cf4 \strokec4 mag=1\
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "(Data\cf3 \strokec3  \cf7 \strokec7 Fit..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "(Layout..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option6=\cf7 \strokec7 "Print\cf3 \strokec3  \cf7 \strokec7 &\cf3 \strokec3  \cf7 \strokec7 Save"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option9=\cf7 \strokec7 "Save\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 Data"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Buildmenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Proc\cf3 \strokec3  \cf4 \strokec4 Layout_Results()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 s;\cf3 \strokec3  \cf9 \strokec9 Variable\cf3 \strokec3  \cf4 \strokec4 n,ncols=\cf6 \strokec6 DimSize\cf4 \strokec4 (Expt_parameters,1)-1,p1\
\cf3 \strokec3 	\cf4 \strokec4 S_layoutname=\cf7 \strokec7 "Layout5()"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(right)=16,margin(bottom)=40,wbRGB=(65535,65535,65535)\
\cf3 \strokec3 	\cf8 \strokec8 Legend\cf4 \strokec4 /W=IVGraph/K/N=textL;\cf3 \strokec3  \cf8 \strokec8 Legend\cf4 \strokec4 /W=IVGraph/N=textL/J/F=0/A=MC/X=-28/Y=0\cf3 \strokec3 															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Kill\cf3 \strokec3  \cf2 \strokec2 old\cf3 \strokec3  \cf2 \strokec2 legend,\cf3 \strokec3  \cf2 \strokec2 then\cf3 \strokec3  \cf2 \strokec2 make\cf3 \strokec3  \cf2 \strokec2 a\cf3 \strokec3  \cf2 \strokec2 new\cf3 \strokec3  \cf2 \strokec2 one\cf3 \strokec3  \cf2 \strokec2 with\cf3 \strokec3  \cf2 \strokec2 no\cf3 \strokec3  \cf2 \strokec2 text\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 s=\cf6 \strokec6 GetDimLabel\cf4 \strokec4 (Expt_parameters,1,n+1);\cf3 \strokec3  \cf4 \strokec4 p1=\cf6 \strokec6 strsearch\cf4 \strokec4 (s,\cf7 \strokec7 "_"\cf4 \strokec4 ,0)\cf3 \strokec3 																				\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Filename\cf3 \strokec3  \cf2 \strokec2 held\cf3 \strokec3  \cf2 \strokec2 in\cf3 \strokec3  \cf2 \strokec2 DimLabel\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 AppendText\cf4 \strokec4 /N=textL\cf3 \strokec3  \cf7 \strokec7 "\\s('Power"\cf4 \strokec4 +s[p1+1,\cf6 \strokec6 strlen\cf4 \strokec4 (s)]+\cf7 \strokec7 "')\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +s\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<ncols)\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 $S_windowname\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(right)=48,margin(bottom)=40,wbRGB=(65535,65535,65535)\
\cf3 \strokec3 	\cf4 \strokec4 Layout5()\
\cf3 \strokec3 	\cf4 \strokec4 option4=\cf7 \strokec7 "(Data\cf3 \strokec3  \cf7 \strokec7 Extract"\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "(Layout..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option6=\cf7 \strokec7 "Print\cf3 \strokec3  \cf7 \strokec7 &\cf3 \strokec3  \cf7 \strokec7 Save"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Buildmenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Layout0()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "Layout/K=1/C=1/W=(4,42,936,680)\cf3 \strokec3  \cf7 \strokec7 %s(388,128,816,424)/O=1/F=0"\cf4 \strokec4 ,S_windowname\
\cf3 \strokec3 	\cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text0/F=1/S=3/A=LC/X=16/Y=45\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\f01Current\cf3 \strokec3  \cf7 \strokec7 Voltage\cf3 \strokec3  \cf7 \strokec7 characteristics\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Cell:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Filename\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text1/F=0/A=LC/X=2/Y=26\
\cf3 \strokec3 	\cf4 \strokec4 Expt_params(2,0)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text4/F=0/A=MC/X=40/Y=-48.5\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02Date:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text5/F=0/A=LC/X=0/Y=-48.5\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02\'a9\cf3 \strokec3  \cf7 \strokec7 RAHB:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 IgorInfo\cf4 \strokec4 (1)+\cf7 \strokec7 "\\tMeasured\cf3 \strokec3  \cf7 \strokec7 by\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Username\
\cf3 \strokec3 	\cf8 \strokec8 Append\cf3 \strokec3  \cf4 \strokec4 EPFL_Logo(10,12,166,56)/O=8/F=0\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 cmpstr\cf4 \strokec4 (S_windowname,\cf7 \strokec7 "GraphTStability"\cf4 \strokec4 ))\
\cf3 \strokec3 		\cf4 \strokec4 IV_Results()\
\cf3 \strokec3 		\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text8/F=0/X=52/Y=8\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 numpnts\cf4 \strokec4 (cw)==4)\
\cf3 \strokec3 			\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\JC\\F'Times'\\Z14Model:\cf3 \strokec3  \cf7 \strokec7 i\cf3 \strokec3  \cf7 \strokec7 =\cf3 \strokec3  \cf7 \strokec7 I\\Bpc\\M\\Z14\cf3 \strokec3  \cf7 \strokec7 -\cf3 \strokec3  \cf7 \strokec7 I\\Bsat\\M\\Z14[exp(\\[0\\f04q(V+Ri)\\f00)-1]"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\X0\cf3 \strokec3      \cf7 \strokec7 nkT\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\JC\\F'Times'\\Z14Model:\cf3 \strokec3  \cf7 \strokec7 i\cf3 \strokec3  \cf7 \strokec7 =\cf3 \strokec3  \cf7 \strokec7 I\\Bpc\\M\\Z14\cf3 \strokec3  \cf7 \strokec7 -\cf3 \strokec3  \cf7 \strokec7 I\\Bsat\\M\\Z14[exp(\\[0\\f04q(V+Ri)\\f00)-1]\cf3 \strokec3  \cf7 \strokec7 -\cf3 \strokec3  \cf7 \strokec7 \\[1\\f04V+Ri\\f00"\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\X0\cf3 \strokec3      \cf7 \strokec7 nkT\\X1\cf3 \strokec3   \cf7 \strokec7 R\\Bshunt\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text8/F=0/X=8/Y=24\
\cf3 \strokec3 		\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\JC\\F'Times'\\Z12\\f01Cell\cf3 \strokec3  \cf7 \strokec7 Stability\cf3 \strokec3  \cf7 \strokec7 under\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Status\
\cf3 \strokec3 		\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\f01Total\cf3 \strokec3  \cf7 \strokec7 Time\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Exposure\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_TotalTime)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 hrs"\cf4 \strokec4 \
\cf3 \strokec3 		\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\f01Sun\cf3 \strokec3  \cf7 \strokec7 Exposure\cf3 \strokec3  \cf7 \strokec7 :"\cf4 \strokec4 +\cf7 \strokec7 "Continuous"\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyLayout\cf3 \strokec3  \cf4 \strokec4 mag=1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Layout1()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Basic\cf3 \strokec3  \cf2 \strokec2 Data\cf3 \strokec3  \cf2 \strokec2 Layout\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 Layout\cf4 \strokec4 /K=1/C=1/W=(4,42,936,680)\cf3 \strokec3  \cf4 \strokec4 IVGraph(388,32,816,328)/O=1/F=0,TransientCGraph(388,328,816,568)/O=1/F=0\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text0/F=1/S=3/A=LC/X=20/Y=45\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\f01Cell\cf3 \strokec3  \cf7 \strokec7 Name:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 ParseFilePath\cf4 \strokec4 (3,\cf3 \strokec3  \cf4 \strokec4 S_Filename,\cf3 \strokec3  \cf7 \strokec7 ":"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 0,\cf3 \strokec3  \cf4 \strokec4 0)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text1/F=0/A=LC/X=2/Y=26\
\cf3 \strokec3 	\cf4 \strokec4 Expt_params(2,0)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text4/F=0/A=LC/X=2/Y=-44\cf3 \strokec3  \cf7 \strokec7 "Calibration\cf3 \strokec3  \cf7 \strokec7 File:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Calibrationfile\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf3 \strokec3  \cf4 \strokec4 /N=text5/F=0/A=MC/X=40/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02Date:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text6/F=0/A=LC/X=2/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02\'a9\cf3 \strokec3  \cf7 \strokec7 RAHB:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 IgorInfo\cf4 \strokec4 (1)+\cf7 \strokec7 "\\tMeasured\cf3 \strokec3  \cf7 \strokec7 by\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Username+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 on\cf3 \strokec3  \cf7 \strokec7 IV\cf3 \strokec3  \cf7 \strokec7 old"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Append\cf3 \strokec3  \cf4 \strokec4 EPFL_Logo(10,12,166,56)/O=8/F=0\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Function\cf3 \strokec3  \cf4 \strokec4 Layout2()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Appended\cf3 \strokec3  \cf2 \strokec2 Data\cf3 \strokec3  \cf2 \strokec2 layout\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf4 \strokec4 /T\cf3 \strokec3  \cf4 \strokec4 Expt_parameters\
\cf3 \strokec3 	\cf9 \strokec9 WAVE\cf3 \strokec3  \cf4 \strokec4 RefDiodes\
\cf3 \strokec3 	\cf9 \strokec9 NVAR\cf3 \strokec3  \cf4 \strokec4 V_supos\
\cf3 \strokec3 	\cf9 \strokec9 SVAR\cf3 \strokec3  \cf4 \strokec4 S_Calibrationfile,S_cellname,S_Username,S_YDataName\
\cf3 \strokec3 	\cf9 \strokec9 variable\cf3 \strokec3  \cf4 \strokec4 a=\cf6 \strokec6 round\cf4 \strokec4 (1000*RefDiodes[15][6-\cf6 \strokec6 str2num\cf4 \strokec4 (S_YDataName[12,13])])/10,n,m;\cf3 \strokec3  \cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 NewLayout\cf4 \strokec4 /K=1/C=1/W=(4,42,936,544)\cf3 \strokec3  \cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /R=(32,232,560,616)/F=0\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text0/F=0/S=3/A=MC/X=-4/Y=43\cf3 \strokec3  \cf7 \strokec7 "\\JC\\Z14\\f01"\cf4 \strokec4 +S_YDataName[0,11]+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 Voltage\cf3 \strokec3  \cf7 \strokec7 characteristics\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Cell:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_cellname\
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\Z12at\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (a)+\cf7 \strokec7 "%\cf3 \strokec3  \cf7 \strokec7 Sun\\f00\\r"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Experimental\cf3 \strokec3  \cf7 \strokec7 Parameters"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text1/F=0/A=MT/X=0/Y=11\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 m=0;\cf3 \strokec3  \cf4 \strokec4 str=\cf7 \strokec7 ""\cf3 \strokec3 																															\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 m\cf3 \strokec3  \cf2 \strokec2 is\cf3 \strokec3  \cf2 \strokec2 #\cf3 \strokec3  \cf2 \strokec2 of\cf3 \strokec3  \cf2 \strokec2 appended\cf3 \strokec3  \cf2 \strokec2 waves\cf3 \strokec3  \cf2 \strokec2 counter\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (n==0)\cf3 \strokec3 																														\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 First\cf3 \strokec3  \cf2 \strokec2 line\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (m==0)\
\cf3 \strokec3 					\cf4 \strokec4 str+=Expt_parameters[n][m]+\cf7 \strokec7 "\\t\\t\\[0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 					\cf4 \strokec4 str+=\cf6 \strokec6 PadString\cf4 \strokec4 ((Expt_parameters[n][m])[0,27],28,0x20)+\cf7 \strokec7 "\\["\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (m)+\cf7 \strokec7 ":\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 				\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 str+=Expt_parameters[n][m]+\cf7 \strokec7 "\\X"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (m)+\cf7 \strokec7 ":\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 m+=1\
\cf3 \strokec3 		\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (m<=(V_supos))\
\cf3 \strokec3 		\cf8 \strokec8 AppendText\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<9)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text2/F=0/A=MT/X=0/Y=76\cf7 \strokec7 "\\Z12\\f01Measured\cf3 \strokec3  \cf7 \strokec7 Parameters"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text3/F=0/A=MT/X=0/Y=78\
\cf3 \strokec3 	\cf4 \strokec4 n=10\
\cf3 \strokec3 	\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 		\cf4 \strokec4 m=0;\cf3 \strokec3  \cf4 \strokec4 str=\cf7 \strokec7 ""\cf4 \strokec4 \
\cf3 \strokec3 		\cf9 \strokec9 do\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (n==10)\
\cf3 \strokec3 				\cf4 \strokec4 str+=Expt_parameters[n][m]+\cf7 \strokec7 "\cf3 \strokec3         \cf7 \strokec7 \\["\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (m)+\cf7 \strokec7 ":\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 				\cf4 \strokec4 str+=Expt_parameters[n][m]+\cf7 \strokec7 "\\X"\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (m)+\cf7 \strokec7 ":\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 \
\cf3 \strokec3 			\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 m+=1\
\cf3 \strokec3 		\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (m<=(V_supos))\
\cf3 \strokec3 		\cf8 \strokec8 AppendText\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 		\cf4 \strokec4 n+=1\
\cf3 \strokec3 	\cf9 \strokec9 while\cf3 \strokec3  \cf4 \strokec4 (n<20)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text4/F=0/A=LC/X=4/Y=-46\cf3 \strokec3  \cf7 \strokec7 "Calibration\cf3 \strokec3  \cf7 \strokec7 File:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Calibrationfile\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text5/F=0/A=MC/X=40/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02Date:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text6/F=0/A=LC/X=4/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02\'a9\cf3 \strokec3  \cf7 \strokec7 RAHB:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 IgorInfo\cf4 \strokec4 (1)+\cf7 \strokec7 "\\tMeasured\cf3 \strokec3  \cf7 \strokec7 by\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Username\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /F=0/R=(10,12,166,56)\cf3 \strokec3  \cf9 \strokec9 Picture\cf3 \strokec3  \cf4 \strokec4 EPFL_Logo\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Layout3()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf3 \strokec3 																													\cf2 \strokec2 //\cf3 \strokec3  \cf2 \strokec2 Basic\cf3 \strokec3  \cf2 \strokec2 Data\cf3 \strokec3  \cf2 \strokec2 Layout\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 ChronoAmpGraph\
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(right)=48,margin(bottom)=40,wbRGB=(65535,65535,65535)\
\cf3 \strokec3 	\cf8 \strokec8 NewLayout\cf4 \strokec4 /K=2/C=1/W=(4,42,936,680)\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /R=(388,32,816,328)/F=0\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 ChronoAmpGraph;\cf3 \strokec3  \cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /R=(388,328,784,568)/F=0\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 ChargeGraph\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text0/F=1/S=3/A=LC/X=18/Y=45\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\f01Cell\cf3 \strokec3  \cf7 \strokec7 Name:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Filename\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text1/F=0/A=LC/X=2/Y=26\
\cf3 \strokec3 	\cf4 \strokec4 CellParams()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text2/F=0/A=LT/X=16/Y=76\cf7 \strokec7 "\\Z12\\f01Measured\cf3 \strokec3  \cf7 \strokec7 Parameters"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text3/F=0/A=LT/X=16/Y=78\cf7 \strokec7 "Total\cf3 \strokec3  \cf7 \strokec7 Accumalated\cf3 \strokec3  \cf7 \strokec7 Charge:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_max)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 C"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Charge\cf3 \strokec3  \cf7 \strokec7 X\cf3 \strokec3  \cf7 \strokec7 section\cf3 \strokec3  \cf7 \strokec7 :\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_chargeDensity)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 C/cm\\S\\Z082\\Z10"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text4/F=0/A=LC/X=2/Y=-44\cf3 \strokec3  \cf7 \strokec7 "Calibration\cf3 \strokec3  \cf7 \strokec7 File:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Calibrationfile\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf3 \strokec3  \cf4 \strokec4 /N=text5/F=0/A=MC/X=40/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02Date:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text6/F=0/A=LC/X=2/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02\'a9\cf3 \strokec3  \cf7 \strokec7 RAHB:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 IgorInfo\cf4 \strokec4 (1)+\cf7 \strokec7 "\\tMeasured\cf3 \strokec3  \cf7 \strokec7 by\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Username\
\cf3 \strokec3 	\cf8 \strokec8 Append\cf3 \strokec3  \cf4 \strokec4 EPFL_Logo(10,12,166,56)/O=8/F=0\
\cf3 \strokec3 	\cf8 \strokec8 ModifyLayout\cf3 \strokec3  \cf4 \strokec4 mag=1\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Layout4()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 NewLayout\cf4 \strokec4 /K=2/C=1/W=(4,42,480,544)\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /R=(388,32,816,328)/F=0\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /R=(388,328,644,568)/F=0\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 PowerPlot;\cf3 \strokec3  \cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /R=(602,328,816,568)/F=0\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 LnPowerPlot\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text0/F=1/S=3/A=LC/X=20/Y=45\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\f01Cell\cf3 \strokec3  \cf7 \strokec7 Name:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Filename\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text1/F=0/A=LC/X=2/Y=27\
\cf3 \strokec3 	\cf4 \strokec4 Expt_params(2,0)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text4/F=0/A=LC/X=2/Y=-44\cf3 \strokec3  \cf7 \strokec7 "Calibration\cf3 \strokec3  \cf7 \strokec7 File:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Calibrationfile\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf3 \strokec3  \cf4 \strokec4 /N=text5/F=0/A=MC/X=40/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02Date:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text6/F=0/A=LC/X=2/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02\'a9\cf3 \strokec3  \cf7 \strokec7 RAHB:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 IgorInfo\cf4 \strokec4 (1)+\cf7 \strokec7 "\\tMeasured\cf3 \strokec3  \cf7 \strokec7 by\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Username\
\cf3 \strokec3 	\cf8 \strokec8 Append\cf3 \strokec3  \cf4 \strokec4 EPFL_Logo(10,12,166,56)/O=8/F=0\
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Layout5()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 String\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 NewLayout\cf4 \strokec4 /K=2/W=(4,42,480,544)\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /R=(388,32,816,320)/F=0\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf8 \strokec8 sprintf\cf3 \strokec3  \cf4 \strokec4 str,\cf7 \strokec7 "AppendLayoutObject/R=(388,328,816,568)/F=0\cf3 \strokec3  \cf7 \strokec7 GRAPH\cf3 \strokec3  \cf7 \strokec7 %s"\cf4 \strokec4 ,S_windowname\
\cf3 \strokec3 	\cf8 \strokec8 Execute\cf3 \strokec3  \cf4 \strokec4 str\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text0/F=1/S=3/A=LC/X=18/Y=45\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\f01PV\cf3 \strokec3  \cf7 \strokec7 characteristics\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Class\cf3 \strokec3  \cf7 \strokec7 of\cf3 \strokec3  \cf7 \strokec7 Cells:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Filename[0,\cf6 \strokec6 strsearch\cf4 \strokec4 (S_Filename,\cf7 \strokec7 "_"\cf4 \strokec4 ,0)-1]\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text1/F=0/A=LC/X=2/Y=24\
\cf3 \strokec3 	\cf4 \strokec4 Expt_params(2,0)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text4/F=0/A=LC/X=2/Y=-44\cf3 \strokec3  \cf7 \strokec7 "Calibration\cf3 \strokec3  \cf7 \strokec7 File:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Calibrationfile\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text5/F=0/A=MC/X=40/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02Date:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text6/F=0/A=LC/X=2/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02\'a9\cf3 \strokec3  \cf7 \strokec7 RAHB:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 IgorInfo\cf4 \strokec4 (1)+\cf7 \strokec7 "\\tMeasured\cf3 \strokec3  \cf7 \strokec7 by\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Username\
\cf3 \strokec3 	\cf8 \strokec8 Append\cf3 \strokec3  \cf4 \strokec4 EPFL_Logo(10,12,166,56)/O=8/F=0\
\cf3 \strokec3 	\cf8 \strokec8 ModifyLayout\cf3 \strokec3  \cf4 \strokec4 mag=1\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 EndMacro\cf4 \strokec4 \
\
\cf9 \strokec9 Window\cf3 \strokec3  \cf4 \strokec4 Layout_PPT()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(right)=48,margin(bottom)=40,wbRGB=(65535,65535,65535)\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_supos==0)\
\cf3 \strokec3 		\cf4 \strokec4 Filename()\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 CmpStr\cf4 \strokec4 (S_number,S_Filename))!=0)\
\cf3 \strokec3 			\cf4 \strokec4 S_Filename=S_number\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf3 \strokec3  \cf7 \strokec7 "This\cf3 \strokec3  \cf7 \strokec7 file\cf3 \strokec3  \cf7 \strokec7 name\cf3 \strokec3  \cf7 \strokec7 '"\cf4 \strokec4 +S_Filename+\cf7 \strokec7 "'\cf3 \strokec3  \cf7 \strokec7 is\cf3 \strokec3  \cf7 \strokec7 already\cf3 \strokec3  \cf7 \strokec7 in\cf3 \strokec3  \cf7 \strokec7 use.\cf3 \strokec3  \cf7 \strokec7 Please\cf3 \strokec3  \cf7 \strokec7 update\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 N\'ac\uc0\u8734 "\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 V_run+=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Layout\cf4 \strokec4 /P='Landscape'/K=1/C=1/W=(4,42,936,680)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=Text0/F=0/S=3/A=LC/X=20/Y=46\cf3 \strokec3  \cf7 \strokec7 "\\Z14\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'\\t\\t\cf3 \strokec3 	\cf7 \strokec7 "\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 ParseFilePath\cf4 \strokec4 (3,\cf3 \strokec3  \cf4 \strokec4 S_Filename,\cf3 \strokec3  \cf7 \strokec7 ":"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 0,\cf3 \strokec3  \cf4 \strokec4 0)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text1/F=0/A=LC/X=2/Y=24\
\cf3 \strokec3 	\cf4 \strokec4 CellParams()\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /F=0/R=(312,312,800,560)\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 GraphIV\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /F=0/T=0/R=(312,32,800,280)\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 $S_windowName\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=Text2/F=0/A=LC/X=2/Y=-16\cf3 \strokec3  \cf7 \strokec7 "\\Z16\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'Initial\cf3 \strokec3  \cf7 \strokec7 I-V\cf3 \strokec3  \cf7 \strokec7 diagnostics"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "\\Z10Active\cf3 \strokec3  \cf7 \strokec7 area\\t\\[0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_area)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 cm\\S2\\M"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Power\\Bin\\M\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (1000*V_powerIn1)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mW\cf3 \strokec3  \cf7 \strokec7 cm\\S-2\\M"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "J\\Bsc\\M\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (1000*V_Jsc)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mA\cf3 \strokec3  \cf7 \strokec7 cm\\S-2\\M"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "V\\Boc\\M\cf3 \strokec3  \cf7 \strokec7 \\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_voc)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 V"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "FF\cf3 \strokec3  \cf7 \strokec7 \\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (V_ff)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "J\\Bpmax\\M\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (1000*V_Jpp)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mA\cf3 \strokec3  \cf7 \strokec7 cm\\S-2\\M"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "U\\Bpmax\\M\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (V_Vpp)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3   \cf7 \strokec7 V"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "PCE\cf3 \strokec3  \cf7 \strokec7 \\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (1000*V_pwr)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/M=1\cf3 \strokec3  \cf4 \strokec4 input8;\cf3 \strokec3  \cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "PCE\cf3 \strokec3  \cf7 \strokec7 (MPPT)\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (V_max)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text5/F=0/A=MC/X=40/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02Date:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text6/F=0/A=LC/X=4/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02\'ac\'a9\cf3 \strokec3  \cf7 \strokec7 RAHB:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 IgorInfo\cf4 \strokec4 (1)+\cf7 \strokec7 "\\tMeasured\cf3 \strokec3  \cf7 \strokec7 by\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Username\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /F=0/R=(10,12,166,56)\cf3 \strokec3  \cf9 \strokec9 picture\cf3 \strokec3  \cf4 \strokec4 EPFL_Logo\
\cf3 \strokec3 	\cf8 \strokec8 ModifyLayout\cf3 \strokec3  \cf4 \strokec4 mag=1\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "(Data\cf3 \strokec3  \cf7 \strokec7 Analysis\cf3 \strokec3  \cf7 \strokec7 ..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "(Layout..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option6=\cf7 \strokec7 "Print\cf3 \strokec3  \cf7 \strokec7 &\cf3 \strokec3  \cf7 \strokec7 Save"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Buildmenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
\cf9 \strokec9 Proc\cf3 \strokec3  \cf4 \strokec4 Layout_PPTStability()\cf3 \strokec3  \cf4 \strokec4 :\cf3 \strokec3  \cf8 \strokec8 Layout\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf3 \strokec3 	\cf8 \strokec8 PauseUpdate\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Silent\cf3 \strokec3  \cf4 \strokec4 1\
\cf3 \strokec3 	\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (V_supos==0)\
\cf3 \strokec3 		\cf4 \strokec4 Filename()\
\cf3 \strokec3 		\cf9 \strokec9 if\cf3 \strokec3  \cf4 \strokec4 (\cf6 \strokec6 CmpStr\cf4 \strokec4 (S_number,S_Filename))!=0)\
\cf3 \strokec3 			\cf4 \strokec4 S_Filename=S_number\
\cf3 \strokec3 		\cf9 \strokec9 else\cf4 \strokec4 \
\cf3 \strokec3 			\cf8 \strokec8 beep\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 DoAlert\cf3 \strokec3  \cf4 \strokec4 0,\cf3 \strokec3  \cf7 \strokec7 "This\cf3 \strokec3  \cf7 \strokec7 file\cf3 \strokec3  \cf7 \strokec7 name\cf3 \strokec3  \cf7 \strokec7 '"\cf4 \strokec4 +S_Filename+\cf7 \strokec7 "'\cf3 \strokec3  \cf7 \strokec7 is\cf3 \strokec3  \cf7 \strokec7 already\cf3 \strokec3  \cf7 \strokec7 in\cf3 \strokec3  \cf7 \strokec7 use.\cf3 \strokec3  \cf7 \strokec7 Please\cf3 \strokec3  \cf7 \strokec7 update\cf3 \strokec3  \cf7 \strokec7 Cell\cf3 \strokec3  \cf7 \strokec7 N\'ac\uc0\u8734 "\cf4 \strokec4 \
\cf3 \strokec3 			\cf4 \strokec4 V_run+=1\
\cf3 \strokec3 		\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf9 \strokec9 endif\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 DoWindow\cf4 \strokec4 /F\cf3 \strokec3  \cf4 \strokec4 IVGraph\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 ModifyGraph\cf3 \strokec3  \cf4 \strokec4 margin(right)=48,margin(bottom)=40,wbRGB=(65535,65535,65535)\
\cf3 \strokec3 	\cf8 \strokec8 NewLayout\cf4 \strokec4 /K=1/P='Landscape'/W=(4,42,936,660)\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /F=0/R=(16,312,548,544)\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 IVGraph\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /F=0/R=(424,16,792,400)/T=0\cf3 \strokec3  \cf4 \strokec4 GRAPH\cf3 \strokec3  \cf4 \strokec4 $S_windowName\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=Text0/F=0/S=3/A=LC/X=2/Y=46\cf3 \strokec3  \cf7 \strokec7 "\\Z16\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'\\t\\t\cf3 \strokec3 	\cf7 \strokec7 "\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 ParseFilePath\cf4 \strokec4 (3,\cf3 \strokec3  \cf4 \strokec4 S_Filename,\cf3 \strokec3  \cf7 \strokec7 ":"\cf4 \strokec4 ,\cf3 \strokec3  \cf4 \strokec4 0,\cf3 \strokec3  \cf4 \strokec4 0)\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text1/F=0/A=LC/X=2/Y=24\
\cf3 \strokec3 	\cf4 \strokec4 CellParams()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=Text2/F=0/A=LC/X=72/Y=-24\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\F'Times\cf3 \strokec3  \cf7 \strokec7 New\cf3 \strokec3  \cf7 \strokec7 Roman'Active\cf3 \strokec3  \cf7 \strokec7 area\\t\\[0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_area)+\cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 cm\\S2\\M"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/M=1Input0;\cf3 \strokec3  \cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "Power\\Bin\\M\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_avg*1000)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mW\cf3 \strokec3  \cf7 \strokec7 cm\\S-2\\M"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/M=1\cf3 \strokec3  \cf4 \strokec4 input1;\cf3 \strokec3  \cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "J\\Bsc\\M\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_avg*1000)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mA\cf3 \strokec3  \cf7 \strokec7 cm\\S-2\\M"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "V\\Boc\\M\cf3 \strokec3  \cf7 \strokec7 \\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf4 \strokec4 +\cf6 \strokec6 num2str\cf4 \strokec4 (V_voc)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 V"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "FF\cf3 \strokec3  \cf7 \strokec7 \\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (V_ff)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/M=1\cf3 \strokec3  \cf4 \strokec4 input4;\cf3 \strokec3  \cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "J\\Bmax\\M\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (-V_avg*1000)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 mA\cf3 \strokec3  \cf7 \strokec7 cm\\S-2\\M"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/M=1\cf3 \strokec3  \cf4 \strokec4 input3;\cf3 \strokec3  \cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "V\\Bmax\\M\cf3 \strokec3  \cf7 \strokec7 \\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (V_avg)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3   \cf7 \strokec7 V"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "PCE\cf3 \strokec3  \cf7 \strokec7 (jV)\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (V_pwr*1000)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 WaveStats\cf4 \strokec4 /Q/M=1\cf3 \strokec3  \cf4 \strokec4 input5;\cf3 \strokec3  \cf8 \strokec8 AppendText\cf3 \strokec3  \cf7 \strokec7 "PCE\cf3 \strokec3  \cf7 \strokec7 (MPPT)\\X0:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf3 \strokec3  \cf6 \strokec6 num2str\cf4 \strokec4 (-V_avg*1000)\cf3 \strokec3  \cf4 \strokec4 +\cf3 \strokec3  \cf7 \strokec7 "\cf3 \strokec3  \cf7 \strokec7 %"\cf4 \strokec4 \
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text5/F=0/A=MC/X=40/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02Date:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 date\cf4 \strokec4 ()\
\cf3 \strokec3 	\cf8 \strokec8 Textbox\cf4 \strokec4 /N=text6/F=0/A=LC/X=4/Y=-48\cf3 \strokec3  \cf7 \strokec7 "\\Z10\\f02\'a9\cf3 \strokec3  \cf7 \strokec7 RAHB:\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +\cf6 \strokec6 IgorInfo\cf4 \strokec4 (1)+\cf7 \strokec7 "\\tMeasured\cf3 \strokec3  \cf7 \strokec7 by\cf3 \strokec3  \cf7 \strokec7 "\cf4 \strokec4 +S_Username\
\cf3 \strokec3 	\cf8 \strokec8 AppendLayoutObject\cf4 \strokec4 /R=(42,19,132,60)\cf3 \strokec3  \cf9 \strokec9 picture\cf3 \strokec3  \cf4 \strokec4 EPFL_Logo\
\cf3 \strokec3 	\cf8 \strokec8 ModifyLayout\cf3 \strokec3  \cf4 \strokec4 mag=1\cf3 \strokec3 	\cf4 \strokec4 \
\cf3 \strokec3 	\cf4 \strokec4 option3=\cf7 \strokec7 "(Data\cf3 \strokec3  \cf7 \strokec7 Fit..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option5=\cf7 \strokec7 "(Layout..."\cf4 \strokec4 ;\cf3 \strokec3  \cf4 \strokec4 option6=\cf7 \strokec7 "Print\cf3 \strokec3  \cf7 \strokec7 &\cf3 \strokec3  \cf7 \strokec7 Save"\cf4 \strokec4 ;\cf3 \strokec3  \cf8 \strokec8 Buildmenu\cf3 \strokec3  \cf7 \strokec7 "Macros"\cf3 \strokec3 	\cf4 \strokec4 \
\pard\pardeftab720\sl280\partightenfactor0
\cf9 \strokec9 End\cf4 \strokec4 \
\
}